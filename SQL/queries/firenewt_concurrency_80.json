{
    "sqls": [
        {
            "sql_id": "app_q1_1",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1987-01-06' AND '1987-01-20')\nAND sourceip IN ('39.36.179.195')\nAND countrycode = 'BEL';"
        },
        {
            "sql_id": "app_q1_2",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1990-06-27' AND '1990-07-11')\nAND sourceip IN ('158.78.99.24')\nAND countrycode = 'AUT';"
        },
        {
            "sql_id": "app_q1_3",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1979-02-25' AND '1979-03-11')\nAND sourceip IN ('95.116.144.81')\nAND countrycode = 'ALB';"
        },
        {
            "sql_id": "app_q1_4",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '2010-06-09' AND '2010-06-23')\nAND sourceip IN ('241.145.188.169')\nAND countrycode = 'JPN';"
        },
        {
            "sql_id": "app_q1_5",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1983-08-31' AND '1983-09-14')\nAND sourceip IN ('249.129.106.47')\nAND countrycode = 'SGP';"
        },
        {
            "sql_id": "app_q1_6",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1971-12-21' AND '1972-01-04')\nAND sourceip IN ('245.152.47.12')\nAND countrycode = 'AUT';"
        },
        {
            "sql_id": "app_q1_7",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1974-01-05' AND '1974-01-19')\nAND sourceip IN ('11.174.90.16')\nAND countrycode = 'POL';"
        },
        {
            "sql_id": "app_q1_8",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '2006-09-22' AND '2006-10-06')\nAND sourceip IN ('167.65.182.94')\nAND countrycode = 'SGP';"
        },
        {
            "sql_id": "app_q1_9",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1984-04-18' AND '1984-05-02')\nAND sourceip IN ('225.187.145.189')\nAND countrycode = 'DEU';"
        },
        {
            "sql_id": "app_q1_10",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1970-07-17' AND '1970-07-31')\nAND sourceip IN ('211.74.245.117')\nAND countrycode = 'MLT';"
        },
        {
            "sql_id": "app_q1_11",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1971-11-06' AND '1971-11-20')\nAND sourceip IN ('134.228.246.117')\nAND countrycode = 'JPN';"
        },
        {
            "sql_id": "app_q1_12",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1989-05-17' AND '1989-05-31')\nAND sourceip IN ('82.59.63.207')\nAND countrycode = 'SYR';"
        },
        {
            "sql_id": "app_q1_13",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1980-02-17' AND '1980-03-02')\nAND sourceip IN ('74.29.162.5')\nAND countrycode = 'BEL';"
        },
        {
            "sql_id": "app_q1_14",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1977-12-24' AND '1978-01-07')\nAND sourceip IN ('48.105.38.222')\nAND countrycode = 'TWN';"
        },
        {
            "sql_id": "app_q1_15",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '2011-03-19' AND '2011-04-02')\nAND sourceip IN ('46.54.107.234')\nAND countrycode = 'LVA';"
        },
        {
            "sql_id": "app_q1_16",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '2007-02-18' AND '2007-03-04')\nAND sourceip IN ('47.65.237.229')\nAND countrycode = 'FIN';"
        },
        {
            "sql_id": "app_q1_17",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1995-02-01' AND '1995-02-15')\nAND sourceip IN ('6.235.200.200')\nAND countrycode = 'ESP';"
        },
        {
            "sql_id": "app_q1_18",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1982-08-02' AND '1982-08-16')\nAND sourceip IN ('15.206.185.193')\nAND countrycode = 'ECU';"
        },
        {
            "sql_id": "app_q1_19",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1981-04-17' AND '1981-05-01')\nAND sourceip IN ('117.209.227.95')\nAND countrycode = 'JPN';"
        },
        {
            "sql_id": "app_q1_20",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '2000-07-09' AND '2000-07-23')\nAND sourceip IN ('216.143.145.92')\nAND countrycode = 'DOM';"
        },
        {
            "sql_id": "app_q1_21",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1984-01-06' AND '1984-01-20')\nAND sourceip IN ('243.30.23.179')\nAND countrycode = 'PER';"
        },
        {
            "sql_id": "app_q1_22",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1997-02-18' AND '1997-03-04')\nAND sourceip IN ('69.13.209.210')\nAND countrycode = 'PAN';"
        },
        {
            "sql_id": "app_q1_23",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1998-05-08' AND '1998-05-22')\nAND sourceip IN ('76.65.227.200')\nAND countrycode = 'SDN';"
        },
        {
            "sql_id": "app_q1_24",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '2005-04-23' AND '2005-05-07')\nAND sourceip IN ('234.109.223.237')\nAND countrycode = 'SVN';"
        },
        {
            "sql_id": "app_q1_25",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '2000-02-13' AND '2000-02-27')\nAND sourceip IN ('74.114.201.96')\nAND countrycode = 'MEX';"
        },
        {
            "sql_id": "app_q1_26",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '2003-12-08' AND '2003-12-22')\nAND sourceip IN ('161.53.126.208')\nAND countrycode = 'CHN';"
        },
        {
            "sql_id": "app_q1_27",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '2008-02-26' AND '2008-03-11')\nAND sourceip IN ('4.62.207.199')\nAND countrycode = 'BEL';"
        },
        {
            "sql_id": "app_q1_28",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1972-11-07' AND '1972-11-21')\nAND sourceip IN ('141.240.118.46')\nAND countrycode = 'HND';"
        },
        {
            "sql_id": "app_q1_29",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1982-08-27' AND '1982-09-10')\nAND sourceip IN ('2.160.7.43')\nAND countrycode = 'PRY';"
        },
        {
            "sql_id": "app_q1_30",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1975-07-08' AND '1975-07-22')\nAND sourceip IN ('25.4.50.129')\nAND countrycode = 'CRI';"
        },
        {
            "sql_id": "app_q1_31",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1972-08-28' AND '1972-09-11')\nAND sourceip IN ('229.89.175.66')\nAND countrycode = 'KWT';"
        },
        {
            "sql_id": "app_q1_32",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1979-01-16' AND '1979-01-30')\nAND sourceip IN ('19.244.161.165')\nAND countrycode = 'EGY';"
        },
        {
            "sql_id": "app_q1_33",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '2002-07-16' AND '2002-07-30')\nAND sourceip IN ('152.72.140.76')\nAND countrycode = 'FRA';"
        },
        {
            "sql_id": "app_q1_34",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1973-09-26' AND '1973-10-10')\nAND sourceip IN ('81.170.146.107')\nAND countrycode = 'PER';"
        },
        {
            "sql_id": "app_q1_35",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1993-08-28' AND '1993-09-11')\nAND sourceip IN ('32.218.48.83')\nAND countrycode = 'ECU';"
        },
        {
            "sql_id": "app_q1_36",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1994-08-22' AND '1994-09-05')\nAND sourceip IN ('253.100.76.144')\nAND countrycode = 'LVA';"
        },
        {
            "sql_id": "app_q1_37",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '2001-03-22' AND '2001-04-05')\nAND sourceip IN ('42.234.252.118')\nAND countrycode = 'MLT';"
        },
        {
            "sql_id": "app_q1_38",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '2003-05-19' AND '2003-06-02')\nAND sourceip IN ('78.191.84.35')\nAND countrycode = 'ITA';"
        },
        {
            "sql_id": "app_q1_39",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1981-03-27' AND '1981-04-10')\nAND sourceip IN ('132.195.43.224')\nAND countrycode = 'EST';"
        },
        {
            "sql_id": "app_q1_40",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '2001-12-13' AND '2001-12-27')\nAND sourceip IN ('207.176.119.89')\nAND countrycode = 'ZAF';"
        },
        {
            "sql_id": "app_q1_41",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1992-11-21' AND '1992-12-05')\nAND sourceip IN ('55.89.238.166')\nAND countrycode = 'DZA';"
        },
        {
            "sql_id": "app_q1_42",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1997-10-29' AND '1997-11-12')\nAND sourceip IN ('147.72.12.80')\nAND countrycode = 'SVN';"
        },
        {
            "sql_id": "app_q1_43",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '2001-08-03' AND '2001-08-17')\nAND sourceip IN ('218.130.112.70')\nAND countrycode = 'PHL';"
        },
        {
            "sql_id": "app_q1_44",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1977-06-02' AND '1977-06-16')\nAND sourceip IN ('207.188.239.55')\nAND countrycode = 'PHL';"
        },
        {
            "sql_id": "app_q1_45",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '2004-08-30' AND '2004-09-13')\nAND sourceip IN ('141.97.41.61')\nAND countrycode = 'ROU';"
        },
        {
            "sql_id": "app_q1_46",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '2007-05-31' AND '2007-06-14')\nAND sourceip IN ('240.198.42.42')\nAND countrycode = 'BGR';"
        },
        {
            "sql_id": "app_q1_47",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '2005-02-08' AND '2005-02-22')\nAND sourceip IN ('202.214.58.93')\nAND countrycode = 'EGY';"
        },
        {
            "sql_id": "app_q1_48",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1992-04-05' AND '1992-04-19')\nAND sourceip IN ('140.18.250.56')\nAND countrycode = 'LBN';"
        },
        {
            "sql_id": "app_q1_49",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1975-05-15' AND '1975-05-29')\nAND sourceip IN ('188.121.12.54')\nAND countrycode = 'COL';"
        },
        {
            "sql_id": "app_q1_50",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1991-07-29' AND '1991-08-12')\nAND sourceip IN ('131.191.111.248')\nAND countrycode = 'HKG';"
        },
        {
            "sql_id": "app_q1_51",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1975-11-28' AND '1975-12-12')\nAND sourceip IN ('6.24.240.140')\nAND countrycode = 'TUN';"
        },
        {
            "sql_id": "app_q1_52",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1991-07-11' AND '1991-07-25')\nAND sourceip IN ('71.214.17.44')\nAND countrycode = 'YEM';"
        },
        {
            "sql_id": "app_q1_53",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1981-12-26' AND '1982-01-09')\nAND sourceip IN ('87.155.145.5')\nAND countrycode = 'PER';"
        },
        {
            "sql_id": "app_q1_54",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1996-02-03' AND '1996-02-17')\nAND sourceip IN ('131.70.50.33')\nAND countrycode = 'AUS';"
        },
        {
            "sql_id": "app_q1_55",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1985-05-02' AND '1985-05-16')\nAND sourceip IN ('191.100.180.15')\nAND countrycode = 'SRB';"
        },
        {
            "sql_id": "app_q1_56",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1970-06-29' AND '1970-07-13')\nAND sourceip IN ('201.151.47.172')\nAND countrycode = 'SVK';"
        },
        {
            "sql_id": "app_q1_57",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '2001-03-27' AND '2001-04-10')\nAND sourceip IN ('60.24.157.83')\nAND countrycode = 'TUR';"
        },
        {
            "sql_id": "app_q1_58",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1971-03-15' AND '1971-03-29')\nAND sourceip IN ('168.94.219.247')\nAND countrycode = 'GBR';"
        },
        {
            "sql_id": "app_q1_59",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1975-03-02' AND '1975-03-16')\nAND sourceip IN ('163.96.107.94')\nAND countrycode = 'SVN';"
        },
        {
            "sql_id": "app_q1_60",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '2000-11-23' AND '2000-12-07')\nAND sourceip IN ('227.198.89.182')\nAND countrycode = 'GBR';"
        },
        {
            "sql_id": "app_q1_61",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1999-10-30' AND '1999-11-13')\nAND sourceip IN ('205.93.185.52')\nAND countrycode = 'LTU';"
        },
        {
            "sql_id": "app_q1_62",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1979-02-08' AND '1979-02-22')\nAND sourceip IN ('236.59.19.57')\nAND countrycode = 'GTM';"
        },
        {
            "sql_id": "app_q1_63",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1985-02-13' AND '1985-02-27')\nAND sourceip IN ('118.122.137.161')\nAND countrycode = 'THA';"
        },
        {
            "sql_id": "app_q1_64",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '2009-10-17' AND '2009-10-31')\nAND sourceip IN ('218.241.109.240')\nAND countrycode = 'CZE';"
        },
        {
            "sql_id": "app_q1_65",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '2010-06-27' AND '2010-07-11')\nAND sourceip IN ('115.85.38.26')\nAND countrycode = 'MEX';"
        },
        {
            "sql_id": "app_q1_66",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1980-07-11' AND '1980-07-25')\nAND sourceip IN ('69.12.21.108')\nAND countrycode = 'CHE';"
        },
        {
            "sql_id": "app_q1_67",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1988-06-07' AND '1988-06-21')\nAND sourceip IN ('123.201.143.183')\nAND countrycode = 'CAN';"
        },
        {
            "sql_id": "app_q1_68",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1977-04-17' AND '1977-05-01')\nAND sourceip IN ('205.136.136.106')\nAND countrycode = 'PRI';"
        },
        {
            "sql_id": "app_q1_69",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1971-03-06' AND '1971-03-20')\nAND sourceip IN ('173.220.220.107')\nAND countrycode = 'USA';"
        },
        {
            "sql_id": "app_q1_70",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '2008-11-10' AND '2008-11-24')\nAND sourceip IN ('41.225.188.166')\nAND countrycode = 'MEX';"
        },
        {
            "sql_id": "app_q1_71",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1988-04-25' AND '1988-05-09')\nAND sourceip IN ('197.65.250.140')\nAND countrycode = 'ESP';"
        },
        {
            "sql_id": "app_q1_72",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1972-04-22' AND '1972-05-06')\nAND sourceip IN ('5.41.11.83')\nAND countrycode = 'BOL';"
        },
        {
            "sql_id": "app_q1_73",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '2003-01-07' AND '2003-01-21')\nAND sourceip IN ('52.211.218.137')\nAND countrycode = 'THA';"
        },
        {
            "sql_id": "app_q1_74",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1981-07-11' AND '1981-07-25')\nAND sourceip IN ('221.79.217.205')\nAND countrycode = 'HKG';"
        },
        {
            "sql_id": "app_q1_75",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1994-05-26' AND '1994-06-09')\nAND sourceip IN ('95.126.25.228')\nAND countrycode = 'PER';"
        },
        {
            "sql_id": "app_q1_76",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '2002-04-29' AND '2002-05-13')\nAND sourceip IN ('11.82.58.46')\nAND countrycode = 'AUT';"
        },
        {
            "sql_id": "app_q1_77",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1972-11-25' AND '1972-12-09')\nAND sourceip IN ('164.7.164.134')\nAND countrycode = 'PRI';"
        },
        {
            "sql_id": "app_q1_78",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '2000-10-31' AND '2000-11-14')\nAND sourceip IN ('225.125.160.198')\nAND countrycode = 'VNM';"
        },
        {
            "sql_id": "app_q1_79",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1995-10-01' AND '1995-10-15')\nAND sourceip IN ('50.146.8.51')\nAND countrycode = 'HKG';"
        },
        {
            "sql_id": "app_q1_80",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1973-12-13' AND '1973-12-27')\nAND sourceip IN ('156.228.46.116')\nAND countrycode = 'BGR';"
        },
        {
            "sql_id": "app_q2_1",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.66.158')\n            and countrycode < 'zzz'\n            and visitdate between '1971-07-01' and '1971-07-06'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.101.15')\n            and countrycode < 'zzz'\n            and visitdate between '1971-07-01' and '1971-07-06'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_2",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.92.183')\n            and countrycode < 'zzz'\n            and visitdate between '1983-09-21' and '1983-09-26'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.162.183')\n            and countrycode < 'zzz'\n            and visitdate between '1983-09-21' and '1983-09-26'\n            and useragent = 'Iewmrdjfnkarrwndwgfu/7.7'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_3",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.64.250')\n            and countrycode < 'zzz'\n            and visitdate between '1993-04-22' and '1993-04-27'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 5.5; Windows NT 5.0)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.124.248')\n            and countrycode < 'zzz'\n            and visitdate between '1993-04-22' and '1993-04-27'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_4",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.62.112')\n            and countrycode < 'zzz'\n            and visitdate between '2004-04-21' and '2004-04-26'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.140.89')\n            and countrycode < 'zzz'\n            and visitdate between '2004-04-21' and '2004-04-26'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 5.5; Windows 98; Win 9x 4.90)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_5",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.82.133')\n            and countrycode < 'zzz'\n            and visitdate between '1970-02-10' and '1970-02-15'\n            and useragent = 'Vbnbegnffndw/5.4'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.137.221')\n            and countrycode < 'zzz'\n            and visitdate between '1970-02-10' and '1970-02-15'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_6",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.73.210')\n            and countrycode < 'zzz'\n            and visitdate between '1982-05-03' and '1982-05-08'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.118.205')\n            and countrycode < 'zzz'\n            and visitdate between '1982-05-03' and '1982-05-08'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_7",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.98.59')\n            and countrycode < 'zzz'\n            and visitdate between '1994-09-26' and '1994-10-01'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.155.68')\n            and countrycode < 'zzz'\n            and visitdate between '1994-09-26' and '1994-10-01'\n            and useragent = 'Lqjtfya/6.8'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_8",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.84.203')\n            and countrycode < 'zzz'\n            and visitdate between '2005-09-25' and '2005-09-30'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.129.93')\n            and countrycode < 'zzz'\n            and visitdate between '2005-09-25' and '2005-09-30'\n            and useragent = 'Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_9",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.72.31')\n            and countrycode < 'zzz'\n            and visitdate between '1974-05-10' and '1974-05-15'\n            and useragent = 'Mozilla/5.0 (Macintosh; U; PPC Mac OS X; en) AppleWebKit/125.2 (KHTML like Gecko) Safari/125.8'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.0.29')\n            and countrycode < 'zzz'\n            and visitdate between '1974-05-10' and '1974-05-15'\n            and useragent = 'Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_10",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.221.39')\n            and countrycode < 'zzz'\n            and visitdate between '1986-06-29' and '1986-07-04'\n            and useragent = 'Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.10.202')\n            and countrycode < 'zzz'\n            and visitdate between '1986-06-29' and '1986-07-04'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_11",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.95.184')\n            and countrycode < 'zzz'\n            and visitdate between '1996-03-01' and '1996-03-06'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.157.120')\n            and countrycode < 'zzz'\n            and visitdate between '1996-03-01' and '1996-03-06'\n            and useragent = 'Opera 8.0 (Win 2000): Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; en) Opera 8.0'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_12",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.68.88')\n            and countrycode < 'zzz'\n            and visitdate between '2007-01-28' and '2007-02-02'\n            and useragent = 'xticgafc/0.1'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.111.244')\n            and countrycode < 'zzz'\n            and visitdate between '2007-01-28' and '2007-02-02'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_13",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.95.129')\n            and countrycode < 'zzz'\n            and visitdate between '1972-12-20' and '1972-12-25'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.159.211')\n            and countrycode < 'zzz'\n            and visitdate between '1972-12-20' and '1972-12-25'\n            and useragent = 'Nprcyccg/3.4'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_14",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.79.156')\n            and countrycode < 'zzz'\n            and visitdate between '1985-02-08' and '1985-02-13'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.126.141')\n            and countrycode < 'zzz'\n            and visitdate between '1985-02-08' and '1985-02-13'\n            and useragent = 'Mozilla/5.0 (Macintosh; U; PPC Mac OS X; en) AppleWebKit/125.2 (KHTML like Gecko) Safari/85.8'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_15",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.94.185')\n            and countrycode < 'zzz'\n            and visitdate between '1997-08-05' and '1997-08-10'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.142.171')\n            and countrycode < 'zzz'\n            and visitdate between '1997-08-05' and '1997-08-10'\n            and useragent = 'Mozilla/5.0 (Windows; U; Windows NT 5.2)AppleWebKit/525.13 (KHTML like Gecko) Version/3.1Safari/525.13'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_16",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.24.65')\n            and countrycode < 'zzz'\n            and visitdate between '2008-07-03' and '2008-07-08'\n            and useragent = 'Drnqu/8.'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.131.56')\n            and countrycode < 'zzz'\n            and visitdate between '2008-07-03' and '2008-07-08'\n            and useragent = 'Kxnhjfnnlpcda/4.'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_17",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.8.65')\n            and countrycode < 'zzz'\n            and visitdate between '1977-05-04' and '1977-05-09'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.122.165')\n            and countrycode < 'zzz'\n            and visitdate between '1977-05-04' and '1977-05-09'\n            and useragent = 'Netscape 4.8 (Windows Vista): Mozilla/4.8 (Windows NT 6.0; U)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_18",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.44.66')\n            and countrycode < 'zzz'\n            and visitdate between '1989-06-23' and '1989-06-28'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.105.199')\n            and countrycode < 'zzz'\n            and visitdate between '1989-06-23' and '1989-06-28'\n            and useragent = 'Trbeirmbvymptbyxro/4.5'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_19",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.80.140')\n            and countrycode < 'zzz'\n            and visitdate between '1998-10-23' and '1998-10-28'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.1.221')\n            and countrycode < 'zzz'\n            and visitdate between '1998-10-23' and '1998-10-28'\n            and useragent = 'Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/0.2.149.27 Safari/525.13'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_20",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.56.163')\n            and countrycode < 'zzz'\n            and visitdate between '2009-09-20' and '2009-09-25'\n            and useragent = 'Mozilla/5.0 (Windows; U; Windows NT 5.2)AppleWebKit/525.13 (KHTML like Gecko) Version/3.1Safari/525.13'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.120.87')\n            and countrycode < 'zzz'\n            and visitdate between '2009-09-20' and '2009-09-25'\n            and useragent = 'iPhone 3.0: Mozilla/5.0 (iPhone; U; CPU iPhone OS 3_0 like Mac OS X; en-us) AppleWebKit/528.18 (KHTML like Gecko) Version/4.0 Mobile/7A341 Safari/528.16'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_21",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.51.19')\n            and countrycode < 'zzz'\n            and visitdate between '1975-12-03' and '1975-12-08'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.108.89')\n            and countrycode < 'zzz'\n            and visitdate between '1975-12-03' and '1975-12-08'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_22",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.30.83')\n            and countrycode < 'zzz'\n            and visitdate between '1988-01-22' and '1988-01-27'\n            and useragent = 'Mozilla/5.0 (Windows; U; Windows NT 5.2)Gecko/2008070208 Firefox/3.0.1'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.103.29')\n            and countrycode < 'zzz'\n            and visitdate between '1988-01-22' and '1988-01-27'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_23",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.248.168')\n            and countrycode < 'zzz'\n            and visitdate between '2000-03-08' and '2000-03-13'\n            and useragent = 'Opera 7.51 (Win XP): Opera/7.51 (Windows NT 5.1; U)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.143.35')\n            and countrycode < 'zzz'\n            and visitdate between '2000-03-08' and '2000-03-13'\n            and useragent = 'Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_24",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.99.236')\n            and countrycode < 'zzz'\n            and visitdate between '2011-02-04' and '2011-02-09'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.116.144')\n            and countrycode < 'zzz'\n            and visitdate between '2011-02-04' and '2011-02-09'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_25",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.74.66')\n            and countrycode < 'zzz'\n            and visitdate between '1980-02-10' and '1980-02-15'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.111.131')\n            and countrycode < 'zzz'\n            and visitdate between '1980-02-10' and '1980-02-15'\n            and useragent = 'Uhaeciqyplhspvcucg/.0'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_26",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.95.54')\n            and countrycode < 'zzz'\n            and visitdate between '1992-05-02' and '1992-05-07'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.1.111.60')\n            and countrycode < 'zzz'\n            and visitdate between '1992-05-02' and '1992-05-07'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_27",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.73.41')\n            and countrycode < 'zzz'\n            and visitdate between '2001-07-31' and '2001-08-05'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.137.118')\n            and countrycode < 'zzz'\n            and visitdate between '2001-07-31' and '2001-08-05'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_28",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.92.15')\n            and countrycode < 'zzz'\n            and visitdate between '1978-09-10' and '1978-09-15'\n            and useragent = 'Ifqbkqquuyspo/7.5'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.130.77')\n            and countrycode < 'zzz'\n            and visitdate between '1978-09-10' and '1978-09-15'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_29",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.243.212')\n            and countrycode < 'zzz'\n            and visitdate between '1990-12-01' and '1990-12-06'\n            and useragent = 'Axghfwqdacsrfi/.6'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.108.253')\n            and countrycode < 'zzz'\n            and visitdate between '1990-12-01' and '1990-12-06'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_30",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.96.95')\n            and countrycode < 'zzz'\n            and visitdate between '2002-12-15' and '2002-12-20'\n            and useragent = 'Opera 7.51 (Win XP): Opera/7.51 (Windows NT 5.1; U)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.170.72')\n            and countrycode < 'zzz'\n            and visitdate between '2002-12-15' and '2002-12-20'\n            and useragent = 'Opera 9.2 (Windows Vista): Opera/9.20 (Windows NT 6.0; U; en)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_31",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.42.86')\n            and countrycode < 'zzz'\n            and visitdate between '1972-03-18' and '1972-03-23'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 5.5; Windows NT 5.0)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.108.184')\n            and countrycode < 'zzz'\n            and visitdate between '1972-03-18' and '1972-03-23'\n            and useragent = 'Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_32",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.78.185')\n            and countrycode < 'zzz'\n            and visitdate between '1983-01-11' and '1983-01-16'\n            and useragent = 'Fwlxd/7.4'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.119.147')\n            and countrycode < 'zzz'\n            and visitdate between '1983-01-11' and '1983-01-16'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_33",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.3.207')\n            and countrycode < 'zzz'\n            and visitdate between '1992-08-14' and '1992-08-19'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.117.135')\n            and countrycode < 'zzz'\n            and visitdate between '1992-08-14' and '1992-08-19'\n            and useragent = 'Tbjjrodkwijkbjtwno/3.'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_34",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.50.10')\n            and countrycode < 'zzz'\n            and visitdate between '2005-01-05' and '2005-01-10'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.120.137')\n            and countrycode < 'zzz'\n            and visitdate between '2005-01-05' and '2005-01-10'\n            and useragent = 'Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_35",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.69.175')\n            and countrycode < 'zzz'\n            and visitdate between '1970-10-29' and '1970-11-03'\n            and useragent = 'Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.11.126')\n            and countrycode < 'zzz'\n            and visitdate between '1970-10-29' and '1970-11-03'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_36",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.242.191')\n            and countrycode < 'zzz'\n            and visitdate between '1981-08-23' and '1981-08-28'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.106.1')\n            and countrycode < 'zzz'\n            and visitdate between '1981-08-23' and '1981-08-28'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_37",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.95.78')\n            and countrycode < 'zzz'\n            and visitdate between '1994-01-18' and '1994-01-23'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.105.177')\n            and countrycode < 'zzz'\n            and visitdate between '1994-01-18' and '1994-01-23'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_38",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.91.73')\n            and countrycode < 'zzz'\n            and visitdate between '2006-06-11' and '2006-06-16'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.129.63')\n            and countrycode < 'zzz'\n            and visitdate between '2006-06-11' and '2006-06-16'\n            and useragent = 'Wotyydewrkaykqhixlv/3.1'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_39",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.73.127')\n            and countrycode < 'zzz'\n            and visitdate between '1975-01-18' and '1975-01-23'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.116.78')\n            and countrycode < 'zzz'\n            and visitdate between '1975-01-18' and '1975-01-23'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_40",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.52.1')\n            and countrycode < 'zzz'\n            and visitdate between '1985-10-11' and '1985-10-16'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.107.139')\n            and countrycode < 'zzz'\n            and visitdate between '1985-10-11' and '1985-10-16'\n            and useragent = 'Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_41",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.98.159')\n            and countrycode < 'zzz'\n            and visitdate between '1995-06-16' and '1995-06-21'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.128.87')\n            and countrycode < 'zzz'\n            and visitdate between '1995-06-16' and '1995-06-21'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_42",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.77.36')\n            and countrycode < 'zzz'\n            and visitdate between '2007-10-06' and '2007-10-11'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.125.170')\n            and countrycode < 'zzz'\n            and visitdate between '2007-10-06' and '2007-10-11'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_43",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.62.25')\n            and countrycode < 'zzz'\n            and visitdate between '1973-08-30' and '1973-09-04'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.130.157')\n            and countrycode < 'zzz'\n            and visitdate between '1973-08-30' and '1973-09-04'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_44",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.56.5')\n            and countrycode < 'zzz'\n            and visitdate between '1984-05-23' and '1984-05-28'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.132.154')\n            and countrycode < 'zzz'\n            and visitdate between '1984-05-23' and '1984-05-28'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 5.5; Windows 98; Win 9x 4.90)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_45",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.97.165')\n            and countrycode < 'zzz'\n            and visitdate between '1996-11-19' and '1996-11-24'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.125.196')\n            and countrycode < 'zzz'\n            and visitdate between '1996-11-19' and '1996-11-24'\n            and useragent = 'Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_46",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.92.136')\n            and countrycode < 'zzz'\n            and visitdate between '2009-03-11' and '2009-03-16'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.15.139')\n            and countrycode < 'zzz'\n            and visitdate between '2009-03-11' and '2009-03-16'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 5.5; Windows 98; Win 9x 4.90)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_47",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.56.252')\n            and countrycode < 'zzz'\n            and visitdate between '1978-01-20' and '1978-01-25'\n            and useragent = 'Ivjcjaodmxfmub/4.0'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.102.218')\n            and countrycode < 'zzz'\n            and visitdate between '1978-01-20' and '1978-01-25'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_48",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.34.101')\n            and countrycode < 'zzz'\n            and visitdate between '1988-10-13' and '1988-10-18'\n            and useragent = 'Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.120.58')\n            and countrycode < 'zzz'\n            and visitdate between '1988-10-13' and '1988-10-18'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_49",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.88.164')\n            and countrycode < 'zzz'\n            and visitdate between '1998-02-14' and '1998-02-19'\n            and useragent = 'Vhinbpoveodvxhqknprpeh/2.'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.102.82')\n            and countrycode < 'zzz'\n            and visitdate between '1998-02-14' and '1998-02-19'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_50",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.93.225')\n            and countrycode < 'zzz'\n            and visitdate between '2010-06-06' and '2010-06-11'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.134.52')\n            and countrycode < 'zzz'\n            and visitdate between '2010-06-06' and '2010-06-11'\n            and useragent = 'Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_51",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.85.94')\n            and countrycode < 'zzz'\n            and visitdate between '1976-08-20' and '1976-08-25'\n            and useragent = 'Shfmmabgxpb/0.8'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.102.243')\n            and countrycode < 'zzz'\n            and visitdate between '1976-08-20' and '1976-08-25'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_52",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.97.22')\n            and countrycode < 'zzz'\n            and visitdate between '1987-05-14' and '1987-05-19'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.136.127')\n            and countrycode < 'zzz'\n            and visitdate between '1987-05-14' and '1987-05-19'\n            and useragent = 'Mozilla/5.0 (Windows; U; Windows NT 5.2)AppleWebKit/525.13 (KHTML like Gecko) Version/3.1Safari/525.13'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_53",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.99.201')\n            and countrycode < 'zzz'\n            and visitdate between '1999-07-01' and '1999-07-06'\n            and useragent = 'Rkaaarfsnyewg/1.1'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.147.121')\n            and countrycode < 'zzz'\n            and visitdate between '1999-07-01' and '1999-07-06'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_54",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.183.231')\n            and countrycode < 'zzz'\n            and visitdate between '2011-10-21' and '2011-10-26'\n            and useragent = 'Drdsehqvhornmgr/7.7'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.105.16')\n            and countrycode < 'zzz'\n            and visitdate between '2011-10-21' and '2011-10-26'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_55",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.92.57')\n            and countrycode < 'zzz'\n            and visitdate between '1980-10-20' and '1980-10-25'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.10.160')\n            and countrycode < 'zzz'\n            and visitdate between '1980-10-20' and '1980-10-25'\n            and useragent = 'Lsrelewwdshhaikadrx/6.6'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_56",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.83.95')\n            and countrycode < 'zzz'\n            and visitdate between '1991-08-15' and '1991-08-20'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.139.143')\n            and countrycode < 'zzz'\n            and visitdate between '1991-08-15' and '1991-08-20'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_57",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.75.232')\n            and countrycode < 'zzz'\n            and visitdate between '2000-11-14' and '2000-11-19'\n            and useragent = 'Mozilla/5.0 (Windows; U; Windows NT 5.2)AppleWebKit/525.13 (KHTML like Gecko) Version/3.1Safari/525.13'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.109.143')\n            and countrycode < 'zzz'\n            and visitdate between '2000-11-14' and '2000-11-19'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_58",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.65.21')\n            and countrycode < 'zzz'\n            and visitdate between '1979-05-21' and '1979-05-26'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.213.64')\n            and countrycode < 'zzz'\n            and visitdate between '1979-05-21' and '1979-05-26'\n            and useragent = 'Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_59",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.80.71')\n            and countrycode < 'zzz'\n            and visitdate between '1990-03-15' and '1990-03-20'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.117.33')\n            and countrycode < 'zzz'\n            and visitdate between '1990-03-15' and '1990-03-20'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_60",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.91.215')\n            and countrycode < 'zzz'\n            and visitdate between '2002-03-31' and '2002-04-05'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.124.104')\n            and countrycode < 'zzz'\n            and visitdate between '2002-03-31' and '2002-04-05'\n            and useragent = 'Srrsmvryqfs/2.2'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_61",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.46.171')\n            and countrycode < 'zzz'\n            and visitdate between '1977-11-22' and '1977-11-27'\n            and useragent = 'Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.110.254')\n            and countrycode < 'zzz'\n            and visitdate between '1977-11-22' and '1977-11-27'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_62",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.84.217')\n            and countrycode < 'zzz'\n            and visitdate between '1988-11-21' and '1988-11-26'\n            and useragent = 'Fqlqngcumaouhfb/0.1'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.127.35')\n            and countrycode < 'zzz'\n            and visitdate between '1988-11-21' and '1988-11-26'\n            and useragent = 'Mozilla/5.0 (Windows; U; Windows NT 5.2)AppleWebKit/525.13 (KHTML like Gecko) Version/3.1Safari/525.13'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_63",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.79.53')\n            and countrycode < 'zzz'\n            and visitdate between '1998-02-15' and '1998-02-20'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.174.23')\n            and countrycode < 'zzz'\n            and visitdate between '1998-02-15' and '1998-02-20'\n            and useragent = 'Wiutyscmmmaynrswljnl/0.0'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_64",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.56.92')\n            and countrycode < 'zzz'\n            and visitdate between '2010-05-08' and '2010-05-13'\n            and useragent = 'Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.140.104')\n            and countrycode < 'zzz'\n            and visitdate between '2010-05-08' and '2010-05-13'\n            and useragent = 'Ohmrohtutaipeuxdyvkc/7.1'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_65",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.37.108')\n            and countrycode < 'zzz'\n            and visitdate between '1976-07-04' and '1976-07-09'\n            and useragent = 'foanyrgdaivuwwdl/7.5'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.128.165')\n            and countrycode < 'zzz'\n            and visitdate between '1976-07-04' and '1976-07-09'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_66",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.81.24')\n            and countrycode < 'zzz'\n            and visitdate between '1987-07-04' and '1987-07-09'\n            and useragent = 'Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.100.52')\n            and countrycode < 'zzz'\n            and visitdate between '1987-07-04' and '1987-07-09'\n            and useragent = 'Mozilla/5.0 (Windows; U; Windows NT 5.2)Gecko/2008070208 Firefox/3.0.1'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_67",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.89.151')\n            and countrycode < 'zzz'\n            and visitdate between '1999-07-22' and '1999-07-27'\n            and useragent = 'Mozilla/5.0 (Windows; U; Windows NT 5.2)AppleWebKit/525.13 (KHTML like Gecko) Version/3.1Safari/525.13'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.11.248')\n            and countrycode < 'zzz'\n            and visitdate between '1999-07-22' and '1999-07-27'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_68",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.48.197')\n            and countrycode < 'zzz'\n            and visitdate between '2011-10-12' and '2011-10-17'\n            and useragent = 'Tajbjfclycux/6.4'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.11.212')\n            and countrycode < 'zzz'\n            and visitdate between '2011-10-12' and '2011-10-17'\n            and useragent = 'Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_69",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.71.31')\n            and countrycode < 'zzz'\n            and visitdate between '1980-10-01' and '1980-10-06'\n            and useragent = 'Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.108.141')\n            and countrycode < 'zzz'\n            and visitdate between '1980-10-01' and '1980-10-06'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_70",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.79.200')\n            and countrycode < 'zzz'\n            and visitdate between '1991-08-30' and '1991-09-04'\n            and useragent = 'Ifmnihantyevpexekv/8.7'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.101.248')\n            and countrycode < 'zzz'\n            and visitdate between '1991-08-30' and '1991-09-04'\n            and useragent = 'Mozilla/5.0 (Windows; U; Windows NT 5.1)Gecko/20070803 Firefox/1.5.0.12'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_71",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.75.56')\n            and countrycode < 'zzz'\n            and visitdate between '2000-12-25' and '2000-12-30'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.168.121')\n            and countrycode < 'zzz'\n            and visitdate between '2000-12-25' and '2000-12-30'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_72",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.5.50')\n            and countrycode < 'zzz'\n            and visitdate between '1979-05-14' and '1979-05-19'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.100.18')\n            and countrycode < 'zzz'\n            and visitdate between '1979-05-14' and '1979-05-19'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_73",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.97.211')\n            and countrycode < 'zzz'\n            and visitdate between '1990-04-11' and '1990-04-16'\n            and useragent = 'Mozilla/5.0 (Windows; U; Windows NT 5.2)Gecko/2008070208 Firefox/3.0.1'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.106.29')\n            and countrycode < 'zzz'\n            and visitdate between '1990-04-11' and '1990-04-16'\n            and useragent = 'Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_74",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.84.96')\n            and countrycode < 'zzz'\n            and visitdate between '2002-05-31' and '2002-06-05'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.151.81')\n            and countrycode < 'zzz'\n            and visitdate between '2002-05-31' and '2002-06-05'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_75",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.244.191')\n            and countrycode < 'zzz'\n            and visitdate between '1972-03-03' and '1972-03-08'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.111.26')\n            and countrycode < 'zzz'\n            and visitdate between '1972-03-03' and '1972-03-08'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_76",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.33.122')\n            and countrycode < 'zzz'\n            and visitdate between '1983-01-30' and '1983-02-04'\n            and useragent = 'Netscape 4.8 (Windows Vista): Mozilla/4.8 (Windows NT 6.0; U)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.145.29')\n            and countrycode < 'zzz'\n            and visitdate between '1983-01-30' and '1983-02-04'\n            and useragent = 'Xngudyikbqpbrqvhxg/0.2'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_77",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.199.202')\n            and countrycode < 'zzz'\n            and visitdate between '1992-10-06' and '1992-10-11'\n            and useragent = 'Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.134.90')\n            and countrycode < 'zzz'\n            and visitdate between '1992-10-06' and '1992-10-11'\n            and useragent = 'iPhone 3.0: Mozilla/5.0 (iPhone; U; CPU iPhone OS 3_0 like Mac OS X; en-us) AppleWebKit/528.18 (KHTML like Gecko) Version/4.0 Mobile/7A341 Safari/528.16'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_78",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.39.80')\n            and countrycode < 'zzz'\n            and visitdate between '2004-11-25' and '2004-11-30'\n            and useragent = 'Netscape 2.02 (Win 95): Mozilla/2.02E (Win95; U)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.18.218')\n            and countrycode < 'zzz'\n            and visitdate between '2004-11-25' and '2004-11-30'\n            and useragent = 'Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_79",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.172.9')\n            and countrycode < 'zzz'\n            and visitdate between '1970-10-02' and '1970-10-07'\n            and useragent = 'Junmvgvv/8.6'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.89.220')\n            and countrycode < 'zzz'\n            and visitdate between '1970-10-02' and '1970-10-07'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_80",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.95.104')\n            and countrycode < 'zzz'\n            and visitdate between '1981-08-30' and '1981-09-04'\n            and useragent = 'Ykgtbdklivkwatstrjrafp/.8'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.108.17')\n            and countrycode < 'zzz'\n            and visitdate between '1981-08-30' and '1981-09-04'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q3_1",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '146.238.21.87' and visitdate between '1978-09-06' and '1978-09-07'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_2",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '126.186.229.163' and visitdate between '1990-11-27' and '1990-11-28'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_3",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '214.42.216.228' and visitdate between '2002-12-11' and '2002-12-12'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_4",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '18.153.100.198' and visitdate between '1980-02-06' and '1980-02-07'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_5",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '177.66.252.108' and visitdate between '1992-04-28' and '1992-04-29'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_6",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '37.253.147.19' and visitdate between '2001-07-27' and '2001-07-28'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_7",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '51.108.101.249' and visitdate between '1975-12-07' and '1975-12-08'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_8",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '25.23.18.39' and visitdate between '1988-01-26' and '1988-01-27'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_9",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '45.120.58.238' and visitdate between '2000-03-12' and '2000-03-13'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_10",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '49.91.244.138' and visitdate between '2011-02-08' and '2011-02-09'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_11",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '96.195.43.146' and visitdate between '1977-05-08' and '1977-05-09'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_12",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '99.168.13.197' and visitdate between '1989-06-27' and '1989-06-28'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_13",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '153.105.72.114' and visitdate between '1998-10-27' and '1998-10-28'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_14",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '63.54.44.8' and visitdate between '2009-09-24' and '2009-09-25'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_15",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '188.171.191.82' and visitdate between '1972-12-16' and '1972-12-17'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_16",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '230.8.126.125' and visitdate between '1985-02-04' and '1985-02-05'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_17",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '135.88.68.180' and visitdate between '1997-08-01' and '1997-08-02'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_18",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '132.56.166.2' and visitdate between '2008-06-29' and '2008-06-30'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_19",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '69.105.88.145' and visitdate between '1974-05-06' and '1974-05-07'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_20",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '247.3.205.220' and visitdate between '1986-06-25' and '1986-06-26'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_21",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '187.101.131.193' and visitdate between '1996-02-26' and '1996-02-27'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_22",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '148.75.185.254' and visitdate between '2007-01-24' and '2007-01-25'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_23",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '109.166.111.214' and visitdate between '1970-02-14' and '1970-02-15'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_24",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '220.55.198.148' and visitdate between '1982-05-07' and '1982-05-08'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_25",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '191.31.46.227' and visitdate between '1994-09-30' and '1994-10-01'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_26",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '81.90.19.69' and visitdate between '2005-09-29' and '2005-09-30'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_27",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '242.154.85.244' and visitdate between '1971-07-05' and '1971-07-06'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_28",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '10.108.93.38' and visitdate between '1983-09-25' and '1983-09-26'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_29",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '177.252.218.251' and visitdate between '1993-04-26' and '1993-04-27'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_30",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '24.130.51.63' and visitdate between '2004-04-25' and '2004-04-26'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_31",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '31.36.251.46' and visitdate between '1979-05-25' and '1979-05-26'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_32",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '214.25.52.32' and visitdate between '1990-03-19' and '1990-03-20'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_33",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '107.90.35.53' and visitdate between '2002-04-04' and '2002-04-05'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_34",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '165.179.233.85' and visitdate between '1980-10-24' and '1980-10-25'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_35",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '240.0.32.160' and visitdate between '1991-08-19' and '1991-08-20'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_36",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '76.226.199.87' and visitdate between '2000-11-18' and '2000-11-19'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_37",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '164.155.42.24' and visitdate between '1976-08-16' and '1976-08-17'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_38",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '246.45.204.71' and visitdate between '1987-05-10' and '1987-05-11'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_39",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '183.11.210.210' and visitdate between '1999-06-27' and '1999-06-28'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_40",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '134.5.180.56' and visitdate between '2011-10-17' and '2011-10-18'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_41",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '49.237.120.145' and visitdate between '1978-01-16' and '1978-01-17'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_42",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '196.65.47.93' and visitdate between '1988-10-09' and '1988-10-10'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_43",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '192.19.43.76' and visitdate between '1998-02-10' and '1998-02-11'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_44",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '1.191.218.145' and visitdate between '2010-06-02' and '2010-06-03'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_45",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '71.53.230.174' and visitdate between '1973-09-03' and '1973-09-04'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_46",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '4.28.98.36' and visitdate between '1984-05-27' and '1984-05-28'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_47",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '198.179.28.86' and visitdate between '1996-11-23' and '1996-11-24'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_48",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '106.19.26.189' and visitdate between '2009-03-15' and '2009-03-16'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_49",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '149.73.120.29' and visitdate between '1975-01-22' and '1975-01-23'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_50",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '67.146.153.95' and visitdate between '1985-10-15' and '1985-10-16'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_51",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '79.158.63.85' and visitdate between '1995-06-20' and '1995-06-21'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_52",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '182.6.52.81' and visitdate between '2007-10-10' and '2007-10-11'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_53",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '86.218.157.65' and visitdate between '1970-10-25' and '1970-10-26'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_54",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '58.117.51.137' and visitdate between '1981-08-19' and '1981-08-20'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_55",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '159.228.55.117' and visitdate between '1994-01-14' and '1994-01-15'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_56",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '29.186.246.126' and visitdate between '2006-06-07' and '2006-06-08'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_57",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '73.222.98.69' and visitdate between '1972-03-14' and '1972-03-15'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_58",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '156.62.164.210' and visitdate between '1983-01-07' and '1983-01-08'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_59",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '140.77.52.249' and visitdate between '1992-08-10' and '1992-08-11'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_60",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '96.34.31.59' and visitdate between '2005-01-01' and '2005-01-02'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_61",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '25.77.152.191' and visitdate between '1971-10-14' and '1971-10-15'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_62",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '38.178.151.67' and visitdate between '1983-06-24' and '1983-06-25'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_63",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '23.155.249.221' and visitdate between '1993-10-08' and '1993-10-09'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_64",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '125.156.59.177' and visitdate between '2003-11-20' and '2003-11-21'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_65",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '87.117.230.95' and visitdate between '1970-05-10' and '1970-05-11'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_66",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '238.96.124.112' and visitdate between '1982-01-18' and '1982-01-19'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_67",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '229.170.235.60' and visitdate between '1995-02-26' and '1995-02-27'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_68",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '165.252.166.161' and visitdate between '2005-04-09' and '2005-04-10'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_69",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '161.152.10.142' and visitdate between '1974-08-23' and '1974-08-24'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_70",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '25.147.216.41' and visitdate between '1986-04-01' and '1986-04-02'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_71",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '232.65.163.83' and visitdate between '1996-08-17' and '1996-08-18'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_72",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '25.22.205.27' and visitdate between '2006-08-28' and '2006-08-29'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_73",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '77.194.94.98' and visitdate between '1973-03-19' and '1973-03-20'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_74",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '95.3.205.55' and visitdate between '1984-10-26' and '1984-10-27'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_75",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '46.124.115.50' and visitdate between '1998-01-05' and '1998-01-06'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_76",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '209.204.6.62' and visitdate between '2008-01-16' and '2008-01-17'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_77",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '206.181.113.242' and visitdate between '1977-08-01' and '1977-08-02'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_78",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '125.245.134.142' and visitdate between '1989-03-10' and '1989-03-11'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_79",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '79.155.78.202' and visitdate between '1999-03-25' and '1999-03-26'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_80",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '242.73.214.180' and visitdate between '2009-04-04' and '2009-04-05'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q4_1",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '6.231.88.53' and visitdate between '1975-06-02' and '1975-06-03';"
        },
        {
            "sql_id": "app_q4_2",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '88.243.88.91' and visitdate between '1985-06-14' and '1985-06-15';"
        },
        {
            "sql_id": "app_q4_3",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '27.129.210.57' and visitdate between '1995-10-29' and '1995-10-30';"
        },
        {
            "sql_id": "app_q4_4",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '3.89.140.67' and visitdate between '2007-06-09' and '2007-06-10';"
        },
        {
            "sql_id": "app_q4_5",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '238.219.65.227' and visitdate between '1973-12-27' and '1973-12-28';"
        },
        {
            "sql_id": "app_q4_6",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '113.72.116.174' and visitdate between '1984-01-09' and '1984-01-10';"
        },
        {
            "sql_id": "app_q4_7",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '99.129.145.176' and visitdate between '1997-03-18' and '1997-03-19';"
        },
        {
            "sql_id": "app_q4_8",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '49.148.196.142' and visitdate between '2008-10-27' and '2008-10-28';"
        },
        {
            "sql_id": "app_q4_9",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '162.113.153.110' and visitdate between '1972-07-31' and '1972-08-01';"
        },
        {
            "sql_id": "app_q4_10",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '43.33.120.35' and visitdate between '1982-09-14' and '1982-09-15';"
        },
        {
            "sql_id": "app_q4_11",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '181.41.17.116' and visitdate between '1992-12-27' and '1992-12-28';"
        },
        {
            "sql_id": "app_q4_12",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '125.181.84.172' and visitdate between '2004-09-08' and '2004-09-09';"
        },
        {
            "sql_id": "app_q4_13",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '118.201.190.1' and visitdate between '1971-02-25' and '1971-02-26';"
        },
        {
            "sql_id": "app_q4_14",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '219.148.138.198' and visitdate between '1981-04-10' and '1981-04-11';"
        },
        {
            "sql_id": "app_q4_15",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '189.16.202.207' and visitdate between '1994-05-17' and '1994-05-18';"
        },
        {
            "sql_id": "app_q4_16",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '67.75.107.130' and visitdate between '2006-01-27' and '2006-01-28';"
        },
        {
            "sql_id": "app_q4_17",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '143.17.189.125' and visitdate between '1981-02-16' and '1981-02-17';"
        },
        {
            "sql_id": "app_q4_18",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '162.215.40.114' and visitdate between '1991-04-02' and '1991-04-03';"
        },
        {
            "sql_id": "app_q4_19",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '188.95.189.118' and visitdate between '2001-03-13' and '2001-03-14';"
        },
        {
            "sql_id": "app_q4_20",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '75.153.116.30' and visitdate between '1979-10-03' and '1979-10-04';"
        },
        {
            "sql_id": "app_q4_21",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '139.151.199.4' and visitdate between '1989-11-16' and '1989-11-17';"
        },
        {
            "sql_id": "app_q4_22",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '187.49.34.155' and visitdate between '2002-08-13' and '2002-08-14';"
        },
        {
            "sql_id": "app_q4_23",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '125.18.22.175' and visitdate between '1978-05-19' and '1978-05-20';"
        },
        {
            "sql_id": "app_q4_24",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '177.50.17.117' and visitdate between '1988-05-31' and '1988-06-01';"
        },
        {
            "sql_id": "app_q4_25",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '22.122.253.104' and visitdate between '1998-06-13' and '1998-06-14';"
        },
        {
            "sql_id": "app_q4_26",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '68.28.236.34' and visitdate between '2010-01-22' and '2010-01-23';"
        },
        {
            "sql_id": "app_q4_27",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '214.178.177.181' and visitdate between '1977-01-02' and '1977-01-03';"
        },
        {
            "sql_id": "app_q4_28",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '116.124.96.163' and visitdate between '1987-01-15' and '1987-01-16';"
        },
        {
            "sql_id": "app_q4_29",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '132.251.209.194' and visitdate between '1999-11-13' and '1999-11-14';"
        },
        {
            "sql_id": "app_q4_30",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '220.172.36.243' and visitdate between '2011-06-24' and '2011-06-25';"
        },
        {
            "sql_id": "app_q4_31",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '9.161.104.121' and visitdate between '1974-09-24' and '1974-09-25';"
        },
        {
            "sql_id": "app_q4_32",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '56.146.253.102' and visitdate between '1986-02-28' and '1986-03-01';"
        },
        {
            "sql_id": "app_q4_33",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '140.210.62.112' and visitdate between '1996-07-16' and '1996-07-17';"
        },
        {
            "sql_id": "app_q4_34",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '53.19.150.174' and visitdate between '2006-09-29' and '2006-09-30';"
        },
        {
            "sql_id": "app_q4_35",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '186.188.120.137' and visitdate between '1973-04-20' and '1973-04-21';"
        },
        {
            "sql_id": "app_q4_36",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '166.24.209.25' and visitdate between '1984-09-24' and '1984-09-25';"
        },
        {
            "sql_id": "app_q4_37",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '192.224.22.66' and visitdate between '1997-12-04' and '1997-12-05';"
        },
        {
            "sql_id": "app_q4_38",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '94.128.73.52' and visitdate between '2008-02-17' and '2008-02-18';"
        },
        {
            "sql_id": "app_q4_39",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '77.216.35.24' and visitdate between '1971-11-15' and '1971-11-16';"
        },
        {
            "sql_id": "app_q4_40",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '112.229.12.95' and visitdate between '1983-05-23' and '1983-05-24';"
        },
        {
            "sql_id": "app_q4_41",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '67.60.51.153' and visitdate between '1993-09-06' and '1993-09-07';"
        },
        {
            "sql_id": "app_q4_42",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '91.64.22.173' and visitdate between '2003-12-22' and '2003-12-23';"
        },
        {
            "sql_id": "app_q4_43",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '187.203.101.71' and visitdate between '1970-06-11' and '1970-06-12';"
        },
        {
            "sql_id": "app_q4_44",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '156.249.108.142' and visitdate between '1981-12-17' and '1981-12-18';"
        },
        {
            "sql_id": "app_q4_45",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '25.82.16.206' and visitdate between '1995-01-25' and '1995-01-26';"
        },
        {
            "sql_id": "app_q4_46",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '21.139.14.11' and visitdate between '2005-05-11' and '2005-05-12';"
        },
        {
            "sql_id": "app_q4_47",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '66.95.81.11' and visitdate between '1980-06-10' and '1980-06-11';"
        },
        {
            "sql_id": "app_q4_48",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '75.44.29.251' and visitdate between '1991-12-17' and '1991-12-18';"
        },
        {
            "sql_id": "app_q4_49",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '50.235.232.128' and visitdate between '2001-11-29' and '2001-11-30';"
        },
        {
            "sql_id": "app_q4_50",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '197.247.244.32' and visitdate between '2012-03-15' and '2012-03-16';"
        },
        {
            "sql_id": "app_q4_51",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '88.180.78.132' and visitdate between '1979-01-25' and '1979-01-26';"
        },
        {
            "sql_id": "app_q4_52",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '70.103.46.103' and visitdate between '1990-08-02' and '1990-08-03';"
        },
        {
            "sql_id": "app_q4_53",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '124.11.198.24' and visitdate between '2003-05-01' and '2003-05-02';"
        },
        {
            "sql_id": "app_q4_54",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '69.133.45.184' and visitdate between '1977-09-02' and '1977-09-03';"
        },
        {
            "sql_id": "app_q4_55",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '128.99.100.7' and visitdate between '1989-02-06' and '1989-02-07';"
        },
        {
            "sql_id": "app_q4_56",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '210.21.186.48' and visitdate between '1999-02-21' and '1999-02-22';"
        },
        {
            "sql_id": "app_q4_57",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '116.28.240.77' and visitdate between '2009-05-06' and '2009-05-07';"
        },
        {
            "sql_id": "app_q4_58",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '228.106.82.154' and visitdate between '1976-04-18' and '1976-04-19';"
        },
        {
            "sql_id": "app_q4_59",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '226.106.252.42' and visitdate between '1987-09-23' and '1987-09-24';"
        },
        {
            "sql_id": "app_q4_60",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '179.48.250.107' and visitdate between '2000-07-23' and '2000-07-24';"
        },
        {
            "sql_id": "app_q4_61",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '185.141.237.165' and visitdate between '2010-10-06' and '2010-10-07';"
        },
        {
            "sql_id": "app_q4_62",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '111.34.96.26' and visitdate between '1972-06-18' and '1972-06-19';"
        },
        {
            "sql_id": "app_q4_63",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '45.91.154.165' and visitdate between '1982-10-03' and '1982-10-04';"
        },
        {
            "sql_id": "app_q4_64",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '206.68.128.228' and visitdate between '1993-01-17' and '1993-01-18';"
        },
        {
            "sql_id": "app_q4_65",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '137.27.104.109' and visitdate between '2004-07-25' and '2004-07-26';"
        },
        {
            "sql_id": "app_q4_66",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '180.226.190.67' and visitdate between '1971-01-29' and '1971-01-30';"
        },
        {
            "sql_id": "app_q4_67",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '174.158.112.233' and visitdate between '1981-05-15' and '1981-05-16';"
        },
        {
            "sql_id": "app_q4_68",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '26.5.211.248' and visitdate between '1994-06-23' and '1994-06-24';"
        },
        {
            "sql_id": "app_q4_69",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '238.140.28.114' and visitdate between '2005-12-29' and '2005-12-30';"
        },
        {
            "sql_id": "app_q4_70",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '177.41.84.244' and visitdate between '1975-04-28' and '1975-04-29';"
        },
        {
            "sql_id": "app_q4_71",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '228.138.92.211' and visitdate between '1985-07-11' and '1985-07-12';"
        },
        {
            "sql_id": "app_q4_72",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '254.252.76.233' and visitdate between '1995-11-27' and '1995-11-28';"
        },
        {
            "sql_id": "app_q4_73",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '32.219.213.211' and visitdate between '2007-05-03' and '2007-05-04';"
        },
        {
            "sql_id": "app_q4_74",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '38.100.248.55' and visitdate between '1973-12-08' and '1973-12-09';"
        },
        {
            "sql_id": "app_q4_75",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '16.176.61.247' and visitdate between '1984-02-21' and '1984-02-22';"
        },
        {
            "sql_id": "app_q4_76",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '6.249.6.74' and visitdate between '1997-05-02' and '1997-05-03';"
        },
        {
            "sql_id": "app_q4_77",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '169.120.229.63' and visitdate between '2008-10-06' and '2008-10-07';"
        },
        {
            "sql_id": "app_q4_78",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '253.61.216.143' and visitdate between '1978-04-22' and '1978-04-23';"
        },
        {
            "sql_id": "app_q4_79",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '8.166.134.76' and visitdate between '1988-07-05' and '1988-07-06';"
        },
        {
            "sql_id": "app_q4_80",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '197.108.137.29' and visitdate between '1998-07-20' and '1998-07-21';"
        },
        {
            "sql_id": "app_q5_1",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1976-07-15' and '1976-07-16') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_2",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1987-06-11' and '1987-06-12') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_3",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1999-07-29' and '1999-07-30') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_4",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '2011-09-15' and '2011-09-16') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_5",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1977-12-15' and '1977-12-16') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_6",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1988-11-10' and '1988-11-11') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_7",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '2010-05-01' and '2010-05-02') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_8",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1998-03-14' and '1998-03-15') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_9",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1979-04-23' and '1979-04-24') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_10",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1990-04-20' and '1990-04-21') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_11",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '2002-05-06' and '2002-05-07') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_12",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1980-09-22' and '1980-09-23') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_13",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1991-09-20' and '1991-09-21') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_14",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '2000-12-20' and '2000-12-21') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_15",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1970-09-23' and '1970-09-24') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_16",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1981-09-20' and '1981-09-21') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_17",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1994-02-15' and '1994-02-16') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_18",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '2006-05-06' and '2006-05-07') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_19",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1972-02-11' and '1972-02-12') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_20",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1983-02-08' and '1983-02-09') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_21",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1992-09-11' and '1992-09-12') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_22",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '2004-11-30' and '2004-12-01') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_23",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1973-08-02' and '1973-08-03') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_24",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1984-06-28' and '1984-06-29') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_25",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1996-12-25' and '1996-12-26') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_26",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '2009-02-11' and '2009-02-12') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_27",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1974-12-21' and '1974-12-22') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_28",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1985-11-16' and '1985-11-17') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_29",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '2007-09-08' and '2007-09-09') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_30",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1995-07-22' and '1995-07-23') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_31",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1975-11-05' and '1975-11-06') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_32",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1988-02-27' and '1988-02-28') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_33",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '2000-04-13' and '2000-04-14') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_34",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '2011-01-07' and '2011-01-08') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_35",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1977-04-06' and '1977-04-07') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_36",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1989-07-29' and '1989-07-30') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_37",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1998-11-28' and '1998-11-29') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_38",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '2009-08-23' and '2009-08-24') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_39",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1978-08-05' and '1978-08-06') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_40",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1990-12-29' and '1990-12-30') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_41",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '2003-01-12' and '2003-01-13') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_42",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1980-01-05' and '1980-01-06') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_43",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1992-05-30' and '1992-05-31') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_44",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '2001-08-28' and '2001-08-29') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_45",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1970-01-13' and '1970-01-14') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_46",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1982-06-08' and '1982-06-09') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_47",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1994-11-01' and '1994-11-02') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_48",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '2005-08-28' and '2005-08-29') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_49",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1971-06-03' and '1971-06-04') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_50",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1983-10-27' and '1983-10-28') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_51",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1993-05-28' and '1993-05-29') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_52",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '2004-03-24' and '2004-03-25') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_53",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1972-11-14' and '1972-11-15') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_54",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1985-03-08' and '1985-03-09') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_55",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1997-09-02' and '1997-09-03') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_56",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '2008-05-28' and '2008-05-29') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_57",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1974-04-04' and '1974-04-05') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_58",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1986-07-27' and '1986-07-28') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_59",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1996-03-29' and '1996-03-30') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_60",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '2006-12-23' and '2006-12-24') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_61",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1972-05-24' and '1972-05-25') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_62",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1983-03-21' and '1983-03-22') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_63",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1992-06-14' and '1992-06-15') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_64",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '2004-11-07' and '2004-11-08') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_65",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1970-12-19' and '1970-12-20') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_66",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1981-10-15' and '1981-10-16') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_67",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1993-11-02' and '1993-11-03') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_68",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '2006-03-28' and '2006-03-29') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_69",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1975-04-03' and '1975-04-04') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_70",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1985-12-27' and '1985-12-28') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_71",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1995-04-24' and '1995-04-25') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_72",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '2007-08-16' and '2007-08-17') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_73",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1973-10-28' and '1973-10-29') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_74",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1984-07-23' and '1984-07-24') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_75",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1996-09-11' and '1996-09-12') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_76",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '2009-01-03' and '2009-01-04') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_77",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1977-11-04' and '1977-11-05') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_78",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1988-07-30' and '1988-07-31') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_79",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1998-04-06' and '1998-04-07') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_80",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '2010-07-29' and '2010-07-30') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q6_1",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '139.2.152.157' and visitdate = '1976-05-12';"
        },
        {
            "sql_id": "app_q6_2",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '141.141.113.5' and visitdate = '1987-04-08';"
        },
        {
            "sql_id": "app_q6_3",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '208.37.118.146' and visitdate = '1999-10-01';"
        },
        {
            "sql_id": "app_q6_4",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '123.11.239.238' and visitdate = '2011-11-18';"
        },
        {
            "sql_id": "app_q6_5",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '195.235.34.199' and visitdate = '1977-10-12';"
        },
        {
            "sql_id": "app_q6_6",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '61.157.108.123' and visitdate = '1988-09-07';"
        },
        {
            "sql_id": "app_q6_7",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '222.95.117.12' and visitdate = '1998-05-17';"
        },
        {
            "sql_id": "app_q6_8",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '246.243.62.249' and visitdate = '2010-07-04';"
        },
        {
            "sql_id": "app_q6_9",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '107.204.196.21' and visitdate = '1979-02-18';"
        },
        {
            "sql_id": "app_q6_10",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '131.198.205.154' and visitdate = '1990-02-15';"
        },
        {
            "sql_id": "app_q6_11",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '171.21.43.240' and visitdate = '2002-07-09';"
        },
        {
            "sql_id": "app_q6_12",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '102.237.79.81' and visitdate = '1980-07-20';"
        },
        {
            "sql_id": "app_q6_13",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '209.13.91.119' and visitdate = '1991-07-18';"
        },
        {
            "sql_id": "app_q6_14",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '83.220.9.119' and visitdate = '2001-02-22';"
        },
        {
            "sql_id": "app_q6_15",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '67.239.148.99' and visitdate = '1970-11-26';"
        },
        {
            "sql_id": "app_q6_16",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '225.225.119.4' and visitdate = '1981-11-23';"
        },
        {
            "sql_id": "app_q6_17",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '199.100.162.20' and visitdate = '1993-12-13';"
        },
        {
            "sql_id": "app_q6_18",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '239.209.22.87' and visitdate = '2006-03-03';"
        },
        {
            "sql_id": "app_q6_19",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '176.42.73.168' and visitdate = '1972-04-15';"
        },
        {
            "sql_id": "app_q6_20",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '8.33.230.227' and visitdate = '1983-04-13';"
        },
        {
            "sql_id": "app_q6_21",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '230.202.187.69' and visitdate = '1992-07-09';"
        },
        {
            "sql_id": "app_q6_22",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '234.70.180.235' and visitdate = '2004-09-27';"
        },
        {
            "sql_id": "app_q6_23",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '207.143.148.2' and visitdate = '1973-10-05';"
        },
        {
            "sql_id": "app_q6_24",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '57.221.89.158' and visitdate = '1984-08-31';"
        },
        {
            "sql_id": "app_q6_25",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '196.66.44.193' and visitdate = '1996-10-22';"
        },
        {
            "sql_id": "app_q6_26",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '163.17.219.221' and visitdate = '2008-12-09';"
        },
        {
            "sql_id": "app_q6_27",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '93.54.213.136' and visitdate = '1975-02-23';"
        },
        {
            "sql_id": "app_q6_28",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '67.224.97.75' and visitdate = '1986-01-19';"
        },
        {
            "sql_id": "app_q6_29",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '71.60.134.72' and visitdate = '1995-05-19';"
        },
        {
            "sql_id": "app_q6_30",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '135.248.122.9' and visitdate = '2007-07-06';"
        },
        {
            "sql_id": "app_q6_31",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '180.133.121.31' and visitdate = '1975-09-02';"
        },
        {
            "sql_id": "app_q6_32",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '44.162.20.111' and visitdate = '1987-12-25';"
        },
        {
            "sql_id": "app_q6_33",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '109.185.130.187' and visitdate = '2000-06-16';"
        },
        {
            "sql_id": "app_q6_34",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '76.94.155.156' and visitdate = '2011-03-12';"
        },
        {
            "sql_id": "app_q6_35",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '248.200.250.117' and visitdate = '1977-02-01';"
        },
        {
            "sql_id": "app_q6_36",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '208.26.223.68' and visitdate = '1989-05-26';"
        },
        {
            "sql_id": "app_q6_37",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '126.90.32.87' and visitdate = '1999-01-31';"
        },
        {
            "sql_id": "app_q6_38",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '79.1.250.13' and visitdate = '2009-10-26';"
        },
        {
            "sql_id": "app_q6_39",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '248.200.104.148' and visitdate = '1978-06-02';"
        },
        {
            "sql_id": "app_q6_40",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '94.9.4.234' and visitdate = '1990-10-26';"
        },
        {
            "sql_id": "app_q6_41",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '211.73.91.101' and visitdate = '2003-03-17';"
        },
        {
            "sql_id": "app_q6_42",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '47.60.98.253' and visitdate = '1979-11-02';"
        },
        {
            "sql_id": "app_q6_43",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '180.34.90.27' and visitdate = '1992-03-27';"
        },
        {
            "sql_id": "app_q6_44",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '213.207.151.106' and visitdate = '2001-10-31';"
        },
        {
            "sql_id": "app_q6_45",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '189.185.155.237' and visitdate = '1970-03-18';"
        },
        {
            "sql_id": "app_q6_46",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '171.131.129.206' and visitdate = '1982-08-11';"
        },
        {
            "sql_id": "app_q6_47",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '177.58.78.104' and visitdate = '1994-08-29';"
        },
        {
            "sql_id": "app_q6_48",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '134.23.237.75' and visitdate = '2005-06-25';"
        },
        {
            "sql_id": "app_q6_49",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '29.81.70.173' and visitdate = '1971-08-06';"
        },
        {
            "sql_id": "app_q6_50",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '243.200.225.112' and visitdate = '1983-12-30';"
        },
        {
            "sql_id": "app_q6_51",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '132.153.149.216' and visitdate = '1993-03-25';"
        },
        {
            "sql_id": "app_q6_52",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '55.9.87.249' and visitdate = '2004-01-20';"
        },
        {
            "sql_id": "app_q6_53",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '111.114.32.121' and visitdate = '1973-01-17';"
        },
        {
            "sql_id": "app_q6_54",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '107.230.135.160' and visitdate = '1985-05-11';"
        },
        {
            "sql_id": "app_q6_55",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '174.33.156.174' and visitdate = '1997-06-30';"
        },
        {
            "sql_id": "app_q6_56",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '15.73.236.207' and visitdate = '2008-03-25';"
        },
        {
            "sql_id": "app_q6_57",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '212.7.168.90' and visitdate = '1974-06-07';"
        },
        {
            "sql_id": "app_q6_58",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '98.137.116.225' and visitdate = '1986-09-29';"
        },
        {
            "sql_id": "app_q6_59",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '68.227.184.168' and visitdate = '1996-01-25';"
        },
        {
            "sql_id": "app_q6_60",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '70.199.173.189' and visitdate = '2006-10-20';"
        },
        {
            "sql_id": "app_q6_61",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '89.68.179.22' and visitdate = '1978-07-04';"
        },
        {
            "sql_id": "app_q6_62",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '49.220.203.23' and visitdate = '1990-09-24';"
        },
        {
            "sql_id": "app_q6_63",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '111.40.254.197' and visitdate = '2003-02-13';"
        },
        {
            "sql_id": "app_q6_64",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '47.97.148.19' and visitdate = '1979-12-04';"
        },
        {
            "sql_id": "app_q6_65",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '193.231.96.158' and visitdate = '1992-02-24';"
        },
        {
            "sql_id": "app_q6_66",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '122.182.94.83' and visitdate = '2001-09-29';"
        },
        {
            "sql_id": "app_q6_67",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '163.56.13.170' and visitdate = '1975-10-04';"
        },
        {
            "sql_id": "app_q6_68",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '51.126.52.65' and visitdate = '1987-11-23';"
        },
        {
            "sql_id": "app_q6_69",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '1.32.147.171' and visitdate = '2000-05-15';"
        },
        {
            "sql_id": "app_q6_70",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '251.144.20.2' and visitdate = '2011-04-13';"
        },
        {
            "sql_id": "app_q6_71",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '193.11.25.4' and visitdate = '1977-03-05';"
        },
        {
            "sql_id": "app_q6_72",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '13.154.20.213' and visitdate = '1989-04-24';"
        },
        {
            "sql_id": "app_q6_73",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '145.167.106.239' and visitdate = '1998-12-30';"
        },
        {
            "sql_id": "app_q6_74",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '178.108.74.232' and visitdate = '2009-11-27';"
        },
        {
            "sql_id": "app_q6_75",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '220.8.23.249' and visitdate = '1973-02-18';"
        },
        {
            "sql_id": "app_q6_76",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '120.29.220.65' and visitdate = '1985-04-09';"
        },
        {
            "sql_id": "app_q6_77",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '13.27.219.131' and visitdate = '1997-05-29';"
        },
        {
            "sql_id": "app_q6_78",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '208.42.63.195' and visitdate = '2008-04-26';"
        },
        {
            "sql_id": "app_q6_79",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '182.220.80.178' and visitdate = '1974-07-09';"
        },
        {
            "sql_id": "app_q6_80",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '175.57.221.84' and visitdate = '1986-08-28';"
        },
        {
            "sql_id": "app_q7_1",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1972-03-21' AND visitdate <= DATE_ADD('DAY', 1, '1972-03-21'));"
        },
        {
            "sql_id": "app_q7_2",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1983-01-16' AND visitdate <= DATE_ADD('DAY', 1, '1983-01-16'));"
        },
        {
            "sql_id": "app_q7_3",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1992-08-17' AND visitdate <= DATE_ADD('DAY', 1, '1992-08-17'));"
        },
        {
            "sql_id": "app_q7_4",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '2005-01-10' AND visitdate <= DATE_ADD('DAY', 1, '2005-01-10'));"
        },
        {
            "sql_id": "app_q7_5",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1970-10-16' AND visitdate <= DATE_ADD('DAY', 1, '1970-10-16'));"
        },
        {
            "sql_id": "app_q7_6",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1981-08-12' AND visitdate <= DATE_ADD('DAY', 1, '1981-08-12'));"
        },
        {
            "sql_id": "app_q7_7",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '2006-05-31' AND visitdate <= DATE_ADD('DAY', 1, '2006-05-31'));"
        },
        {
            "sql_id": "app_q7_8",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1994-01-05' AND visitdate <= DATE_ADD('DAY', 1, '1994-01-05'));"
        },
        {
            "sql_id": "app_q7_9",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1975-01-29' AND visitdate <= DATE_ADD('DAY', 1, '1975-01-29'));"
        },
        {
            "sql_id": "app_q7_10",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '2007-10-19' AND visitdate <= DATE_ADD('DAY', 1, '2007-10-19'));"
        },
        {
            "sql_id": "app_q7_11",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1985-10-24' AND visitdate <= DATE_ADD('DAY', 1, '1985-10-24'));"
        },
        {
            "sql_id": "app_q7_12",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1995-06-27' AND visitdate <= DATE_ADD('DAY', 1, '1995-06-27'));"
        },
        {
            "sql_id": "app_q7_13",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1973-08-25' AND visitdate <= DATE_ADD('DAY', 1, '1973-08-25'));"
        },
        {
            "sql_id": "app_q7_14",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '2009-03-08' AND visitdate <= DATE_ADD('DAY', 1, '2009-03-08'));"
        },
        {
            "sql_id": "app_q7_15",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1984-05-20' AND visitdate <= DATE_ADD('DAY', 1, '1984-05-20'));"
        },
        {
            "sql_id": "app_q7_16",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1996-11-14' AND visitdate <= DATE_ADD('DAY', 1, '1996-11-14'));"
        },
        {
            "sql_id": "app_q7_17",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1978-01-07' AND visitdate <= DATE_ADD('DAY', 1, '1978-01-07'));"
        },
        {
            "sql_id": "app_q7_18",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '2010-05-26' AND visitdate <= DATE_ADD('DAY', 1, '2010-05-26'));"
        },
        {
            "sql_id": "app_q7_19",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1988-10-02' AND visitdate <= DATE_ADD('DAY', 1, '1988-10-02'));"
        },
        {
            "sql_id": "app_q7_20",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1998-02-01' AND visitdate <= DATE_ADD('DAY', 1, '1998-02-01'));"
        },
        {
            "sql_id": "app_q7_21",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1976-08-23' AND visitdate <= DATE_ADD('DAY', 1, '1976-08-23'));"
        },
        {
            "sql_id": "app_q7_22",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '2011-10-26' AND visitdate <= DATE_ADD('DAY', 1, '2011-10-26'));"
        },
        {
            "sql_id": "app_q7_23",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1987-05-19' AND visitdate <= DATE_ADD('DAY', 1, '1987-05-19'));"
        },
        {
            "sql_id": "app_q7_24",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1999-07-04' AND visitdate <= DATE_ADD('DAY', 1, '1999-07-04'));"
        },
        {
            "sql_id": "app_q7_25",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1980-10-15' AND visitdate <= DATE_ADD('DAY', 1, '1980-10-15'));"
        },
        {
            "sql_id": "app_q7_26",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1991-08-12' AND visitdate <= DATE_ADD('DAY', 1, '1991-08-12'));"
        },
        {
            "sql_id": "app_q7_27",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '2000-11-09' AND visitdate <= DATE_ADD('DAY', 1, '2000-11-09'));"
        },
        {
            "sql_id": "app_q7_28",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1979-06-01' AND visitdate <= DATE_ADD('DAY', 1, '1979-06-01'));"
        },
        {
            "sql_id": "app_q7_29",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1990-03-28' AND visitdate <= DATE_ADD('DAY', 1, '1990-03-28'));"
        },
        {
            "sql_id": "app_q7_30",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '2002-04-11' AND visitdate <= DATE_ADD('DAY', 1, '2002-04-11'));"
        },
        {
            "sql_id": "app_q7_31",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1971-07-14' AND visitdate <= DATE_ADD('DAY', 1, '1971-07-14'));"
        },
        {
            "sql_id": "app_q7_32",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1983-10-02' AND visitdate <= DATE_ADD('DAY', 1, '1983-10-02'));"
        },
        {
            "sql_id": "app_q7_33",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1993-05-05' AND visitdate <= DATE_ADD('DAY', 1, '1993-05-05'));"
        },
        {
            "sql_id": "app_q7_34",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '2004-05-02' AND visitdate <= DATE_ADD('DAY', 1, '2004-05-02'));"
        },
        {
            "sql_id": "app_q7_35",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1970-02-07' AND visitdate <= DATE_ADD('DAY', 1, '1970-02-07'));"
        },
        {
            "sql_id": "app_q7_36",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1982-04-28' AND visitdate <= DATE_ADD('DAY', 1, '1982-04-28'));"
        },
        {
            "sql_id": "app_q7_37",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1994-09-23' AND visitdate <= DATE_ADD('DAY', 1, '1994-09-23'));"
        },
        {
            "sql_id": "app_q7_38",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '2005-09-20' AND visitdate <= DATE_ADD('DAY', 1, '2005-09-20'));"
        },
        {
            "sql_id": "app_q7_39",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1974-05-15' AND visitdate <= DATE_ADD('DAY', 1, '1974-05-15'));"
        },
        {
            "sql_id": "app_q7_40",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '2007-01-31' AND visitdate <= DATE_ADD('DAY', 1, '2007-01-31'));"
        },
        {
            "sql_id": "app_q7_41",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1986-07-02' AND visitdate <= DATE_ADD('DAY', 1, '1986-07-02'));"
        },
        {
            "sql_id": "app_q7_42",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1996-03-06' AND visitdate <= DATE_ADD('DAY', 1, '1996-03-06'));"
        },
        {
            "sql_id": "app_q7_43",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1972-12-09' AND visitdate <= DATE_ADD('DAY', 1, '1972-12-09'));"
        },
        {
            "sql_id": "app_q7_44",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1997-07-25' AND visitdate <= DATE_ADD('DAY', 1, '1997-07-25'));"
        },
        {
            "sql_id": "app_q7_45",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '2008-06-20' AND visitdate <= DATE_ADD('DAY', 1, '2008-06-20'));"
        },
        {
            "sql_id": "app_q7_46",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1985-01-26' AND visitdate <= DATE_ADD('DAY', 1, '1985-01-26'));"
        },
        {
            "sql_id": "app_q7_47",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1977-05-01' AND visitdate <= DATE_ADD('DAY', 1, '1977-05-01'));"
        },
        {
            "sql_id": "app_q7_48",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '2009-09-15' AND visitdate <= DATE_ADD('DAY', 1, '2009-09-15'));"
        },
        {
            "sql_id": "app_q7_49",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1998-10-20' AND visitdate <= DATE_ADD('DAY', 1, '1998-10-20'));"
        },
        {
            "sql_id": "app_q7_50",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1989-06-18' AND visitdate <= DATE_ADD('DAY', 1, '1989-06-18'));"
        },
        {
            "sql_id": "app_q7_51",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1975-12-16' AND visitdate <= DATE_ADD('DAY', 1, '1975-12-16'));"
        },
        {
            "sql_id": "app_q7_52",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '2011-02-15' AND visitdate <= DATE_ADD('DAY', 1, '2011-02-15'));"
        },
        {
            "sql_id": "app_q7_53",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '2000-03-21' AND visitdate <= DATE_ADD('DAY', 1, '2000-03-21'));"
        },
        {
            "sql_id": "app_q7_54",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1988-02-02' AND visitdate <= DATE_ADD('DAY', 1, '1988-02-02'));"
        },
        {
            "sql_id": "app_q7_55",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1980-01-30' AND visitdate <= DATE_ADD('DAY', 1, '1980-01-30'));"
        },
        {
            "sql_id": "app_q7_56",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1992-04-19' AND visitdate <= DATE_ADD('DAY', 1, '1992-04-19'));"
        },
        {
            "sql_id": "app_q7_57",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '2001-07-20' AND visitdate <= DATE_ADD('DAY', 1, '2001-07-20'));"
        },
        {
            "sql_id": "app_q7_58",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1978-09-15' AND visitdate <= DATE_ADD('DAY', 1, '1978-09-15'));"
        },
        {
            "sql_id": "app_q7_59",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1990-12-04' AND visitdate <= DATE_ADD('DAY', 1, '1990-12-04'));"
        },
        {
            "sql_id": "app_q7_60",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '2002-12-20' AND visitdate <= DATE_ADD('DAY', 1, '2002-12-20'));"
        },
        {
            "sql_id": "app_q7_61",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1978-07-04' AND visitdate <= DATE_ADD('DAY', 1, '1978-07-04'));"
        },
        {
            "sql_id": "app_q7_62",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1990-09-24' AND visitdate <= DATE_ADD('DAY', 1, '1990-09-24'));"
        },
        {
            "sql_id": "app_q7_63",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '2003-02-13' AND visitdate <= DATE_ADD('DAY', 1, '2003-02-13'));"
        },
        {
            "sql_id": "app_q7_64",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1979-12-04' AND visitdate <= DATE_ADD('DAY', 1, '1979-12-04'));"
        },
        {
            "sql_id": "app_q7_65",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1992-02-24' AND visitdate <= DATE_ADD('DAY', 1, '1992-02-24'));"
        },
        {
            "sql_id": "app_q7_66",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '2001-09-29' AND visitdate <= DATE_ADD('DAY', 1, '2001-09-29'));"
        },
        {
            "sql_id": "app_q7_67",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1975-10-04' AND visitdate <= DATE_ADD('DAY', 1, '1975-10-04'));"
        },
        {
            "sql_id": "app_q7_68",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '2011-04-13' AND visitdate <= DATE_ADD('DAY', 1, '2011-04-13'));"
        },
        {
            "sql_id": "app_q7_69",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1987-11-23' AND visitdate <= DATE_ADD('DAY', 1, '1987-11-23'));"
        },
        {
            "sql_id": "app_q7_70",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '2000-05-15' AND visitdate <= DATE_ADD('DAY', 1, '2000-05-15'));"
        },
        {
            "sql_id": "app_q7_71",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1977-03-05' AND visitdate <= DATE_ADD('DAY', 1, '1977-03-05'));"
        },
        {
            "sql_id": "app_q7_72",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '2009-11-27' AND visitdate <= DATE_ADD('DAY', 1, '2009-11-27'));"
        },
        {
            "sql_id": "app_q7_73",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1998-12-30' AND visitdate <= DATE_ADD('DAY', 1, '1998-12-30'));"
        },
        {
            "sql_id": "app_q7_74",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1989-04-24' AND visitdate <= DATE_ADD('DAY', 1, '1989-04-24'));"
        },
        {
            "sql_id": "app_q7_75",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1973-02-18' AND visitdate <= DATE_ADD('DAY', 1, '1973-02-18'));"
        },
        {
            "sql_id": "app_q7_76",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1997-05-29' AND visitdate <= DATE_ADD('DAY', 1, '1997-05-29'));"
        },
        {
            "sql_id": "app_q7_77",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '2008-04-26' AND visitdate <= DATE_ADD('DAY', 1, '2008-04-26'));"
        },
        {
            "sql_id": "app_q7_78",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1985-04-09' AND visitdate <= DATE_ADD('DAY', 1, '1985-04-09'));"
        },
        {
            "sql_id": "app_q7_79",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1974-07-09' AND visitdate <= DATE_ADD('DAY', 1, '1974-07-09'));"
        },
        {
            "sql_id": "app_q7_80",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '2006-11-21' AND visitdate <= DATE_ADD('DAY', 1, '2006-11-21'));"
        },
        {
            "sql_id": "app_q8_1",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1974-02-24' AND visitdate <= DATE_ADD('DAY', 1, '1974-02-24'))\n        AND languagecode IN ('FIN-FI','MLT-MT','CUB-ES','BLR-BE','GRC-EL','HUN-HU','MEX-ES','ISL-IS')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_2",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1984-04-07' AND visitdate <= DATE_ADD('DAY', 1, '1984-04-07'))\n        AND languagecode IN ('IRL-EN','SVK-SK','VEN-ES','CRI-ES','MNE-SR','FIN-FI','MAR-AR','MAR-AR')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_3",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1997-01-04' AND visitdate <= DATE_ADD('DAY', 1, '1997-01-04'))\n        AND languagecode IN ('MNE-SR','SLV-ES','THA-TH','MLT-MT','LTU-LT','NOR-NO','IRL-EN','SLV-ES')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_4",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '2008-09-14' AND visitdate <= DATE_ADD('DAY', 1, '2008-09-14'))\n        AND languagecode IN ('NZL-EN','THA-TH','BOL-ES','GTM-ES','LTU-LT','NLD-NL','COL-ES','MLT-MT')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_5",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1975-07-11' AND visitdate <= DATE_ADD('DAY', 1, '1975-07-11'))\n        AND languagecode IN ('BHR-AR','PRI-ES','BEL-NL','CHE-IT','JOR-AR','LTU-LT','MNE-SR','ARE-AR')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_6",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1985-08-22' AND visitdate <= DATE_ADD('DAY', 1, '1985-08-22'))\n        AND languagecode IN ('CHN-ZH','PRY-ES','TUR-TR','ALB-SQ','PER-ES','MNE-SR','JOR-AR','SLV-ES')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_7",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1995-08-05' AND visitdate <= DATE_ADD('DAY', 1, '1995-08-05'))\n        AND languagecode IN ('CYP-EL','ISR-IW','RUS-RU','MAR-AR','GRC-EL','PRY-ES','CUB-ES','ALB-SQ')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_8",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '2007-04-15' AND visitdate <= DATE_ADD('DAY', 1, '2007-04-15'))\n        AND languagecode IN ('ISL-IS','SGP-EN','ISR-IW','CUB-ES','COL-ES','FIN-FI','BEL-NL','MLT-EN')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_9",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1971-05-27' AND visitdate <= DATE_ADD('DAY', 1, '1971-05-27'))\n        AND languagecode IN ('PAN-ES','MYS-MS','ROU-RO','FIN-FI','BOL-ES','ALB-SQ','EGY-AR','LTU-LT')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_10",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1981-06-06' AND visitdate <= DATE_ADD('DAY', 1, '1981-06-06'))\n        AND languagecode IN ('BEL-NL','RUS-RU','SGP-ZH','VEN-ES','MLT-MT','LBN-AR','MAR-AR','TUR-TR')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_11",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1994-04-06' AND visitdate <= DATE_ADD('DAY', 1, '1994-04-06'))\n        AND languagecode IN ('CHN-ZH','BLR-BE','USA-ES','JOR-AR','BLR-BE','CUB-ES','GRC-EL','PRI-ES')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_12",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '2005-11-13' AND visitdate <= DATE_ADD('DAY', 1, '2005-11-13'))\n        AND languagecode IN ('HRV-HR','CHL-ES','CHN-ZH','SYR-AR','MKD-MK','GRC-DE','MEX-ES','NOR-NO')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_13",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1972-10-10' AND visitdate <= DATE_ADD('DAY', 1, '1972-10-10'))\n        AND languagecode IN ('NZL-EN','PRY-ES','LTU-LT','ITA-IT','LTU-LT','ZAF-EN','IND-EN','DZA-AR')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_14",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1982-10-21' AND visitdate <= DATE_ADD('DAY', 1, '1982-10-21'))\n        AND languagecode IN ('IND-EN','PER-ES','ALB-SQ','MNE-SR','THA-TH','MAR-AR','GRC-EL','ISL-IS')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_15",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '2004-06-13' AND visitdate <= DATE_ADD('DAY', 1, '2004-06-13'))\n        AND languagecode IN ('VEN-ES','CHN-ZH','CHL-ES','EGY-AR','CHN-ZH','NLD-NL','PER-ES','CYP-EL')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_16",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1992-11-04' AND visitdate <= DATE_ADD('DAY', 1, '1992-11-04'))\n        AND languagecode IN ('IRL-EN','MYS-MS','IRL-EN','CYP-EL','RUS-RU','HUN-HU','CHL-ES','ITA-IT')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_17",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1979-08-07' AND visitdate <= DATE_ADD('DAY', 1, '1979-08-07'))\n        AND languagecode IN ('HUN-HU','NZL-EN','CHN-ZH','ARE-AR','ISL-IS','PAN-ES','ITA-IT','HRV-HR')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_18",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1989-08-17' AND visitdate <= DATE_ADD('DAY', 1, '1989-08-17'))\n        AND languagecode IN ('CHE-IT','DZA-AR','CRI-ES','USA-ES','MLT-MT','CYP-EL','NLD-NL','USA-ES')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_19",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '2002-10-27' AND visitdate <= DATE_ADD('DAY', 1, '2002-10-27'))\n        AND languagecode IN ('ITA-IT','BIH-SR','JOR-AR','ROU-RO','VNM-VI','MEX-ES','VNM-VI','CHN-ZH')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_20",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1981-01-10' AND visitdate <= DATE_ADD('DAY', 1, '1981-01-10'))\n        AND languagecode IN ('SGP-ZH','EGY-AR','GRC-EL','NOR-NO','ARE-AR','ARE-AR','THA-TH','VNM-VI')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_21",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1991-01-21' AND visitdate <= DATE_ADD('DAY', 1, '1991-01-21'))\n        AND languagecode IN ('AUS-EN','DZA-AR','MEX-ES','USA-ES','GRC-DE','ROU-RO','CHE-IT','THA-TH')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_22",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '2001-06-08' AND visitdate <= DATE_ADD('DAY', 1, '2001-06-08'))\n        AND languagecode IN ('VNM-VI','CHN-ZH','SGP-ZH','CHL-ES','BHR-AR','SLV-ES','THA-TH','SGP-EN')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_23",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1976-10-05' AND visitdate <= DATE_ADD('DAY', 1, '1976-10-05'))\n        AND languagecode IN ('HRV-HR','NZL-EN','BLR-BE','LBN-AR','CHE-IT','VNM-VI','BEL-NL','MEX-ES')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_24",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1986-11-17' AND visitdate <= DATE_ADD('DAY', 1, '1986-11-17'))\n        AND languagecode IN ('JOR-AR','MYS-MS','NOR-NO','SVK-SK','IDN-IN','BOL-ES','VEN-ES','ROU-RO')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_25",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1999-12-26' AND visitdate <= DATE_ADD('DAY', 1, '1999-12-26'))\n        AND languagecode IN ('FIN-FI','PRY-ES','SYR-AR','BHR-AR','CUB-ES','LBN-AR','SYR-AR','LBN-AR')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_26",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '2011-09-05' AND visitdate <= DATE_ADD('DAY', 1, '2011-09-05'))\n        AND languagecode IN ('HRV-HR','MYS-MS','SYR-AR','CYP-EL','ITA-IT','NZL-EN','BLR-BE','BHR-AR')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_27",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1978-03-11' AND visitdate <= DATE_ADD('DAY', 1, '1978-03-11'))\n        AND languagecode IN ('IRL-EN','BIH-SR','MAR-AR','CAN-FR','ISL-IS','VEN-ES','IND-EN','BHR-AR')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_28",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1988-04-22' AND visitdate <= DATE_ADD('DAY', 1, '1988-04-22'))\n        AND languagecode IN ('BIH-SR','IDN-IN','GRC-DE','BIH-SR','PRY-ES','NZL-EN','ARE-AR','GRC-DE')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_29",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1998-08-07' AND visitdate <= DATE_ADD('DAY', 1, '1998-08-07'))\n        AND languagecode IN ('CRI-ES','LBN-AR','FIN-FI','IND-EN','IND-EN','ISL-IS','RUS-RU','BLR-BE')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_30",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '2010-04-17' AND visitdate <= DATE_ADD('DAY', 1, '2010-04-17'))\n        AND languagecode IN ('BOL-ES','CAN-FR','HUN-HU','MLT-MT','MLT-EN','CHL-ES','HRV-HR','BIH-SR')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_31",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1973-06-16' AND visitdate <= DATE_ADD('DAY', 1, '1973-06-16'))\n        AND languagecode IN ('CHL-ES','VNM-VI','SGP-ZH','JOR-AR','ITA-IT','LBN-AR','GRC-EL','SGP-ZH')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_32",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1984-12-24' AND visitdate <= DATE_ADD('DAY', 1, '1984-12-24'))\n        AND languagecode IN ('BOL-ES','VNM-VI','GRC-EL','ALB-SQ','ARE-AR','HRV-HR','VEN-ES','CRI-ES')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_33",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1997-09-20' AND visitdate <= DATE_ADD('DAY', 1, '1997-09-20'))\n        AND languagecode IN ('SYR-AR','MLT-MT','HUN-HU','RUS-RU','PER-ES','PRY-ES','HRV-HR','ZAF-EN')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_34",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '2008-01-07' AND visitdate <= DATE_ADD('DAY', 1, '2008-01-07'))\n        AND languagecode IN ('BOL-ES','ISL-IS','CHE-IT','NOR-NO','MAR-AR','PAN-ES','BEL-NL','ISR-IW')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_35",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1974-10-31' AND visitdate <= DATE_ADD('DAY', 1, '1974-10-31'))\n        AND languagecode IN ('ARE-AR','PAN-ES','ROU-RO','UKR-UK','BIH-SR','BEL-NL','GRC-DE','UKR-UK')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_36",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1986-05-10' AND visitdate <= DATE_ADD('DAY', 1, '1986-05-10'))\n        AND languagecode IN ('VNM-VI','HUN-HU','GRC-EL','CYP-EL','PER-ES','VNM-VI','BIH-SR','PER-ES')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_37",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1996-04-20' AND visitdate <= DATE_ADD('DAY', 1, '1996-04-20'))\n        AND languagecode IN ('IRL-EN','VEN-ES','MYS-MS','CHN-ZH','LTU-LT','SGP-EN','BEL-NL','NZL-EN')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_38",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '2006-08-07' AND visitdate <= DATE_ADD('DAY', 1, '2006-08-07'))\n        AND languagecode IN ('CAN-FR','ISL-IS','SVK-SK','MNE-SR','SGP-ZH','MAR-AR','GTM-ES','PRY-ES')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_39",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1970-09-08' AND visitdate <= DATE_ADD('DAY', 1, '1970-09-08'))\n        AND languagecode IN ('CYP-EL','MLT-MT','SLV-ES','MYS-MS','BEL-NL','JOR-AR','CHL-ES','VNM-VI')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_40",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1982-02-14' AND visitdate <= DATE_ADD('DAY', 1, '1982-02-14'))\n        AND languagecode IN ('TUR-TR','ZAF-EN','MNE-SR','AUS-EN','JOR-AR','MLT-EN','LTU-LT','PRY-ES')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_41",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1994-12-13' AND visitdate <= DATE_ADD('DAY', 1, '1994-12-13'))\n        AND languagecode IN ('PAN-ES','IND-EN','CAN-FR','MLT-EN','MLT-MT','PRY-ES','GRC-EL','EGY-AR')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_42",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '2005-02-27' AND visitdate <= DATE_ADD('DAY', 1, '2005-02-27'))\n        AND languagecode IN ('NZL-EN','PRY-ES','MLT-MT','LTU-LT','IDN-IN','MLT-EN','THA-TH','SGP-EN')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_43",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1972-01-23' AND visitdate <= DATE_ADD('DAY', 1, '1972-01-23'))\n        AND languagecode IN ('ARE-AR','CHN-ZH','GRC-EL','DZA-AR','MYS-MS','RUS-RU','MNE-SR','NZL-EN')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_44",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1983-07-01' AND visitdate <= DATE_ADD('DAY', 1, '1983-07-01'))\n        AND languagecode IN ('VNM-VI','LTU-LT','LBN-AR','ALB-SQ','BIH-SR','MEX-ES','MYS-MS','ALB-SQ')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_45",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1993-07-13' AND visitdate <= DATE_ADD('DAY', 1, '1993-07-13'))\n        AND languagecode IN ('GTM-ES','GTM-ES','MLT-EN','ROU-RO','ISL-IS','BEL-NL','CUB-ES','MLT-EN')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_46",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '2003-09-28' AND visitdate <= DATE_ADD('DAY', 1, '2003-09-28'))\n        AND languagecode IN ('HRV-HR','GRC-DE','DZA-AR','HRV-HR','FIN-FI','ITA-IT','CRI-ES','FIN-FI')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_47",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1978-11-27' AND visitdate <= DATE_ADD('DAY', 1, '1978-11-27'))\n        AND languagecode IN ('EGY-AR','COL-ES','MEX-ES','CRI-ES','TUR-TR','ISL-IS','ALB-SQ','TUR-TR')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_48",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1990-05-05' AND visitdate <= DATE_ADD('DAY', 1, '1990-05-05'))\n        AND languagecode IN ('BLR-BE','CHN-ZH','LBN-AR','CHE-IT','MYS-MS','GRC-EL','MAR-AR','PER-ES')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_49",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '2003-07-13' AND visitdate <= DATE_ADD('DAY', 1, '2003-07-13'))\n        AND languagecode IN ('SGP-EN','BHR-AR','ITA-IT','MNE-SR','IDN-IN','CAN-FR','PER-ES','VNM-VI')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_50",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1980-05-02' AND visitdate <= DATE_ADD('DAY', 1, '1980-05-02'))\n        AND languagecode IN ('CYP-EL','CYP-EL','CHL-ES','MNE-SR','THA-TH','JOR-AR','DZA-AR','IRL-EN')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_51",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1991-10-09' AND visitdate <= DATE_ADD('DAY', 1, '1991-10-09'))\n        AND languagecode IN ('PAN-ES','PRY-ES','PER-ES','CYP-EL','ISR-IW','TUR-TR','LBN-AR','JOR-AR')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_52",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '2002-02-22' AND visitdate <= DATE_ADD('DAY', 1, '2002-02-22'))\n        AND languagecode IN ('ROU-RO','TUR-TR','VEN-ES','PRY-ES','MLT-MT','CRI-ES','CYP-EL','MNE-SR')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_53",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1976-01-18' AND visitdate <= DATE_ADD('DAY', 1, '1976-01-18'))\n        AND languagecode IN ('GRC-DE','FIN-FI','HUN-HU','ISL-IS','PAN-ES','HUN-HU','SGP-EN','MLT-MT')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_54",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1987-07-28' AND visitdate <= DATE_ADD('DAY', 1, '1987-07-28'))\n        AND languagecode IN ('CUB-ES','USA-ES','FIN-FI','SGP-ZH','SGP-EN','LBN-AR','TUR-TR','BEL-NL')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_55",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '2000-09-02' AND visitdate <= DATE_ADD('DAY', 1, '2000-09-02'))\n        AND languagecode IN ('NOR-NO','MLT-EN','ISR-IW','BOL-ES','ALB-SQ','ISL-IS','PRY-ES','SLV-ES')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_56",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '2010-12-20' AND visitdate <= DATE_ADD('DAY', 1, '2010-12-20'))\n        AND languagecode IN ('MYS-MS','UKR-UK','AUS-EN','VEN-ES','GRC-EL','BLR-BE','ARE-AR','SVK-SK')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_57",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1977-06-23' AND visitdate <= DATE_ADD('DAY', 1, '1977-06-23'))\n        AND languagecode IN ('PER-ES','CAN-FR','GRC-EL','RUS-RU','BLR-BE','MEX-ES','ARE-AR','MLT-EN')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_58",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1988-12-31' AND visitdate <= DATE_ADD('DAY', 1, '1988-12-31'))\n        AND languagecode IN ('IND-EN','IRL-EN','SGP-ZH','EGY-AR','VEN-ES','UKR-UK','VNM-VI','ROU-RO')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_59",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1999-04-15' AND visitdate <= DATE_ADD('DAY', 1, '1999-04-15'))\n        AND languagecode IN ('AUS-EN','MAR-AR','MYS-MS','AUS-EN','BOL-ES','SVK-SK','JOR-AR','BEL-NL')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_60",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '2009-08-01' AND visitdate <= DATE_ADD('DAY', 1, '2009-08-01'))\n        AND languagecode IN ('MYS-MS','SGP-ZH','CHL-ES','ISR-IW','SGP-EN','CYP-EL','FIN-FI','HRV-HR')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_61",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1976-07-15' AND visitdate <= DATE_ADD('DAY', 1, '1976-07-15'))\n        AND languagecode IN ('USA-ES','BEL-NL','JOR-AR','BEL-NL','PAN-ES','SYR-AR','SVK-SK','LTU-LT')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_62",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1987-06-11' AND visitdate <= DATE_ADD('DAY', 1, '1987-06-11'))\n        AND languagecode IN ('NOR-NO','PER-ES','LBN-AR','THA-TH','USA-ES','IRL-EN','MYS-MS','UKR-UK')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_63",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1999-07-29' AND visitdate <= DATE_ADD('DAY', 1, '1999-07-29'))\n        AND languagecode IN ('CUB-ES','ISR-IW','COL-ES','MAR-AR','TUR-TR','LTU-LT','MNE-SR','ISL-IS')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_64",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '2011-09-15' AND visitdate <= DATE_ADD('DAY', 1, '2011-09-15'))\n        AND languagecode IN ('CRI-ES','CYP-EL','SVK-SK','BOL-ES','ZAF-EN','GRC-DE','SGP-EN','ISL-IS')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_65",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1977-12-15' AND visitdate <= DATE_ADD('DAY', 1, '1977-12-15'))\n        AND languagecode IN ('THA-TH','CHE-IT','USA-ES','ROU-RO','CHL-ES','BHR-AR','BEL-NL','MLT-MT')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_66",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1988-11-10' AND visitdate <= DATE_ADD('DAY', 1, '1988-11-10'))\n        AND languagecode IN ('BEL-NL','PAN-ES','BLR-BE','ZAF-EN','PAN-ES','BEL-NL','NLD-NL','MEX-ES')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_67",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1998-03-14' AND visitdate <= DATE_ADD('DAY', 1, '1998-03-14'))\n        AND languagecode IN ('CYP-EL','LBN-AR','AUS-EN','AUS-EN','IDN-IN','CHN-ZH','PAN-ES','SVK-SK')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_68",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '2010-05-01' AND visitdate <= DATE_ADD('DAY', 1, '2010-05-01'))\n        AND languagecode IN ('PRI-ES','IND-EN','NOR-NO','BLR-BE','GRC-DE','DZA-AR','ISL-IS','TUR-TR')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_69",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1979-04-23' AND visitdate <= DATE_ADD('DAY', 1, '1979-04-23'))\n        AND languagecode IN ('MYS-MS','CYP-EL','NZL-EN','CHN-ZH','VNM-VI','ISL-IS','HRV-HR','CHE-IT')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_70",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1990-04-20' AND visitdate <= DATE_ADD('DAY', 1, '1990-04-20'))\n        AND languagecode IN ('BIH-SR','SYR-AR','RUS-RU','MAR-AR','BLR-BE','ISR-IW','ISR-IW','GRC-EL')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_71",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '2002-05-06' AND visitdate <= DATE_ADD('DAY', 1, '2002-05-06'))\n        AND languagecode IN ('PER-ES','PRI-ES','EGY-AR','CUB-ES','CRI-ES','SGP-EN','NZL-EN','MLT-MT')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_72",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1980-09-22' AND visitdate <= DATE_ADD('DAY', 1, '1980-09-22'))\n        AND languagecode IN ('SYR-AR','LBN-AR','PRY-ES','ARE-AR','SLV-ES','CUB-ES','MLT-MT','ZAF-EN')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_73",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1991-09-20' AND visitdate <= DATE_ADD('DAY', 1, '1991-09-20'))\n        AND languagecode IN ('BIH-SR','AUS-EN','AUS-EN','CAN-FR','HUN-HU','PRI-ES','TUR-TR','USA-ES')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_74",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '2000-12-20' AND visitdate <= DATE_ADD('DAY', 1, '2000-12-20'))\n        AND languagecode IN ('MLT-EN','IDN-IN','PRY-ES','IRL-EN','BLR-BE','SVK-SK','SVK-SK','BHR-AR')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_75",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1970-09-23' AND visitdate <= DATE_ADD('DAY', 1, '1970-09-23'))\n        AND languagecode IN ('BOL-ES','BHR-AR','DZA-AR','ISL-IS','AUS-EN','EGY-AR','ALB-SQ','UKR-UK')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_76",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1981-09-20' AND visitdate <= DATE_ADD('DAY', 1, '1981-09-20'))\n        AND languagecode IN ('PAN-ES','UKR-UK','MLT-MT','MEX-ES','GRC-DE','BLR-BE','RUS-RU','HUN-HU')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_77",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1994-02-15' AND visitdate <= DATE_ADD('DAY', 1, '1994-02-15'))\n        AND languagecode IN ('ARE-AR','COL-ES','FIN-FI','MLT-MT','CYP-EL','SGP-ZH','ISR-IW','SLV-ES')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_78",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '2006-05-06' AND visitdate <= DATE_ADD('DAY', 1, '2006-05-06'))\n        AND languagecode IN ('ISL-IS','PAN-ES','DZA-AR','BIH-SR','PRI-ES','SGP-ZH','TUR-TR','IRL-EN')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_79",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1972-02-11' AND visitdate <= DATE_ADD('DAY', 1, '1972-02-11'))\n        AND languagecode IN ('CAN-FR','THA-TH','ZAF-EN','IRL-EN','USA-ES','CRI-ES','MYS-MS','PER-ES')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_80",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1983-02-08' AND visitdate <= DATE_ADD('DAY', 1, '1983-02-08'))\n        AND languagecode IN ('BHR-AR','ARE-AR','BLR-BE','GRC-EL','MNE-SR','IRL-EN','SVK-SK','BHR-AR')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q9_1",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.19305812655537044 and 0.5973057863688664 and visitdate between '1973-12-22' and '1973-12-28'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_2",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.11521078820019848 and 0.4752965607809379 and visitdate between '1984-02-03' and '1984-02-09'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_3",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.2459744403049445 and 0.7886532558071156 and visitdate between '1997-03-09' and '1997-03-15'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_4",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.2125487483579576 and 0.520029795227606 and visitdate between '2008-11-17' and '2008-11-23'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_5",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.23156044090624991 and 0.43450123533408985 and visitdate between '1975-05-08' and '1975-05-14'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_6",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.22514705094825999 and 0.6634082435485782 and visitdate between '1985-06-19' and '1985-06-25'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_7",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.26433777431207284 and 0.3335577591134443 and visitdate between '2007-06-18' and '2007-06-24'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_8",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.027756918042477364 and 0.6522978347071443 and visitdate between '1995-10-08' and '1995-10-14'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_9",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.23440473399065875 and 0.6983727032249006 and visitdate between '1971-03-24' and '1971-03-30'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_10",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.01826369782784502 and 0.6668257136988461 and visitdate between '1981-04-03' and '1981-04-09'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_11",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.24301831515567118 and 0.4584484465130563 and visitdate between '2006-01-16' and '2006-01-22'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_12",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.10084009301915721 and 0.6356513891168876 and visitdate between '1994-06-09' and '1994-06-15'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_13",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.058572490484693526 and 0.2099534796825985 and visitdate between '1972-08-07' and '1972-08-13'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_14",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.0018951480747636579 and 0.1002775878166042 and visitdate between '1982-08-18' and '1982-08-24'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_15",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.2131183716533354 and 0.5827691859965131 and visitdate between '1993-01-07' and '1993-01-13'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_16",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.18367347871021453 and 0.07088848967603237 and visitdate between '2004-08-16' and '2004-08-22'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_17",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.19156698666546448 and 0.03295804024102178 and visitdate between '1979-10-10' and '1979-10-16'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_18",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.06899544507160664 and 0.4530957313617904 and visitdate between '1989-10-20' and '1989-10-26'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_19",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.16032800034064368 and 0.8952081241729953 and visitdate between '2002-08-24' and '2002-08-30'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_20",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.22203290762764513 and 0.4639770188694363 and visitdate between '1981-03-15' and '1981-03-21'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_21",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.2595791597563469 and 0.6612653024646784 and visitdate between '1991-03-26' and '1991-04-01'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_22",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.21664971054872842 and 0.20569251102325276 and visitdate between '2001-04-05' and '2001-04-11'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_23",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.24317647207970075 and 0.34054539176802057 and visitdate between '1976-12-08' and '1976-12-14'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_24",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.01861455849592092 and 0.2849671519014694 and visitdate between '1987-01-20' and '1987-01-26'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_25",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.2429144364492833 and 0.051056348078336956 and visitdate between '1999-10-23' and '1999-10-29'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_26",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.09335529536177095 and 0.31424265535227713 and visitdate between '2011-07-03' and '2011-07-09'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_27",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.1663074808095177 and 0.3620506819740003 and visitdate between '1978-05-14' and '1978-05-20'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_28",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.18594556211185892 and 0.7031905019778453 and visitdate between '1988-06-25' and '1988-07-01'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_29",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.2403862786195788 and 0.41700519146806436 and visitdate between '1998-06-04' and '1998-06-10'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_30",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.1501507665775253 and 0.9622973376179292 and visitdate between '2010-02-12' and '2010-02-18'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_31",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.01450594783558983 and 0.0523338651113516 and visitdate between '1973-04-13' and '1973-04-19'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_32",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.0007276136265421377 and 0.3140121534432899 and visitdate between '1984-10-21' and '1984-10-27'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_33",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.29737171063801326 and 0.24191422333313176 and visitdate between '2008-03-11' and '2008-03-17'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_34",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.11792601502570607 and 0.16289552190210504 and visitdate between '1997-11-23' and '1997-11-29'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_35",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.11233437154300525 and 0.5071475399731822 and visitdate between '1974-08-28' and '1974-09-03'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_36",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.27840698681239656 and 0.4773149357295923 and visitdate between '1986-03-07' and '1986-03-13'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_37",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.061934040620931934 and 0.4531833508078475 and visitdate between '2006-10-10' and '2006-10-16'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_38",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.29752002375651476 and 0.22962351345839674 and visitdate between '1996-06-23' and '1996-06-29'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_39",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.17546457363235105 and 0.3384312367740896 and visitdate between '1981-12-12' and '1981-12-18'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_40",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.042695362658967596 and 0.7356602365058673 and visitdate between '2005-05-02' and '2005-05-08'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_41",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.021359491201654982 and 0.8613902269807573 and visitdate between '1970-07-06' and '1970-07-12'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_42",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.2292304638687827 and 0.20661948863269405 and visitdate between '1995-02-15' and '1995-02-21'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_43",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.06256746638683001 and 0.8067422091213448 and visitdate between '1971-11-20' and '1971-11-26'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_44",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.2321151660883139 and 0.07322944232353035 and visitdate between '1983-04-28' and '1983-05-04'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_45",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.128249047228176 and 0.7737131413296744 and visitdate between '2003-12-01' and '2003-12-07'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_46",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.15243634152954758 and 0.29424166306017646 and visitdate between '1993-09-15' and '1993-09-21'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_47",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.10985828162359906 and 0.4626274448257752 and visitdate between '1979-01-30' and '1979-02-05'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_48",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.234279139901713 and 0.15352858343755477 and visitdate between '1990-07-08' and '1990-07-14'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_49",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.24158128207952098 and 0.6785273919672199 and visitdate between '2003-05-10' and '2003-05-16'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_50",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.12220001716068092 and 0.6858740286349784 and visitdate between '1980-07-05' and '1980-07-11'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_51",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.010711815599815903 and 0.4901899376499641 and visitdate between '1991-12-12' and '1991-12-18'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_52",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.20488971458818458 and 0.9671108973551696 and visitdate between '2001-12-20' and '2001-12-26'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_53",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.2627283286355542 and 0.7529722860151844 and visitdate between '2012-03-06' and '2012-03-12'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_54",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.012641888702262556 and 0.1959179086113706 and visitdate between '1976-03-22' and '1976-03-28'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_55",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.2877025565610121 and 0.08850273090889878 and visitdate between '1987-09-30' and '1987-10-06'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_56",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.06898288429059334 and 0.2415132495380727 and visitdate between '2010-10-17' and '2010-10-23'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_57",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.14221236107031876 and 0.8808082840775394 and visitdate between '2000-06-30' and '2000-07-06'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_58",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.27412213333346613 and 0.12454621076308706 and visitdate between '1977-08-26' and '1977-09-01'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_59",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.025020102483542507 and 0.43980647806540674 and visitdate between '1989-03-05' and '1989-03-11'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_60",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.2079932537297588 and 0.5118498037415717 and visitdate between '1999-02-10' and '1999-02-16'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_61",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.11543932800667372 and 0.46801704415960266 and visitdate between '2009-05-29' and '2009-06-04'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_62",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.21120677689535244 and 0.4344460599671614 and visitdate between '1993-07-27' and '1993-08-02'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_63",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.1613116253626206 and 0.4758827839765403 and visitdate between '1979-06-22' and '1979-06-28'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_64",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.2427827125130881 and 0.38409170002682985 and visitdate between '1989-10-06' and '1989-10-12'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_65",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.016264521292189953 and 0.33991030644924974 and visitdate between '2002-11-10' and '2002-11-16'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_66",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.21326118123137058 and 0.06864821014674309 and visitdate between '1980-11-21' and '1980-11-27'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_67",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.10497493244901353 and 0.0163724888863416 and visitdate between '1991-03-08' and '1991-03-14'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_68",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.12526972985927942 and 0.5823862699062733 and visitdate between '2001-06-26' and '2001-07-02'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_69",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.09681825207100384 and 0.6332219435176403 and visitdate between '1976-09-21' and '1976-09-27'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_70",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.1447634305707988 and 0.13414406781057728 and visitdate between '1986-12-05' and '1986-12-11'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_71",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.09183808091929636 and 0.9027486012742871 and visitdate between '2000-02-10' and '2000-02-16'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_72",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.2612627924296861 and 0.9060936767752157 and visitdate between '2011-07-17' and '2011-07-23'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_73",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.0017966471147956005 and 0.07752475972169412 and visitdate between '1978-02-21' and '1978-02-27'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_74",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.1585750871967125 and 0.6811702506683512 and visitdate between '1988-05-06' and '1988-05-12'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_75",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.2639964383456316 and 0.2972345416656549 and visitdate between '1998-09-26' and '1998-10-02'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_76",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.04320143166862586 and 0.6180280217877234 and visitdate between '2010-03-02' and '2010-03-08'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_77",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.23667185716236094 and 0.24825101092386576 and visitdate between '1974-02-06' and '1974-02-12'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_78",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.046484427010849254 and 0.1571585008018643 and visitdate between '1984-04-21' and '1984-04-27'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_79",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.26880839167495735 and 0.5436679520799664 and visitdate between '2008-07-30' and '2008-08-05'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_80",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.1909721855824318 and 0.9438601628705185 and visitdate between '1997-02-23' and '1997-03-01'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q10_1",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 263\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_2",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 194\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_3",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 67\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_4",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 249\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_5",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 160\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_6",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 251\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_7",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 559\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_8",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 336\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_9",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 557\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_10",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 50\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_11",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 73\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_12",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 499\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_13",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 283\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_14",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 540\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_15",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 131\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_16",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 47\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_17",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 558\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_18",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 449\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_19",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 251\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_20",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 429\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_21",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 347\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_22",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 60\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_23",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 215\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_24",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 307\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_25",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 579\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_26",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 187\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_27",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 66\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_28",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 298\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_29",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 521\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_30",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 380\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_31",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 435\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_32",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 275\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_33",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 505\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_34",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 474\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_35",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 266\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_36",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 384\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_37",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 400\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_38",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 90\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_39",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 270\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_40",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 227\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_41",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 314\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_42",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 42\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_43",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 5\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_44",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 367\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_45",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 346\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_46",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 345\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_47",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 198\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_48",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 480\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_49",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 480\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_50",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 156\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_51",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 454\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_52",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 366\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_53",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 584\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_54",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 535\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_55",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 212\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_56",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 239\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_57",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 209\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_58",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 432\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_59",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 267\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_60",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 10\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_61",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 172\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_62",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 544\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_63",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 242\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_64",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 116\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_65",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 376\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_66",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 570\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_67",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 10\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_68",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 23\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_69",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 199\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_70",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 370\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_71",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 103\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_72",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 559\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_73",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 581\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_74",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 368\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_75",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 407\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_76",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 358\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_77",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 117\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_78",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 428\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_79",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 53\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_80",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 119\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q11_1",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1974-02-24'\n  and searchword in ('sxmgkfwg','ihreoyl','quh','isjnejcbt','pqrmt','nktythyspxxbkhqjg')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_2",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1984-04-07'\n  and searchword in ('sxmgkfwg','bcnmiujeyjyfvfu','ocwh','ocwh','hqrvhf','lahkr')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_3",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1997-01-04'\n  and searchword in ('bcnmiujeyjyfvfu','nktythyspxxbkhqjg','wjpxsxcjtca','ocwh','yarebhaapateqgw','ygligwfhmfddwt')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_4",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '2008-09-14'\n  and searchword in ('vpxhrknujq','lhyugdqgsickuyr','mlsejjptdrgx','bcnmiujeyjyfvfu','jijqxuqrob','sxmgkfwg')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_5",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1975-07-11'\n  and searchword in ('pwfkrlvcpldhmkxjk','molcyes','sxmgkfwg','gbtwq','ygligwfhmfddwt','ejdsler')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_6",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1985-08-22'\n  and searchword in ('pwfkrlvcpldhmkxjk','pqrmt','hljfakltk','pwfkrlvcpldhmkxjk','guowlxg','uidy')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_7",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1995-08-05'\n  and searchword in ('vpxhrknujq','cuxwemrp','mnbsgpud','icnapelratsx','cuxwemrp','molcyes')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_8",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '2007-04-15'\n  and searchword in ('guowlxg','ygligwfhmfddwt','ybhme','wjpxsxcjtca','rumclqkuxilymf','cuxwemrp')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_9",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1971-05-27'\n  and searchword in ('jijqxuqrob','spxcpjkkdirxe','yarebhaapateqgw','ihreoyl','pwfkrlvcpldhmkxjk','qh')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_10",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1981-06-06'\n  and searchword in ('mlsejjptdrgx','kmsg','lhyugdqgsickuyr','ujfwbhiekb','mpqyvynqbflmgsht','cuxwemrp')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_11",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1994-04-06'\n  and searchword in ('ybhme','qh','atsxuhrr','hqrvhf','yarebhaapateqgw','atsxuhrr')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_12",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '2005-11-13'\n  and searchword in ('pwfkrlvcpldhmkxjk','kxkhnsgocx','mlsejjptdrgx','icnapelratsx','xfgiqcg','spxcpjkkdirxe')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_13",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1972-10-10'\n  and searchword in ('mhlestnqvkoy','fygltsduif','oonmytcyr','shaorjfgxwcrn','xfgiqcg','isjnejcbt')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_14",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1982-10-21'\n  and searchword in ('oehvhg','jkiewhvgoy','lhyugdqgsickuyr','ncovkppmmngd','ncovkppmmngd','ncovkppmmngd')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_15",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1992-11-04'\n  and searchword in ('hljfakltk','wxihqnuwyonfljuw','kxkhnsgocx','molcyes','pwfkrlvcpldhmkxjk','mhlestnqvkoy')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_16",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '2004-06-13'\n  and searchword in ('lahkr','uidy','hynny','kmsg','pwfkrlvcpldhmkxjk','fygltsduif')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_17",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1979-08-07'\n  and searchword in ('wjpxsxcjtca','ncovkppmmngd','oonmytcyr','nktythyspxxbkhqjg','atsxuhrr','guowlxg')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_18",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1989-08-17'\n  and searchword in ('xfgiqcg','quh','xkqxrgrxwqxfjsx','pwfkrlvcpldhmkxjk','molcyes','mlsejjptdrgx')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_19",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '2002-10-27'\n  and searchword in ('uidy','vpxhrknujq','pwfkrlvcpldhmkxjk','jkiewhvgoy','hynny','ihreoyl')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_20",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1981-01-10'\n  and searchword in ('wxihqnuwyonfljuw','ejdsler','lahkr','hqrvhf','uqydsdofaysph','molcyes')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_21",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1991-01-21'\n  and searchword in ('gbtwq','yarebhaapateqgw','uidy','fygltsduif','uidy','rddb')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_22",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '2001-06-08'\n  and searchword in ('tbnveyjnwj','gbtwq','cuxwemrp','igbuxpchvbcn','gbtwq','shaorjfgxwcrn')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_23",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1976-10-05'\n  and searchword in ('tbnveyjnwj','hynny','icnapelratsx','ybhme','gbtwq','ncovkppmmngd')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_24",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1986-11-17'\n  and searchword in ('isjnejcbt','jkiewhvgoy','ejdsler','ncovkppmmngd','spxcpjkkdirxe','ygligwfhmfddwt')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_25",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '2011-09-05'\n  and searchword in ('gbtwq','rumclqkuxilymf','ablxvb','mlsejjptdrgx','oonmytcyr','sxmgkfwg')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_26",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1999-12-26'\n  and searchword in ('ito','rn','jkiewhvgoy','hljfakltk','nktythyspxxbkhqjg','oehvhg')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_27",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1978-03-11'\n  and searchword in ('ysvubyupnk','molcyes','mlsejjptdrgx','spxcpjkkdirxe','jpsald','pqrmt')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_28",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1988-04-22'\n  and searchword in ('atsxuhrr','kmsg','cuxwemrp','ablxvb','ysvubyupnk','pqrmt')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_29",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1998-08-07'\n  and searchword in ('pwfkrlvcpldhmkxjk','atsxuhrr','isjnejcbt','rpvsj','gbtwq','rumclqkuxilymf')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_30",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '2010-04-17'\n  and searchword in ('gvlyldtbcdurafwhk','ablxvb','ablxvb','tbnveyjnwj','tbnveyjnwj','ito')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_31",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1973-06-16'\n  and searchword in ('uidy','atsxuhrr','rpvsj','ygligwfhmfddwt','icnapelratsx','fygltsduif')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_32",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1984-12-24'\n  and searchword in ('vpxhrknujq','mhlestnqvkoy','rpvsj','ybhme','pqrmt','mlsejjptdrgx')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_33",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1997-09-20'\n  and searchword in ('yarebhaapateqgw','ihreoyl','kxkhnsgocx','bcnmiujeyjyfvfu','xkqxrgrxwqxfjsx','ujfwbhiekb')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_34",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '2008-01-07'\n  and searchword in ('isjnejcbt','mpqyvynqbflmgsht','qh','ysvubyupnk','xfgiqcg','jijqxuqrob')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_35",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1974-10-31'\n  and searchword in ('aol','igbuxpchvbcn','rpvsj','ysvubyupnk','gbtwq','ablxvb')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_36",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1986-05-10'\n  and searchword in ('molcyes','mpqyvynqbflmgsht','lahkr','pwfkrlvcpldhmkxjk','obrrrwadksyx','atsxuhrr')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_37",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1996-04-20'\n  and searchword in ('jpsald','fygltsduif','wjpxsxcjtca','guowlxg','tbnveyjnwj','ysvubyupnk')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_38",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '2006-08-07'\n  and searchword in ('kmsg','ncovkppmmngd','uidy','atsxuhrr','atsxuhrr','ysvubyupnk')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_39",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1970-09-08'\n  and searchword in ('jijqxuqrob','vpxhrknujq','molcyes','guowlxg','ujfwbhiekb','cuxwemrp')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_40",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1982-02-14'\n  and searchword in ('bcnmiujeyjyfvfu','kmsg','lhyugdqgsickuyr','xfgiqcg','uidy','ysvubyupnk')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_41",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1994-12-13'\n  and searchword in ('xfgiqcg','ablxvb','atsxuhrr','rpvsj','uidy','ujfwbhiekb')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_42",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '2005-02-27'\n  and searchword in ('ncovkppmmngd','tbnveyjnwj','xfgiqcg','vpxhrknujq','ysvubyupnk','atsxuhrr')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_43",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1972-01-23'\n  and searchword in ('cuxwemrp','shaorjfgxwcrn','oonmytcyr','xkqxrgrxwqxfjsx','igbuxpchvbcn','nktythyspxxbkhqjg')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_44",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1983-07-01'\n  and searchword in ('atsxuhrr','kmsg','wxihqnuwyonfljuw','atsxuhrr','qkickqwvskyqurmx','igbuxpchvbcn')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_45",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1993-07-13'\n  and searchword in ('pwfkrlvcpldhmkxjk','rn','gbtwq','ujfwbhiekb','uidy','rpvsj')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_46",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '2003-09-28'\n  and searchword in ('isjnejcbt','wjpxsxcjtca','ihreoyl','qkickqwvskyqurmx','jpsald','ysvubyupnk')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_47",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1978-11-27'\n  and searchword in ('xfgiqcg','igbuxpchvbcn','tbnveyjnwj','rddb','ujfwbhiekb','hqrvhf')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_48",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1990-05-05'\n  and searchword in ('rddb','oonmytcyr','nktythyspxxbkhqjg','wxihqnuwyonfljuw','uidy','xfgiqcg')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_49",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '2003-07-13'\n  and searchword in ('mpqyvynqbflmgsht','cuxwemrp','aol','pqrmt','jkiewhvgoy','aol')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_50",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1980-05-02'\n  and searchword in ('vpxhrknujq','wjpxsxcjtca','jkiewhvgoy','qh','xfgiqcg','molcyes')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_51",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1991-10-09'\n  and searchword in ('qkickqwvskyqurmx','pwfkrlvcpldhmkxjk','yarebhaapateqgw','quh','wjpxsxcjtca','guowlxg')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_52",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '2002-02-22'\n  and searchword in ('jijqxuqrob','hynny','hynny','quh','vpxhrknujq','hqrvhf')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_53",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1976-01-18'\n  and searchword in ('uidy','oehvhg','qkickqwvskyqurmx','guowlxg','quh','molcyes')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_54",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1987-07-28'\n  and searchword in ('wjpxsxcjtca','cuxwemrp','guowlxg','rpvsj','hqrvhf','ito')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_55",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '2000-09-02'\n  and searchword in ('xkqxrgrxwqxfjsx','ygligwfhmfddwt','kmsg','qkickqwvskyqurmx','pqrmt','ncovkppmmngd')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_56",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '2010-12-20'\n  and searchword in ('oehvhg','ejdsler','tbnveyjnwj','jijqxuqrob','ablxvb','ablxvb')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_57",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1977-06-23'\n  and searchword in ('kmsg','lahkr','quh','jpsald','obrrrwadksyx','vpxhrknujq')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_58",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1988-12-31'\n  and searchword in ('igbuxpchvbcn','hljfakltk','pqrmt','ihreoyl','yarebhaapateqgw','wxihqnuwyonfljuw')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_59",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1999-04-15'\n  and searchword in ('spxcpjkkdirxe','bcnmiujeyjyfvfu','xkqxrgrxwqxfjsx','mnbsgpud','lhyugdqgsickuyr','ygligwfhmfddwt')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_60",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '2009-08-01'\n  and searchword in ('ybhme','gvlyldtbcdurafwhk','yarebhaapateqgw','oonmytcyr','vpxhrknujq','pqrmt')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_61",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1972-06-18'\n  and searchword in ('nktythyspxxbkhqjg','mpqyvynqbflmgsht','aol','ihreoyl','isjnejcbt','kmsg')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_62",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1982-10-03'\n  and searchword in ('wxihqnuwyonfljuw','mhlestnqvkoy','nktythyspxxbkhqjg','rpvsj','cuxwemrp','oonmytcyr')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_63",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1993-01-17'\n  and searchword in ('ygligwfhmfddwt','obrrrwadksyx','ncovkppmmngd','icnapelratsx','xkqxrgrxwqxfjsx','uqydsdofaysph')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_64",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '2004-07-25'\n  and searchword in ('qh','pwfkrlvcpldhmkxjk','rpvsj','yarebhaapateqgw','gvlyldtbcdurafwhk','isjnejcbt')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_65",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1971-01-29'\n  and searchword in ('wxihqnuwyonfljuw','wxihqnuwyonfljuw','vpxhrknujq','kmsg','vpxhrknujq','ito')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_66",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1981-05-15'\n  and searchword in ('tbnveyjnwj','kmsg','ysvubyupnk','rn','cuxwemrp','atsxuhrr')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_67",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1994-06-23'\n  and searchword in ('guowlxg','ejdsler','ito','xkqxrgrxwqxfjsx','fygltsduif','ybhme')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_68",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '2005-12-29'\n  and searchword in ('uqydsdofaysph','uidy','sxmgkfwg','quh','qkickqwvskyqurmx','shaorjfgxwcrn')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_69",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1975-04-28'\n  and searchword in ('spxcpjkkdirxe','ihreoyl','lhyugdqgsickuyr','icnapelratsx','nktythyspxxbkhqjg','wjpxsxcjtca')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_70",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1985-07-11'\n  and searchword in ('qkickqwvskyqurmx','kmsg','ablxvb','wjpxsxcjtca','uidy','pwfkrlvcpldhmkxjk')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_71",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1995-11-27'\n  and searchword in ('xkqxrgrxwqxfjsx','gbtwq','isjnejcbt','rumclqkuxilymf','rn','quh')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_72",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '2007-05-03'\n  and searchword in ('qh','uqydsdofaysph','rpvsj','rpvsj','ablxvb','ncovkppmmngd')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_73",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1973-12-08'\n  and searchword in ('aol','rumclqkuxilymf','nktythyspxxbkhqjg','aol','ncovkppmmngd','pqrmt')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_74",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1984-02-21'\n  and searchword in ('uidy','oonmytcyr','mlsejjptdrgx','kxkhnsgocx','ysvubyupnk','isjnejcbt')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_75",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1997-05-02'\n  and searchword in ('vpxhrknujq','kmsg','ocwh','vpxhrknujq','ujfwbhiekb','ocwh')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_76",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '2008-10-06'\n  and searchword in ('aol','lhyugdqgsickuyr','ablxvb','uidy','xfgiqcg','kmsg')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_77",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1978-04-22'\n  and searchword in ('guowlxg','mhlestnqvkoy','igbuxpchvbcn','aol','shaorjfgxwcrn','kxkhnsgocx')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_78",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1988-07-05'\n  and searchword in ('pqrmt','mhlestnqvkoy','kmsg','pqrmt','ihreoyl','yarebhaapateqgw')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_79",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1998-07-20'\n  and searchword in ('rn','hljfakltk','oonmytcyr','ito','igbuxpchvbcn','atsxuhrr')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_80",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '2009-12-24'\n  and searchword in ('pqrmt','kmsg','kxkhnsgocx','mhlestnqvkoy','pwfkrlvcpldhmkxjk','xfgiqcg')\nLimit 65;"
        },
        {
            "sql_id": "app_q12_1",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1995-10-07' and visitdate <= '1995-11-06' AND\n  countrycode in ( 'UKR','DZA','CUB','ECU','CHE','CHE','LUX','QAT','POL','BHR') AND\n  languagecode in ( 'UKR-UK','DZA-AR','CUB-ES','ECU-ES','CHE-IT','CHE-FR','LUX-DE','QAT-AR','POL-PL','BHR-AR') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Hqygxeaiogi/1.6','Opera 7.51 (Win XP): Opera/7.51 (Windows NT 5.1; U)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_2",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '2006-11-08' and visitdate <= '2006-12-08' AND\n  countrycode in ( 'GTM','PAN','POL','DNK','BLR','IDN','BIH','GRC','KOR','HUN') AND\n  languagecode in ( 'GTM-ES','PAN-ES','POL-PL','DNK-DA','BLR-BE','IDN-IN','BIH-SR','GRC-EL','KOR-KO','HUN-HU') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Ktpxdxmpqarsx/4.','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Lwydawgncpqlyshyu/2.2','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/5.0 (Windows; U; Windows NT 5.1)Gecko/20070803 Firefox/1.5.0.12','Fshderpgt/5.3','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_3",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1983-08-07' and visitdate <= '1983-09-06' AND\n  countrycode in ( 'AUT','DOM','HND','NOR','VEN','ESP','BGR','BEL','PHL','BEL') AND\n  languagecode in ( 'AUT-DE','DOM-ES','HND-ES','NOR-NO','VEN-ES','ESP-ES','BGR-BG','BEL-FR','PHL-EN','BEL-NL') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','yaqlmqsdrriehttwinrue/5.','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/5.0 (Windows; U; Windows NT 5.1)Gecko/20070309 Firefox/2.0.0.3','Umjelglitnjrc/8.5')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_4",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1998-03-14' and visitdate <= '1998-04-13' AND\n  countrycode in ( 'CRI','TUN','CHE','KOR','NLD','FRA','BLR','CHE','JPN','ESP') AND\n  languagecode in ( 'CRI-ES','TUN-AR','CHE-FR','KOR-KO','NLD-NL','FRA-FR','BLR-BE','CHE-DE','JPN-JA','ESP-CA') AND\n  useragent in ( 'Idcwyjutdnvoqlr/8.6','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)','Netscape 4.8 (Windows Vista): Mozilla/4.8 (Windows NT 6.0; U)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Omnbvmfdnpwot/6.4')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_5",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1983-02-06' and visitdate <= '1983-03-08' AND\n  countrycode in ( 'SGP','RUS','IDN','VEN','MLT','BEL','CHN','NIC','BRA','DNK') AND\n  languagecode in ( 'SGP-ZH','RUS-RU','IDN-IN','VEN-ES','MLT-MT','BEL-FR','CHN-ZH','NIC-ES','BRA-PT','DNK-DA') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Ntcnoxdahvencltfdj/4.7','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Idcwyjutdnvoqlr/8.6','Fshderpgt/5.3','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Mozilla/5.0 (Windows; U; Windows NT 5.2)AppleWebKit/525.13 (KHTML like Gecko) Version/3.1Safari/525.13','Lyxuldtsom/3.','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_6",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1999-10-07' and visitdate <= '1999-11-06' AND\n  countrycode in ( 'SAU','VEN','AUS','CAN','BEL','ISL','LBY','LBY','MEX','BIH') AND\n  languagecode in ( 'SAU-AR','VEN-ES','AUS-EN','CAN-EN','BEL-NL','ISL-IS','LBY-AR','LBY-AR','MEX-ES','BIH-SR') AND\n  useragent in ( 'Hlsnwcnehpkswct/6.0','Netscape 4.8 ( Win XP): Mozilla/4.8 (Windows NT 5.1; U)','Lcpwdrdcc/4.5','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/5.0 (Windows; U; Windows NT 5.2)AppleWebKit/525.13 (KHTML like Gecko) Version/3.1Safari/525.13','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','vaeapoopfb/7.','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_7",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1993-11-05' and visitdate <= '1993-12-05' AND\n  countrycode in ( 'OMN','KOR','CAN','CAN','TUN','SWE','MYS','MLT','NOR','NOR') AND\n  languagecode in ( 'OMN-AR','KOR-KO','CAN-FR','CAN-FR','TUN-AR','SWE-SV','MYS-MS','MLT-EN','NOR-NO','NOR-NO') AND\n  useragent in ( 'Mozilla/5.0 (Macintosh; U; PPC Mac OS X; en) AppleWebKit/125.2 (KHTML like Gecko) Safari/85.8','Oahjbrasijtqkxfgsdf/5.2','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)','Amnhtdlxnnjqh/8.8','Hrntviklfmvmet/8.3','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_8",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1993-04-23' and visitdate <= '1993-05-23' AND\n  countrycode in ( 'DOM','POL','BEL','AUT','SRB','OMN','SYR','MNE','JPN','HKG') AND\n  languagecode in ( 'DOM-ES','POL-PL','BEL-FR','AUT-DE','SRB-SR','OMN-AR','SYR-AR','MNE-SR','JPN-JA','HKG-ZH') AND\n  useragent in ( 'Vhinbpoveodvxhqknprpeh/2.','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Sqangdxoyvqgxi/4.4','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/0.2.149.27 Safari/525.13','Hjvinbgnr/0.1','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Mozilla/5.0 (Windows; U; Windows NT 5.2)AppleWebKit/525.13 (KHTML like Gecko) Version/3.1Safari/525.13','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_9",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1977-09-09' and visitdate <= '1977-10-09' AND\n  countrycode in ( 'LBY','BRA','ECU','FIN','AUT','SAU','BIH','BOL','BEL','IND') AND\n  languagecode in ( 'LBY-AR','BRA-PT','ECU-ES','FIN-FI','AUT-DE','SAU-AR','BIH-SR','BOL-ES','BEL-NL','IND-HI') AND\n  useragent in ( 'Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Opera 7.5 (Win ME): Opera/7.50 (Windows ME; U)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Dlxxhp/5.','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/0.2.149.27 Safari/525.13')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_10",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '2003-05-12' and visitdate <= '2003-06-11' AND\n  countrycode in ( 'SGP','GRC','CHE','LTU','BRA','AUS','GRC','ARE','IND','DZA') AND\n  languagecode in ( 'SGP-ZH','GRC-DE','CHE-FR','LTU-LT','BRA-PT','AUS-EN','GRC-EL','ARE-AR','IND-HI','DZA-AR') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mngkkwsnxnonkyitgvngd/6.7','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/5.0 (Macintosh; U; PPC Mac OS X; en) AppleWebKit/125.2 (KHTML like Gecko) Safari/125.8','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)','Vuiauymhnsj/4.8','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Wgwcjkywsskbgolcqr/0.0')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_11",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '2005-08-20' and visitdate <= '2005-09-19' AND\n  countrycode in ( 'VNM','SGP','USA','SYR','HKG','CAN','SVK','SRB','TUR','DZA') AND\n  languagecode in ( 'VNM-VI','SGP-EN','USA-ES','SYR-AR','HKG-ZH','CAN-FR','SVK-SK','SRB-SR','TUR-TR','DZA-AR') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Mozilla/4.0 (compatible; MSIE 5.5; Windows NT 5.0)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 5.5; Windows 98; Win 9x 4.90)','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_12",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1972-11-23' and visitdate <= '1972-12-23' AND\n  countrycode in ( 'HUN','VNM','YEM','SVN','YEM','MLT','DZA','KWT','RUS','OMN') AND\n  languagecode in ( 'HUN-HU','VNM-VI','YEM-AR','SVN-SL','YEM-AR','MLT-EN','DZA-AR','KWT-AR','RUS-RU','OMN-AR') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Opera/9.27 (Windows NT 5.2; U; zh-cn)','Mozilla/5.0 (Macintosh; U; PPC Mac OS X; en) AppleWebKit/125.2 (KHTML like Gecko) Safari/125.8','Wbplavirpsvso/1.6','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Mijpyyetcxqarwwc/7.8')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_13",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1970-01-25' and visitdate <= '1970-02-24' AND\n  countrycode in ( 'ISR','TWN','DOM','BIH','DOM','SDN','SDN','ISR','CAN','CZE') AND\n  languagecode in ( 'ISR-IW','TWN-ZH','DOM-ES','BIH-SR','DOM-ES','SDN-AR','SDN-AR','ISR-IW','CAN-EN','CZE-CS') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Afsvimus/0.3','Jgrwinqxguqymmtgrkjhg/7.0','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Mozilla/5.0 (Windows; U; Windows NT 5.2)AppleWebKit/525.13 (KHTML like Gecko) Version/3.1Safari/525.13')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_14",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1997-07-30' and visitdate <= '1997-08-29' AND\n  countrycode in ( 'PHL','SWE','SRB','SGP','GBR','BIH','THA','ARE','SWE','JPN') AND\n  languagecode in ( 'PHL-EN','SWE-SV','SRB-SR','SGP-ZH','GBR-EN','BIH-SR','THA-TH','ARE-AR','SWE-SV','JPN-JA') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/5.0 (Windows; U; Windows NT 5.2)AppleWebKit/525.13 (KHTML like Gecko) Version/3.1Safari/525.13','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Srrsmvryqfs/2.2','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/5.0 (Windows; U; Windows NT 5.1)Gecko/20070803 Firefox/1.5.0.12','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Mozilla/5.0 (Windows; U; Windows NT 5.2)AppleWebKit/525.13 (KHTML like Gecko) Version/3.1Safari/525.13')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_15",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '2010-09-19' and visitdate <= '2010-10-19' AND\n  countrycode in ( 'LTU','JPN','MLT','DNK','IRL','IRL','ECU','BRA','JPN','QAT') AND\n  languagecode in ( 'LTU-LT','JPN-JA','MLT-EN','DNK-DA','IRL-GA','IRL-GA','ECU-ES','BRA-PT','JPN-JA','QAT-AR') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/5.0 (Windows; U; Windows NT 5.1)Gecko/20070309 Firefox/2.0.0.3','Eustcxywkke/4.5','Ifoygk/.3','Ewgvbowcn/3.3','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Euihdkdbvxgieribncaghw/7.5','Mozilla/5.0 (Windows; U; Windows NT 5.2)Gecko/2008070208 Firefox/3.0.1','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_16",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1981-08-17' and visitdate <= '1981-09-16' AND\n  countrycode in ( 'BEL','CRI','SVN','IRQ','MLT','MLT','BRA','ISL','BIH','HKG') AND\n  languagecode in ( 'BEL-FR','CRI-ES','SVN-SL','IRQ-AR','MLT-MT','MLT-EN','BRA-PT','ISL-IS','BIH-SR','HKG-ZH') AND\n  useragent in ( 'Atagnbypfdgih/8.0','Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.12)Gecko/20080219 Firefox/2.0.0.12\tNavigator/9.0.0.6','Ewbnqkidmwtdprb/8.3','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_17",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '2010-12-30' and visitdate <= '2011-01-29' AND\n  countrycode in ( 'KOR','CAN','OMN','BIH','UKR','ITA','GRC','ITA','DEU','KWT') AND\n  languagecode in ( 'KOR-KO','CAN-EN','OMN-AR','BIH-SR','UKR-UK','ITA-IT','GRC-EL','ITA-IT','DEU-DE','KWT-AR') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 5.5; Windows NT 5.0)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Opera/8.0 (Macintosh; PPC Mac OS X; U; en)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Rkuexfhakosajvrkfvtqe/6.6','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_18",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1991-03-31' and visitdate <= '1991-04-30' AND\n  countrycode in ( 'PHL','HUN','COL','MNE','CUB','JOR','EST','MYS','PAN','CHN') AND\n  languagecode in ( 'PHL-EN','HUN-HU','COL-ES','MNE-SR','CUB-ES','JOR-AR','EST-ET','MYS-MS','PAN-ES','CHN-ZH') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Gucrwbbb/5.6','Pbnnosonnbebmov/1.6','Steqrjcvgxabgvxaosgiob/6.','Xumleidohwgkobfcbq/5.8','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Qvholic/3.5','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_19",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '2003-05-28' and visitdate <= '2003-06-27' AND\n  countrycode in ( 'SRB','VEN','KWT','VEN','USA','CHN','YEM','USA','ARE','BRA') AND\n  languagecode in ( 'SRB-SR','VEN-ES','KWT-AR','VEN-ES','USA-EN','CHN-ZH','YEM-AR','USA-EN','ARE-AR','BRA-PT') AND\n  useragent in ( 'Chmbynddgkvfl/5.2','Umjelglitnjrc/8.5','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/0.2.149.27 Safari/525.13','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/4.0 (compatible; MSIE 5.5; Windows NT 5.0)','Mozilla/5.0 (Windows; U; Windows NT 5.2)AppleWebKit/525.13 (KHTML like Gecko) Version/3.1Safari/525.13','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_20",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1970-02-10' and visitdate <= '1970-03-12' AND\n  countrycode in ( 'MNE','LBY','NOR','ROU','ROU','CHL','BHR','ISR','MYS','DOM') AND\n  languagecode in ( 'MNE-SR','LBY-AR','NOR-NO','ROU-RO','ROU-RO','CHL-ES','BHR-AR','ISR-IW','MYS-MS','DOM-ES') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/5.0 (Windows; U; Windows NT 5.1)Gecko/20070309 Firefox/2.0.0.3','Vamvsk/8.8','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Rkaaarfsnyewg/1.1','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_21",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1991-06-05' and visitdate <= '1991-07-05' AND\n  countrycode in ( 'IDN','LUX','PRY','ITA','YEM','POL','IND','ALB','ISL','EGY') AND\n  languagecode in ( 'IDN-IN','LUX-FR','PRY-ES','ITA-IT','YEM-AR','POL-PL','IND-HI','ALB-SQ','ISL-IS','EGY-AR') AND\n  useragent in ( 'Ktrcivdeobcikqommu/0.6','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Rdcukq/1.2','Urhsivjjcpn/6.2','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_22",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1989-04-09' and visitdate <= '1989-05-09' AND\n  countrycode in ( 'OMN','GTM','BEL','PRT','PAN','GBR','MEX','LTU','NOR','PHL') AND\n  languagecode in ( 'OMN-AR','GTM-ES','BEL-FR','PRT-PT','PAN-ES','GBR-EN','MEX-ES','LTU-LT','NOR-NO','PHL-EN') AND\n  useragent in ( 'Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.12)Gecko/20080219 Firefox/2.0.0.12\tNavigator/9.0.0.6','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/5.0 (Windows; U; Windows NT 5.1)Gecko/20070309 Firefox/2.0.0.3','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_23",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1975-01-05' and visitdate <= '1975-02-04' AND\n  countrycode in ( 'NOR','GTM','HUN','IRQ','BEL','ROU','LUX','SRB','SRB','CHE') AND\n  languagecode in ( 'NOR-NO','GTM-ES','HUN-HU','IRQ-AR','BEL-FR','ROU-RO','LUX-DE','SRB-SR','SRB-SR','CHE-FR') AND\n  useragent in ( 'Mozilla/5.0 (Windows; U; Windows NT 5.2)AppleWebKit/525.13 (KHTML like Gecko) Version/3.1Safari/525.13','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Yriktutuljpik/0.6','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','iPhone 3.0: Mozilla/5.0 (iPhone; U; CPU iPhone OS 3_0 like Mac OS X; en-us) AppleWebKit/528.18 (KHTML like Gecko) Version/4.0 Mobile/7A341 Safari/528.16','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_24",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1983-09-01' and visitdate <= '1983-10-01' AND\n  countrycode in ( 'FRA','FRA','NZL','CHE','CRI','SGP','PER','COL','SGP','BRA') AND\n  languagecode in ( 'FRA-FR','FRA-FR','NZL-EN','CHE-FR','CRI-ES','SGP-EN','PER-ES','COL-ES','SGP-EN','BRA-PT') AND\n  useragent in ( 'Csltowxsehdq/0.7','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Uhbclk/1.8','Qkpuuqplmtgbgoapuehsktso/6.4','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Tiynwwkmqwrlapjltncqlc/4.1','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_25",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '2012-04-07' and visitdate <= '2012-05-07' AND\n  countrycode in ( 'CUB','TUR','NZL','FIN','ESP','IND','LVA','ARE','PAN','ECU') AND\n  languagecode in ( 'CUB-ES','TUR-TR','NZL-EN','FIN-FI','ESP-CA','IND-HI','LVA-LV','ARE-AR','PAN-ES','ECU-ES') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/5.0 (Windows; U; Windows NT 5.1)Gecko/20070309 Firefox/2.0.0.3','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Opera 9.2 (Windows Vista): Opera/9.20 (Windows NT 6.0; U; en)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_26",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '2010-01-21' and visitdate <= '2010-02-20' AND\n  countrycode in ( 'IND','MNE','GRC','URY','YEM','IRL','AUT','CHE','MKD','DNK') AND\n  languagecode in ( 'IND-EN','MNE-SR','GRC-DE','URY-ES','YEM-AR','IRL-EN','AUT-DE','CHE-DE','MKD-MK','DNK-DA') AND\n  useragent in ( 'Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Vvlscvckqjudptfyhmw/.0','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)','Bbvynyjjlv/.','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_27",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1979-03-07' and visitdate <= '1979-04-06' AND\n  countrycode in ( 'PRY','SLV','SDN','LVA','MYS','USA','MYS','CHN','LVA','MNE') AND\n  languagecode in ( 'PRY-ES','SLV-ES','SDN-AR','LVA-LV','MYS-MS','USA-EN','MYS-MS','CHN-ZH','LVA-LV','MNE-SR') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Lgpsxkwifvqrqws/8.1','Hjvinbgnr/0.1','Eakggtiglkqoswdbop/.7','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Jvagmljdmukrkvjeh/.4','Fkjensrbpgmvkssr/0.1')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_28",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1990-07-17' and visitdate <= '1990-08-16' AND\n  countrycode in ( 'BGR','DNK','FIN','GRC','KOR','IDN','MAR','MLT','DEU','LBN') AND\n  languagecode in ( 'BGR-BG','DNK-DA','FIN-FI','GRC-DE','KOR-KO','IDN-IN','MAR-AR','MLT-MT','DEU-DE','LBN-AR') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 5.5; Windows NT 5.0)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','iPhone 3.0: Mozilla/5.0 (iPhone; U; CPU iPhone OS 3_0 like Mac OS X; en-us) AppleWebKit/528.18 (KHTML like Gecko) Version/4.0 Mobile/7A341 Safari/528.16','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_29",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1974-08-20' and visitdate <= '1974-09-19' AND\n  countrycode in ( 'BIH','FRA','URY','BIH','CAN','CHN','NIC','PRT','AUT','NIC') AND\n  languagecode in ( 'BIH-SR','FRA-FR','URY-ES','BIH-SR','CAN-EN','CHN-ZH','NIC-ES','PRT-PT','AUT-DE','NIC-ES') AND\n  useragent in ( 'Vpypjqvkyxkgdewa/6.5','Byieodb/.8','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Eqhrdyuk/2.5','Eqhrdyuk/2.5','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)','Kktxapwqhcqdlgccr/2.0','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_30",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '2011-08-10' and visitdate <= '2011-09-09' AND\n  countrycode in ( 'SDN','MNE','ESP','MNE','FRA','VNM','LBN','IRL','SGP','EGY') AND\n  languagecode in ( 'SDN-AR','MNE-SR','ESP-ES','MNE-SR','FRA-FR','VNM-VI','LBN-AR','IRL-EN','SGP-EN','EGY-AR') AND\n  useragent in ( 'foanyrgdaivuwwdl/7.5','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Neucvyephalss/4.6','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/5.0 (Windows; U; Windows NT 5.2)AppleWebKit/525.13 (KHTML like Gecko) Version/3.1Safari/525.13','Omnbvmfdnpwot/6.4')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_31",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '2004-09-21' and visitdate <= '2004-10-21' AND\n  countrycode in ( 'BEL','LBY','FRA','DNK','SWE','FRA','KOR','SWE','SGP','FRA') AND\n  languagecode in ( 'BEL-NL','LBY-AR','FRA-FR','DNK-DA','SWE-SV','FRA-FR','KOR-KO','SWE-SV','SGP-EN','FRA-FR') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Ivonskpkadxxrwrufogcrda/4.3','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Emhtat/8.3','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)','Wotyydewrkaykqhixlv/3.1','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Opera 7.5 (Win ME): Opera/7.50 (Windows ME; U)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_32",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1976-10-05' and visitdate <= '1976-11-04' AND\n  countrycode in ( 'ESP','LBN','BGR','BOL','MYS','DNK','GRC','NZL','IRL','DEU') AND\n  languagecode in ( 'ESP-ES','LBN-AR','BGR-BG','BOL-ES','MYS-MS','DNK-DA','GRC-DE','NZL-EN','IRL-EN','DEU-DE') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 5.5; Windows NT 5.0)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Lhfsenadvphskmjsbtfcju/4.4','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Opera 8.0 (Win 2000): Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; en) Opera 8.0')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_33",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1970-04-04' and visitdate <= '1970-05-04' AND\n  countrycode in ( 'VNM','IRQ','LUX','PHL','PRT','SVK','CRI','ESP','BEL','KWT') AND\n  languagecode in ( 'VNM-VI','IRQ-AR','LUX-FR','PHL-EN','PRT-PT','SVK-SK','CRI-ES','ESP-ES','BEL-NL','KWT-AR') AND\n  useragent in ( 'Obgoxufsw/0.8','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Dxborqxdbr/7.0','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Eiqherhnewefphcjebtwejag/.0','Digklmmj/.','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_34",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1974-07-09' and visitdate <= '1974-08-08' AND\n  countrycode in ( 'LUX','BLR','TUN','IND','DEU','SVN','PRI','QAT','CHL','ITA') AND\n  languagecode in ( 'LUX-FR','BLR-BE','TUN-AR','IND-EN','DEU-DE','SVN-SL','PRI-ES','QAT-AR','CHL-ES','ITA-IT') AND\n  useragent in ( 'Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Rkaaarfsnyewg/1.1','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Netscape 4.8 ( Win XP): Mozilla/4.8 (Windows NT 5.1; U)','Mozilla/5.0 (Windows; U; Windows NT 5.2)AppleWebKit/525.13 (KHTML like Gecko) Version/3.1Safari/525.13','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_35",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1999-05-27' and visitdate <= '1999-06-26' AND\n  countrycode in ( 'IRQ','SVN','NIC','PER','VEN','SGP','QAT','KWT','THA','LBN') AND\n  languagecode in ( 'IRQ-AR','SVN-SL','NIC-ES','PER-ES','VEN-ES','SGP-ZH','QAT-AR','KWT-AR','THA-TH','LBN-AR') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Ddedxers/3.','Ghyxilqag/.5','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Fniavrlansiud/4.3','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Rduhvjqfxph/1.7')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_36",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1984-05-15' and visitdate <= '1984-06-14' AND\n  countrycode in ( 'BLR','HUN','BOL','ITA','SWE','SAU','SGP','CYP','JPN','CZE') AND\n  languagecode in ( 'BLR-BE','HUN-HU','BOL-ES','ITA-IT','SWE-SV','SAU-AR','SGP-EN','CYP-EL','JPN-JA','CZE-CS') AND\n  useragent in ( 'Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Rwnucdjttoqun/0.5','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Opera 9.2 (Windows Vista): Opera/9.20 (Windows NT 6.0; U; en)','Wfrycqubs/.','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Fshderpgt/5.3','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_37",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1981-08-10' and visitdate <= '1981-09-09' AND\n  countrycode in ( 'CAN','SAU','SYR','JOR','MNE','EGY','BLR','HUN','SDN','MKD') AND\n  languagecode in ( 'CAN-EN','SAU-AR','SYR-AR','JOR-AR','MNE-SR','EGY-AR','BLR-BE','HUN-HU','SDN-AR','MKD-MK') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/0.2.149.27 Safari/525.13','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/5.0 (Windows; U; Windows NT 5.2)AppleWebKit/525.13 (KHTML like Gecko) Version/3.1Safari/525.13')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_38",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1973-12-29' and visitdate <= '1974-01-28' AND\n  countrycode in ( 'TUR','HRV','LBN','UKR','CHN','CUB','CAN','CHE','SVN','IND') AND\n  languagecode in ( 'TUR-TR','HRV-HR','LBN-AR','UKR-UK','CHN-ZH','CUB-ES','CAN-EN','CHE-FR','SVN-SL','IND-EN') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Mozilla/5.0 (Windows; U; Windows NT 5.1)Gecko/20070803 Firefox/1.5.0.12','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_39",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1997-10-03' and visitdate <= '1997-11-02' AND\n  countrycode in ( 'CZE','IDN','DOM','URY','SDN','LTU','PER','BEL','ESP','GRC') AND\n  languagecode in ( 'CZE-CS','IDN-IN','DOM-ES','URY-ES','SDN-AR','LTU-LT','PER-ES','BEL-FR','ESP-CA','GRC-DE') AND\n  useragent in ( 'Mozilla/5.0 (Windows; U; Windows NT 5.1)Gecko/20070309 Firefox/2.0.0.3','Unhxbj/2.7','Psckqmnjdhtothstkq/3.2','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)','Ggcqgyhyomatenkijkv/2.3')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_40",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1988-06-20' and visitdate <= '1988-07-20' AND\n  countrycode in ( 'SYR','HRV','HRV','CHL','USA','PHL','POL','SRB','DNK','BEL') AND\n  languagecode in ( 'SYR-AR','HRV-HR','HRV-HR','CHL-ES','USA-ES','PHL-EN','POL-PL','SRB-SR','DNK-DA','BEL-FR') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 5.5; Windows NT 5.0)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Opera 7.5 (Win XP): Opera/7.50 (Windows XP; U)','wyhtshf/6.5','Netscape 4.8 (Windows Vista): Mozilla/4.8 (Windows NT 6.0; U)','Fslqhyqnvk/6.2','Repjupttr/8.2','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Junmvgvv/8.6')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_41",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1971-11-07' and visitdate <= '1971-12-07' AND\n  countrycode in ( 'SYR','CHN','BEL','HRV','TUR','NZL','BOL','MNE','PHL','BEL') AND\n  languagecode in ( 'SYR-AR','CHN-ZH','BEL-FR','HRV-HR','TUR-TR','NZL-EN','BOL-ES','MNE-SR','PHL-EN','BEL-FR') AND\n  useragent in ( 'Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)','Jkvjhf/.8','Mozilla/5.0 (Windows; U; Windows NT 5.2)Gecko/2008070208 Firefox/3.0.1','Vuiauymhnsj/4.8','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_42",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1999-03-04' and visitdate <= '1999-04-03' AND\n  countrycode in ( 'CYP','DZA','IND','KWT','PRY','SLV','VNM','SVN','FIN','BEL') AND\n  languagecode in ( 'CYP-EL','DZA-AR','IND-EN','KWT-AR','PRY-ES','SLV-ES','VNM-VI','SVN-SL','FIN-FI','BEL-FR') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Myqndkbkkj/6.7','Opera 7.51 (Win XP): Opera/7.51 (Windows NT 5.1; U)','Owftixkw/4.5','Mozilla/4.0 (compatible; MSIE 5.5; Windows 98; Win 9x 4.90)','Rybfynxwogbasxdxgb/.3')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_43",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1995-08-11' and visitdate <= '1995-09-10' AND\n  countrycode in ( 'VEN','MLT','TUR','GRC','BIH','ESP','NLD','ARG','KWT','CHN') AND\n  languagecode in ( 'VEN-ES','MLT-MT','TUR-TR','GRC-DE','BIH-SR','ESP-CA','NLD-NL','ARG-ES','KWT-AR','CHN-ZH') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Fmvykflwsvmnrxalexbck/2.0','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Mozilla/5.0 (Windows; U; Windows NT 5.1)Gecko/20070309 Firefox/2.0.0.3','Osycesvyiqmmxatapp/8.8','Fqlqngcumaouhfb/0.1')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_44",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1992-04-23' and visitdate <= '1992-05-23' AND\n  countrycode in ( 'HKG','HND','BGR','SRB','IRL','GRC','FIN','TUR','ARG','EST') AND\n  languagecode in ( 'HKG-ZH','HND-ES','BGR-BG','SRB-SR','IRL-EN','GRC-DE','FIN-FI','TUR-TR','ARG-ES','EST-ET') AND\n  useragent in ( 'Mozilla/5.0 (Windows; U; Windows NT 5.2)AppleWebKit/525.13 (KHTML like Gecko) Version/3.1Safari/525.13','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Vimxvatn/7.6','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Opera 9.2 (Windows Vista): Opera/9.20 (Windows NT 6.0; U; en)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Yriktutuljpik/0.6','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','iPhone 3.0: Mozilla/5.0 (iPhone; U; CPU iPhone OS 3_0 like Mac OS X; en-us) AppleWebKit/528.18 (KHTML like Gecko) Version/4.0 Mobile/7A341 Safari/528.16')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_45",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1990-12-30' and visitdate <= '1991-01-29' AND\n  countrycode in ( 'ARE','SLV','BIH','SRB','CRI','CAN','CAN','LTU','DEU','LTU') AND\n  languagecode in ( 'ARE-AR','SLV-ES','BIH-SR','SRB-SR','CRI-ES','CAN-EN','CAN-EN','LTU-LT','DEU-DE','LTU-LT') AND\n  useragent in ( 'Mozilla/5.0 (Windows; U; Windows NT 5.2)AppleWebKit/525.13 (KHTML like Gecko) Version/3.1Safari/525.13','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Dhgncd/7.3','Tiynwwkmqwrlapjltncqlc/4.1','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Netscape 4.8 (Windows Vista): Mozilla/4.8 (Windows NT 6.0; U)','Ivotobeiu/4.6','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)','Andff/1.')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_46",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '2004-02-28' and visitdate <= '2004-03-29' AND\n  countrycode in ( 'PRT','LBY','BIH','CAN','PER','THA','CHE','NLD','MNE','EGY') AND\n  languagecode in ( 'PRT-PT','LBY-AR','BIH-SR','CAN-EN','PER-ES','THA-TH','CHE-IT','NLD-NL','MNE-SR','EGY-AR') AND\n  useragent in ( 'Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Opera/8.0 (Macintosh; PPC Mac OS X; U; en)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/4.0 (compatible; MSIE 5.5; Windows 98; Win 9x 4.90)','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Eewdrwigtcealgcycfhkpqc/.5','Wgwcjkywsskbgolcqr/0.0')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_47",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1976-07-01' and visitdate <= '1976-07-31' AND\n  countrycode in ( 'ISR','NZL','CHE','CHN','SRB','CUB','JPN','LUX','JPN','ARE') AND\n  languagecode in ( 'ISR-IW','NZL-EN','CHE-DE','CHN-ZH','SRB-SR','CUB-ES','JPN-JA','LUX-DE','JPN-JA','ARE-AR') AND\n  useragent in ( 'Vuiauymhnsj/4.8','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Xhbuxkqgqt/3.0','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Jvagmljdmukrkvjeh/.4','Hjvinbgnr/0.1','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Fshderpgt/5.3')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_48",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '2004-08-20' and visitdate <= '2004-09-19' AND\n  countrycode in ( 'CRI','SRB','SGP','CUB','HUN','ROU','TWN','DZA','COL','BEL') AND\n  languagecode in ( 'CRI-ES','SRB-SR','SGP-ZH','CUB-ES','HUN-HU','ROU-RO','TWN-ZH','DZA-AR','COL-ES','BEL-NL') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 5.5; Windows 98; Win 9x 4.90)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Pxnaggayiyrx/2.8','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Vucpnoujfmayqhqonvcivmub/2.7','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Ghyeglvqtgg/8.3','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/0.2.149.27 Safari/525.13')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_49",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1990-05-28' and visitdate <= '1990-06-27' AND\n  countrycode in ( 'ARE','ARG','PAN','LTU','OMN','BIH','GRC','IND','CHN','BGR') AND\n  languagecode in ( 'ARE-AR','ARG-ES','PAN-ES','LTU-LT','OMN-AR','BIH-SR','GRC-DE','IND-EN','CHN-ZH','BGR-BG') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Kdifmfpilxi/6.1','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/0.2.149.27 Safari/525.13','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_50",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1988-10-20' and visitdate <= '1988-11-19' AND\n  countrycode in ( 'MKD','CAN','SYR','COL','SWE','LUX','QAT','USA','LUX','BHR') AND\n  languagecode in ( 'MKD-MK','CAN-EN','SYR-AR','COL-ES','SWE-SV','LUX-FR','QAT-AR','USA-EN','LUX-DE','BHR-AR') AND\n  useragent in ( 'Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Rdcukq/1.2','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mgedvctacrt/2.4','Jpmaraidpgcapnhncpm/5.4','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_51",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1980-10-07' and visitdate <= '1980-11-06' AND\n  countrycode in ( 'ARE','COL','IND','PRT','BIH','JOR','HUN','BRA','LTU','EST') AND\n  languagecode in ( 'ARE-AR','COL-ES','IND-HI','PRT-PT','BIH-SR','JOR-AR','HUN-HU','BRA-PT','LTU-LT','EST-ET') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Vhinbpoveodvxhqknprpeh/2.','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Dcnytmsaeg/5.7','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Nabnljvnlndvcecwjiusht/6.6','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_52",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1991-05-19' and visitdate <= '1991-06-18' AND\n  countrycode in ( 'SDN','LBY','NZL','ALB','NZL','JPN','SVN','IND','PER','HUN') AND\n  languagecode in ( 'SDN-AR','LBY-AR','NZL-EN','ALB-SQ','NZL-EN','JPN-JA','SVN-SL','IND-HI','PER-ES','HUN-HU') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','vmcdde/5.0','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Ewgvbowcn/3.3','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/5.0 (Windows; U; Windows NT 5.2)AppleWebKit/525.13 (KHTML like Gecko) Version/3.1Safari/525.13','Enqwfsvelyckynf/.4')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_53",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1998-05-12' and visitdate <= '1998-06-11' AND\n  countrycode in ( 'MYS','CHL','PRI','SRB','PER','BIH','KWT','CHE','IND','LVA') AND\n  languagecode in ( 'MYS-MS','CHL-ES','PRI-ES','SRB-SR','PER-ES','BIH-SR','KWT-AR','CHE-FR','IND-EN','LVA-LV') AND\n  useragent in ( 'Netscape 4.8 ( Win XP): Mozilla/4.8 (Windows NT 5.1; U)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/5.0 (Windows; U; Windows NT 5.2)AppleWebKit/525.13 (KHTML like Gecko) Version/3.1Safari/525.13','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.12)Gecko/20080219 Firefox/2.0.0.12\tNavigator/9.0.0.6','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/5.0 (Windows; U; Windows NT 5.2)Gecko/2008070208 Firefox/3.0.1','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_54",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '2007-03-11' and visitdate <= '2007-04-10' AND\n  countrycode in ( 'HUN','ALB','HUN','CUB','PAN','POL','IRL','BOL','ARE','POL') AND\n  languagecode in ( 'HUN-HU','ALB-SQ','HUN-HU','CUB-ES','PAN-ES','POL-PL','IRL-EN','BOL-ES','ARE-AR','POL-PL') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/4.0 (compatible; MSIE 5.5; Windows NT 5.0)','Mozilla/4.0 (compatible; MSIE 5.5; Windows 98; Win 9x 4.90)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/5.0 (Windows; U; Windows NT 5.2)AppleWebKit/525.13 (KHTML like Gecko) Version/3.1Safari/525.13','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Yhlyfjggrubihj/8.5','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Ohmrohtutaipeuxdyvkc/7.1')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_55",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '2010-02-20' and visitdate <= '2010-03-22' AND\n  countrycode in ( 'CAN','SVN','QAT','BEL','BIH','KOR','LUX','BGR','ALB','CHL') AND\n  languagecode in ( 'CAN-EN','SVN-SL','QAT-AR','BEL-FR','BIH-SR','KOR-KO','LUX-FR','BGR-BG','ALB-SQ','CHL-ES') AND\n  useragent in ( 'ksygni/6.6','Omnbvmfdnpwot/6.4','Mozilla/5.0 (Windows; U; Windows NT 5.1)Gecko/20070309 Firefox/2.0.0.3','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Ciwoefamxdtowosunnjq/1.1')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_56",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1988-12-07' and visitdate <= '1989-01-06' AND\n  countrycode in ( 'PAN','BLR','AUS','CZE','TUN','CAN','IRQ','ROU','HUN','CRI') AND\n  languagecode in ( 'PAN-ES','BLR-BE','AUS-EN','CZE-CS','TUN-AR','CAN-FR','IRQ-AR','ROU-RO','HUN-HU','CRI-ES') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/5.0 (Macintosh; U; PPC Mac OS X; en) AppleWebKit/125.2 (KHTML like Gecko) Safari/125.8','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/5.0 (Windows; U; Windows NT 5.2)AppleWebKit/525.13 (KHTML like Gecko) Version/3.1Safari/525.13','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_57",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1974-12-28' and visitdate <= '1975-01-27' AND\n  countrycode in ( 'KWT','LUX','IDN','GRC','CHE','DOM','IND','CHE','CYP','SWE') AND\n  languagecode in ( 'KWT-AR','LUX-FR','IDN-IN','GRC-DE','CHE-DE','DOM-ES','IND-EN','CHE-IT','CYP-EL','SWE-SV') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','eugeuwguxmfmpdmofvfnhpo/2.6','Vfnpxwd/0.','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Netscape 2.02 (Win 95): Mozilla/2.02E (Win95; U)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Rdcukq/1.2')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_58",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1981-02-14' and visitdate <= '1981-03-16' AND\n  countrycode in ( 'LBY','DOM','FIN','JOR','OMN','HRV','HUN','POL','TWN','MLT') AND\n  languagecode in ( 'LBY-AR','DOM-ES','FIN-FI','JOR-AR','OMN-AR','HRV-HR','HUN-HU','POL-PL','TWN-ZH','MLT-MT') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Wgwcjkywsskbgolcqr/0.0','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Dpenxtmcxbwl/3.','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','iPhone 3.0: Mozilla/5.0 (iPhone; U; CPU iPhone OS 3_0 like Mac OS X; en-us) AppleWebKit/528.18 (KHTML like Gecko) Version/4.0 Mobile/7A341 Safari/528.16','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_59",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1997-09-25' and visitdate <= '1997-10-25' AND\n  countrycode in ( 'IRL','OMN','SWE','IRL','ITA','PER','ISL','LBN','CHE','ARG') AND\n  languagecode in ( 'IRL-EN','OMN-AR','SWE-SV','IRL-GA','ITA-IT','PER-ES','ISL-IS','LBN-AR','CHE-FR','ARG-ES') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Eftqbqhd/1.8','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Oqjctbod/8.7','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Cuambpfuelhbxjto/.3','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Dyhoiswt/6.2')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_60",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1984-03-06' and visitdate <= '1984-04-05' AND\n  countrycode in ( 'CUB','LUX','NOR','FRA','BEL','CAN','MNE','CYP','DOM','OMN') AND\n  languagecode in ( 'CUB-ES','LUX-DE','NOR-NO','FRA-FR','BEL-NL','CAN-EN','MNE-SR','CYP-EL','DOM-ES','OMN-AR') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Opera/8.0 (Macintosh; PPC Mac OS X; U; en)','Prmrltyaijjvcru/0.5','yaqlmqsdrriehttwinrue/5.','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Jgniucngrcvqqqec/5.0','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_61",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1981-05-29' and visitdate <= '1981-06-28' AND\n  countrycode in ( 'QAT','HKG','COL','SAU','IRQ','CUB','PER','MAR','ARE','NOR') AND\n  languagecode in ( 'QAT-AR','HKG-ZH','COL-ES','SAU-AR','IRQ-AR','CUB-ES','PER-ES','MAR-AR','ARE-AR','NOR-NO') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Opera 8.0 (Win 2000): Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; en) Opera 8.0','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)','Ylmyqaqyosxfexu/6.6','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_62",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1984-11-04' and visitdate <= '1984-12-04' AND\n  countrycode in ( 'MLT','USA','IDN','GRC','NZL','SAU','ECU','EST','MLT','AUT') AND\n  languagecode in ( 'MLT-EN','USA-EN','IDN-IN','GRC-DE','NZL-EN','SAU-AR','ECU-ES','EST-ET','MLT-MT','AUT-DE') AND\n  useragent in ( 'Bmvqsqq/8.5','Mozilla/5.0 (Windows; U; Windows NT 5.2)AppleWebKit/525.13 (KHTML like Gecko) Version/3.1Safari/525.13','Ptkpycangi/6.','Evqcomhopmoka/8.1','Xhbuxkqgqt/3.0','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/0.2.149.27 Safari/525.13','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mqbdifdyhdej/8.3')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_63",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '2001-07-19' and visitdate <= '2001-08-18' AND\n  countrycode in ( 'ROU','RUS','LTU','GRC','BRA','BRA','IRL','DZA','LVA','RUS') AND\n  languagecode in ( 'ROU-RO','RUS-RU','LTU-LT','GRC-EL','BRA-PT','BRA-PT','IRL-GA','DZA-AR','LVA-LV','RUS-RU') AND\n  useragent in ( 'Kxplpor/.2','Hrntviklfmvmet/8.3','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Mozilla/5.0 (Windows; U; Windows NT 5.1)Gecko/20070309 Firefox/2.0.0.3','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/0.2.149.27 Safari/525.13','Mozilla/5.0 (Macintosh; U; PPC Mac OS X; en) AppleWebKit/125.2 (KHTML like Gecko) Safari/125.8','Cxhgyxv/8.3','Ifgouvjqjkeuv/2.7','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_64",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1986-01-26' and visitdate <= '1986-02-25' AND\n  countrycode in ( 'ESP','PAN','ALB','HND','RUS','LUX','ARG','HRV','SWE','ISL') AND\n  languagecode in ( 'ESP-CA','PAN-ES','ALB-SQ','HND-ES','RUS-RU','LUX-DE','ARG-ES','HRV-HR','SWE-SV','ISL-IS') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Qhyixpjfxxbqpxdkcg/5.8','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Mozilla/5.0 (Windows; U; Windows NT 5.2)AppleWebKit/525.13 (KHTML like Gecko) Version/3.1Safari/525.13','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Ivotobeiu/4.6','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Vqltqxboq/7.8','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_65",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1995-04-30' and visitdate <= '1995-05-30' AND\n  countrycode in ( 'LBY','ISR','THA','MKD','TUR','SGP','URY','LUX','ISR','NOR') AND\n  languagecode in ( 'LBY-AR','ISR-IW','THA-TH','MKD-MK','TUR-TR','SGP-EN','URY-ES','LUX-FR','ISR-IW','NOR-NO') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Cxhgyxv/8.3','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Xhfcjrsrqiaooibqcgvj/8.2','Yyggxmojmceejvxgxbj/2.','Hkoapycexpqhvtkonf/.3','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Kmtjvv/7.7','Mozilla/5.0 (Windows; U; Windows NT 5.2)AppleWebKit/525.13 (KHTML like Gecko) Version/3.1Safari/525.13','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_66",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '2009-03-15' and visitdate <= '2009-04-14' AND\n  countrycode in ( 'POL','MNE','THA','SRB','DZA','ROU','JPN','SWE','CHE','ALB') AND\n  languagecode in ( 'POL-PL','MNE-SR','THA-TH','SRB-SR','DZA-AR','ROU-RO','JPN-JA','SWE-SV','CHE-FR','ALB-SQ') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Sfbaumnwmdqpwubyc/5.6','Mozilla/4.0 (compatible; MSIE 5.5; Windows NT 5.0)','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Pqxwsiromxhqjtadb/6.2','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_67",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1997-04-11' and visitdate <= '1997-05-11' AND\n  countrycode in ( 'POL','JPN','NOR','LBN','ESP','PRY','ITA','PRT','OMN','DEU') AND\n  languagecode in ( 'POL-PL','JPN-JA','NOR-NO','LBN-AR','ESP-CA','PRY-ES','ITA-IT','PRT-PT','OMN-AR','DEU-DE') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Isjtwro/4.8','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Gsqpmysu/.4','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Mozilla/5.0 (Windows; U; Windows NT 5.1)Gecko/20070309 Firefox/2.0.0.3','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Meielti/0.1','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_68",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '2006-11-30' and visitdate <= '2006-12-30' AND\n  countrycode in ( 'CHL','PRI','MNE','GRC','QAT','TUR','ISR','IDN','ITA','LBY') AND\n  languagecode in ( 'CHL-ES','PRI-ES','MNE-SR','GRC-DE','QAT-AR','TUR-TR','ISR-IW','IDN-IN','ITA-IT','LBY-AR') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 5.5; Windows 98; Win 9x 4.90)','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Isjtwro/4.8','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_69",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1985-04-05' and visitdate <= '1985-05-05' AND\n  countrycode in ( 'LVA','ARG','MLT','LTU','AUT','CAN','CAN','DOM','QAT','IND') AND\n  languagecode in ( 'LVA-LV','ARG-ES','MLT-MT','LTU-LT','AUT-DE','CAN-FR','CAN-EN','DOM-ES','QAT-AR','IND-EN') AND\n  useragent in ( 'Pgpvkbuiovyvmny/3.7','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Wgwcjkywsskbgolcqr/0.0','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_70",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '2000-06-19' and visitdate <= '2000-07-19' AND\n  countrycode in ( 'HND','JPN','PRT','ZAF','SVK','NOR','DOM','DZA','SGP','NIC') AND\n  languagecode in ( 'HND-ES','JPN-JA','PRT-PT','ZAF-EN','SVK-SK','NOR-NO','DOM-ES','DZA-AR','SGP-EN','NIC-ES') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Jwxnumfhoipkiopp/0.4','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Spdhcxfunjqsavhnoqltgpkd/3.3')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_71",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1994-07-19' and visitdate <= '1994-08-18' AND\n  countrycode in ( 'PRI','CHE','YEM','TUN','DNK','CHE','BOL','CAN','BEL','LBN') AND\n  languagecode in ( 'PRI-ES','CHE-FR','YEM-AR','TUN-AR','DNK-DA','CHE-FR','BOL-ES','CAN-FR','BEL-FR','LBN-AR') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Opera 8.0 (Win 2000): Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; en) Opera 8.0','Opera 7.5 (Win ME): Opera/7.50 (Windows ME; U)','Mozilla/5.0 (Windows; U; Windows NT 5.1)Gecko/20070309 Firefox/2.0.0.3','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Xnvpxirvrsdpdmsxac/0.2','Vimxvatn/7.6','Nprcyccg/3.4','Mozilla/5.0 (Windows; U; Windows NT 5.1)Gecko/20070803 Firefox/1.5.0.12')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_72",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1996-12-08' and visitdate <= '1997-01-07' AND\n  countrycode in ( 'HRV','YEM','LUX','SDN','MNE','SGP','CUB','ITA','SVN','ISL') AND\n  languagecode in ( 'HRV-HR','YEM-AR','LUX-FR','SDN-AR','MNE-SR','SGP-EN','CUB-ES','ITA-IT','SVN-SL','ISL-IS') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','lhrkuu/3.8','Mozilla/5.0 (Windows; U; Windows NT 5.2)AppleWebKit/525.13 (KHTML like Gecko) Version/3.1Safari/525.13','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Xhfcjrsrqiaooibqcgvj/8.2')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_73",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1996-01-19' and visitdate <= '1996-02-18' AND\n  countrycode in ( 'BIH','ITA','CHE','ESP','BEL','TUN','TWN','GRC','BHR','RUS') AND\n  languagecode in ( 'BIH-SR','ITA-IT','CHE-FR','ESP-CA','BEL-NL','TUN-AR','TWN-ZH','GRC-EL','BHR-AR','RUS-RU') AND\n  useragent in ( 'Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/0.2.149.27 Safari/525.13','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','iPhone 3.0: Mozilla/5.0 (iPhone; U; CPU iPhone OS 3_0 like Mac OS X; en-us) AppleWebKit/528.18 (KHTML like Gecko) Version/4.0 Mobile/7A341 Safari/528.16','Tvtatibewm/5.8','Atagnbypfdgih/8.0','Yyggxmojmceejvxgxbj/2.','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_74",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1995-09-03' and visitdate <= '1995-10-03' AND\n  countrycode in ( 'HKG','GRC','ALB','SRB','BIH','BHR','PRI','CHE','MEX','MEX') AND\n  languagecode in ( 'HKG-ZH','GRC-DE','ALB-SQ','SRB-SR','BIH-SR','BHR-AR','PRI-ES','CHE-FR','MEX-ES','MEX-ES') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Ymelbhayxujjfihmlu/0.2','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/5.0 (Windows; U; Windows NT 5.2)Gecko/2008070208 Firefox/3.0.1','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_75",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1988-04-28' and visitdate <= '1988-05-28' AND\n  countrycode in ( 'BRA','ESP','DZA','KWT','SGP','LUX','ISR','LBY','PAN','LBN') AND\n  languagecode in ( 'BRA-PT','ESP-ES','DZA-AR','KWT-AR','SGP-EN','LUX-DE','ISR-IW','LBY-AR','PAN-ES','LBN-AR') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Mxgucerowpqypgfnakpu/5.1','Ydftsuvesljlahlikxodyhqf/5.6','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Ruplyqtgdijucrxloqelb/7.4','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_76",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '2001-11-22' and visitdate <= '2001-12-22' AND\n  countrycode in ( 'THA','ROU','TWN','PRT','ARE','BLR','NZL','PRT','QAT','JPN') AND\n  languagecode in ( 'THA-TH','ROU-RO','TWN-ZH','PRT-PT','ARE-AR','BLR-BE','NZL-EN','PRT-PT','QAT-AR','JPN-JA') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/5.0 (Windows; U; Windows NT 5.2)AppleWebKit/525.13 (KHTML like Gecko) Version/3.1Safari/525.13','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Ifoygk/.3','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_77",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1999-10-09' and visitdate <= '1999-11-08' AND\n  countrycode in ( 'CHE','IND','SVN','SYR','SAU','CHE','ITA','LUX','BHR','TWN') AND\n  languagecode in ( 'CHE-FR','IND-EN','SVN-SL','SYR-AR','SAU-AR','CHE-FR','ITA-IT','LUX-FR','BHR-AR','TWN-ZH') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Emusdcih/3.5','Netscape 2.02 (Win 95): Mozilla/2.02E (Win95; U)','Opera 8.0 (Win 2000): Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; en) Opera 8.0','Opera/8.0 (Macintosh; PPC Mac OS X; U; en)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_78",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1992-01-23' and visitdate <= '1992-02-22' AND\n  countrycode in ( 'LUX','ISL','PRY','JPN','PHL','IRQ','GRC','CYP','BIH','BGR') AND\n  languagecode in ( 'LUX-DE','ISL-IS','PRY-ES','JPN-JA','PHL-EN','IRQ-AR','GRC-DE','CYP-EL','BIH-SR','BGR-BG') AND\n  useragent in ( 'Eythmwkjwjkauihmgsy/7.4','Gsqpmysu/.4','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Netscape 4.8 ( Win XP): Mozilla/4.8 (Windows NT 5.1; U)','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_79",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '2006-04-07' and visitdate <= '2006-05-07' AND\n  countrycode in ( 'LVA','TWN','CAN','LBY','JOR','IRQ','IDN','ECU','LUX','SAU') AND\n  languagecode in ( 'LVA-LV','TWN-ZH','CAN-FR','LBY-AR','JOR-AR','IRQ-AR','IDN-IN','ECU-ES','LUX-DE','SAU-AR') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Netscape 4.8 (Windows Vista): Mozilla/4.8 (Windows NT 6.0; U)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Shfmmabgxpb/0.8','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_80",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '2003-04-16' and visitdate <= '2003-05-16' AND\n  countrycode in ( 'VNM','PRT','DZA','CHN','PRT','CAN','CUB','HKG','CRI','CAN') AND\n  languagecode in ( 'VNM-VI','PRT-PT','DZA-AR','CHN-ZH','PRT-PT','CAN-EN','CUB-ES','HKG-ZH','CRI-ES','CAN-EN') AND\n  useragent in ( 'Yyggxmojmceejvxgxbj/2.','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Netscape 4.8 (Windows Vista): Mozilla/4.8 (Windows NT 6.0; U)','Lmhslgpxsteitodnrd/0.6','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q13_1",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'DOM'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-06-16'::DATE and '1974-07-16'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') AND uservisits.searchword IN ('hmtbpohouiv') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-06-16'::DATE and '1974-07-16'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') AND uservisits.searchword IN ('hmtbpohouiv') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-06-16'::DATE and '1974-07-16'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') \n                    AND uservisits.searchword IN ('hmtbpohouiv') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-06-16'::DATE and '1974-07-16'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-08-16'::DATE and '1974-09-16'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-11-16'::DATE and '1974-12-16'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-11-16'::DATE and '1974-12-16'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-11-16'::DATE and '1974-12-16'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-11-16'::DATE and '1974-12-16'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-11-16'::DATE and '1974-12-16'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-11-16'::DATE and '1974-12-16'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_2",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'TUR'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-10-06'::DATE and '1986-11-06'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') AND uservisits.searchword IN ('xgxcdplbwtpmxj') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-10-06'::DATE and '1986-11-06'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') AND uservisits.searchword IN ('xgxcdplbwtpmxj') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-10-06'::DATE and '1986-11-06'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') \n                    AND uservisits.searchword IN ('xgxcdplbwtpmxj') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-10-06'::DATE and '1986-11-06'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-12-06'::DATE and '1987-01-06'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1987-03-06'::DATE and '1987-04-06'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1987-03-06'::DATE and '1987-04-06'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1987-03-06'::DATE and '1987-04-06'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1987-03-06'::DATE and '1987-04-06'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1987-03-06'::DATE and '1987-04-06'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1987-03-06'::DATE and '1987-04-06'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_3",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'MAR'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1996-02-03'::DATE and '1996-03-03'::DATE AND\n                    uservisits.countrycode IN ('MAR','URY','MKD') AND uservisits.searchword IN ('jkkmtex') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1996-02-03'::DATE and '1996-03-03'::DATE AND\n                    uservisits.countrycode IN ('MAR','URY','MKD') AND uservisits.searchword IN ('jkkmtex') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1996-02-03'::DATE and '1996-03-03'::DATE AND\n                    uservisits.countrycode IN ('MAR','URY','MKD') \n                    AND uservisits.searchword IN ('jkkmtex') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1996-02-03'::DATE and '1996-03-03'::DATE AND\n                    uservisits.countrycode IN ('MAR','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1996-04-03'::DATE and '1996-05-03'::DATE AND\n                    uservisits.countrycode IN ('MAR','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1996-07-03'::DATE and '1996-08-03'::DATE AND\n                    uservisits.countrycode IN ('MAR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1996-07-03'::DATE and '1996-08-03'::DATE AND\n                    uservisits.countrycode IN ('MAR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1996-07-03'::DATE and '1996-08-03'::DATE AND\n                    uservisits.countrycode IN ('MAR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1996-07-03'::DATE and '1996-08-03'::DATE AND\n                    uservisits.countrycode IN ('MAR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1996-07-03'::DATE and '1996-08-03'::DATE AND\n                    uservisits.countrycode IN ('MAR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1996-07-03'::DATE and '1996-08-03'::DATE AND\n                    uservisits.countrycode IN ('MAR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_4",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'LBY'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2006-10-27'::DATE and '2006-11-27'::DATE AND\n                    uservisits.countrycode IN ('LBY','URY','MKD') AND uservisits.searchword IN ('ncovkppmmngd') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2006-10-27'::DATE and '2006-11-27'::DATE AND\n                    uservisits.countrycode IN ('LBY','URY','MKD') AND uservisits.searchword IN ('ncovkppmmngd') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2006-10-27'::DATE and '2006-11-27'::DATE AND\n                    uservisits.countrycode IN ('LBY','URY','MKD') \n                    AND uservisits.searchword IN ('ncovkppmmngd') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2006-10-27'::DATE and '2006-11-27'::DATE AND\n                    uservisits.countrycode IN ('LBY','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2006-12-27'::DATE and '2007-01-27'::DATE AND\n                    uservisits.countrycode IN ('LBY','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2007-03-27'::DATE and '2007-04-27'::DATE AND\n                    uservisits.countrycode IN ('LBY','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2007-03-27'::DATE and '2007-04-27'::DATE AND\n                    uservisits.countrycode IN ('LBY','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2007-03-27'::DATE and '2007-04-27'::DATE AND\n                    uservisits.countrycode IN ('LBY','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2007-03-27'::DATE and '2007-04-27'::DATE AND\n                    uservisits.countrycode IN ('LBY','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2007-03-27'::DATE and '2007-04-27'::DATE AND\n                    uservisits.countrycode IN ('LBY','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2007-03-27'::DATE and '2007-04-27'::DATE AND\n                    uservisits.countrycode IN ('LBY','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_5",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'BOL'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1973-01-10'::DATE and '1973-02-10'::DATE AND\n                    uservisits.countrycode IN ('BOL','URY','MKD') AND uservisits.searchword IN ('atsxuhrr') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1973-01-10'::DATE and '1973-02-10'::DATE AND\n                    uservisits.countrycode IN ('BOL','URY','MKD') AND uservisits.searchword IN ('atsxuhrr') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1973-01-10'::DATE and '1973-02-10'::DATE AND\n                    uservisits.countrycode IN ('BOL','URY','MKD') \n                    AND uservisits.searchword IN ('atsxuhrr') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1973-01-10'::DATE and '1973-02-10'::DATE AND\n                    uservisits.countrycode IN ('BOL','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1973-03-10'::DATE and '1973-04-10'::DATE AND\n                    uservisits.countrycode IN ('BOL','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1973-06-10'::DATE and '1973-07-10'::DATE AND\n                    uservisits.countrycode IN ('BOL','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1973-06-10'::DATE and '1973-07-10'::DATE AND\n                    uservisits.countrycode IN ('BOL','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1973-06-10'::DATE and '1973-07-10'::DATE AND\n                    uservisits.countrycode IN ('BOL','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1973-06-10'::DATE and '1973-07-10'::DATE AND\n                    uservisits.countrycode IN ('BOL','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1973-06-10'::DATE and '1973-07-10'::DATE AND\n                    uservisits.countrycode IN ('BOL','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1973-06-10'::DATE and '1973-07-10'::DATE AND\n                    uservisits.countrycode IN ('BOL','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_6",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'CHE'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1985-05-02'::DATE and '1985-06-02'::DATE AND\n                    uservisits.countrycode IN ('CHE','URY','MKD') AND uservisits.searchword IN ('dbqduo') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1985-05-02'::DATE and '1985-06-02'::DATE AND\n                    uservisits.countrycode IN ('CHE','URY','MKD') AND uservisits.searchword IN ('dbqduo') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1985-05-02'::DATE and '1985-06-02'::DATE AND\n                    uservisits.countrycode IN ('CHE','URY','MKD') \n                    AND uservisits.searchword IN ('dbqduo') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1985-05-02'::DATE and '1985-06-02'::DATE AND\n                    uservisits.countrycode IN ('CHE','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1985-07-02'::DATE and '1985-08-02'::DATE AND\n                    uservisits.countrycode IN ('CHE','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1985-10-02'::DATE and '1985-11-02'::DATE AND\n                    uservisits.countrycode IN ('CHE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1985-10-02'::DATE and '1985-11-02'::DATE AND\n                    uservisits.countrycode IN ('CHE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1985-10-02'::DATE and '1985-11-02'::DATE AND\n                    uservisits.countrycode IN ('CHE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1985-10-02'::DATE and '1985-11-02'::DATE AND\n                    uservisits.countrycode IN ('CHE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1985-10-02'::DATE and '1985-11-02'::DATE AND\n                    uservisits.countrycode IN ('CHE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1985-10-02'::DATE and '1985-11-02'::DATE AND\n                    uservisits.countrycode IN ('CHE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_7",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'MNE'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1997-06-23'::DATE and '1997-07-23'::DATE AND\n                    uservisits.countrycode IN ('MNE','URY','MKD') AND uservisits.searchword IN ('qbvbnpxcwtafjtvq') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1997-06-23'::DATE and '1997-07-23'::DATE AND\n                    uservisits.countrycode IN ('MNE','URY','MKD') AND uservisits.searchword IN ('qbvbnpxcwtafjtvq') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1997-06-23'::DATE and '1997-07-23'::DATE AND\n                    uservisits.countrycode IN ('MNE','URY','MKD') \n                    AND uservisits.searchword IN ('qbvbnpxcwtafjtvq') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1997-06-23'::DATE and '1997-07-23'::DATE AND\n                    uservisits.countrycode IN ('MNE','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1997-08-23'::DATE and '1997-09-23'::DATE AND\n                    uservisits.countrycode IN ('MNE','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1997-11-23'::DATE and '1997-12-23'::DATE AND\n                    uservisits.countrycode IN ('MNE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1997-11-23'::DATE and '1997-12-23'::DATE AND\n                    uservisits.countrycode IN ('MNE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1997-11-23'::DATE and '1997-12-23'::DATE AND\n                    uservisits.countrycode IN ('MNE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1997-11-23'::DATE and '1997-12-23'::DATE AND\n                    uservisits.countrycode IN ('MNE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1997-11-23'::DATE and '1997-12-23'::DATE AND\n                    uservisits.countrycode IN ('MNE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1997-11-23'::DATE and '1997-12-23'::DATE AND\n                    uservisits.countrycode IN ('MNE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_8",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'MEX'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2008-03-16'::DATE and '2008-04-16'::DATE AND\n                    uservisits.countrycode IN ('MEX','URY','MKD') AND uservisits.searchword IN ('biguf') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2008-03-16'::DATE and '2008-04-16'::DATE AND\n                    uservisits.countrycode IN ('MEX','URY','MKD') AND uservisits.searchword IN ('biguf') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2008-03-16'::DATE and '2008-04-16'::DATE AND\n                    uservisits.countrycode IN ('MEX','URY','MKD') \n                    AND uservisits.searchword IN ('biguf') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2008-03-16'::DATE and '2008-04-16'::DATE AND\n                    uservisits.countrycode IN ('MEX','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2008-05-16'::DATE and '2008-06-16'::DATE AND\n                    uservisits.countrycode IN ('MEX','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2008-08-16'::DATE and '2008-09-16'::DATE AND\n                    uservisits.countrycode IN ('MEX','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2008-08-16'::DATE and '2008-09-16'::DATE AND\n                    uservisits.countrycode IN ('MEX','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2008-08-16'::DATE and '2008-09-16'::DATE AND\n                    uservisits.countrycode IN ('MEX','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2008-08-16'::DATE and '2008-09-16'::DATE AND\n                    uservisits.countrycode IN ('MEX','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2008-08-16'::DATE and '2008-09-16'::DATE AND\n                    uservisits.countrycode IN ('MEX','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2008-08-16'::DATE and '2008-09-16'::DATE AND\n                    uservisits.countrycode IN ('MEX','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_9",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'DZA'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1971-08-15'::DATE and '1971-09-15'::DATE AND\n                    uservisits.countrycode IN ('DZA','URY','MKD') AND uservisits.searchword IN ('ujfwbhiekb') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1971-08-15'::DATE and '1971-09-15'::DATE AND\n                    uservisits.countrycode IN ('DZA','URY','MKD') AND uservisits.searchword IN ('ujfwbhiekb') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1971-08-15'::DATE and '1971-09-15'::DATE AND\n                    uservisits.countrycode IN ('DZA','URY','MKD') \n                    AND uservisits.searchword IN ('ujfwbhiekb') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1971-08-15'::DATE and '1971-09-15'::DATE AND\n                    uservisits.countrycode IN ('DZA','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1971-10-15'::DATE and '1971-11-15'::DATE AND\n                    uservisits.countrycode IN ('DZA','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1972-01-15'::DATE and '1972-02-15'::DATE AND\n                    uservisits.countrycode IN ('DZA','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1972-01-15'::DATE and '1972-02-15'::DATE AND\n                    uservisits.countrycode IN ('DZA','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1972-01-15'::DATE and '1972-02-15'::DATE AND\n                    uservisits.countrycode IN ('DZA','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1972-01-15'::DATE and '1972-02-15'::DATE AND\n                    uservisits.countrycode IN ('DZA','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1972-01-15'::DATE and '1972-02-15'::DATE AND\n                    uservisits.countrycode IN ('DZA','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1972-01-15'::DATE and '1972-02-15'::DATE AND\n                    uservisits.countrycode IN ('DZA','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_10",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'JPN'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1984-01-06'::DATE and '1984-02-06'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') AND uservisits.searchword IN ('vltotquj') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1984-01-06'::DATE and '1984-02-06'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') AND uservisits.searchword IN ('vltotquj') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1984-01-06'::DATE and '1984-02-06'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') \n                    AND uservisits.searchword IN ('vltotquj') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1984-01-06'::DATE and '1984-02-06'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1984-03-06'::DATE and '1984-04-06'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1984-06-06'::DATE and '1984-07-06'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1984-06-06'::DATE and '1984-07-06'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1984-06-06'::DATE and '1984-07-06'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1984-06-06'::DATE and '1984-07-06'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1984-06-06'::DATE and '1984-07-06'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1984-06-06'::DATE and '1984-07-06'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_11",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'CHL'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1993-04-03'::DATE and '1993-05-03'::DATE AND\n                    uservisits.countrycode IN ('CHL','URY','MKD') AND uservisits.searchword IN ('hljfakltk') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1993-04-03'::DATE and '1993-05-03'::DATE AND\n                    uservisits.countrycode IN ('CHL','URY','MKD') AND uservisits.searchword IN ('hljfakltk') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1993-04-03'::DATE and '1993-05-03'::DATE AND\n                    uservisits.countrycode IN ('CHL','URY','MKD') \n                    AND uservisits.searchword IN ('hljfakltk') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1993-04-03'::DATE and '1993-05-03'::DATE AND\n                    uservisits.countrycode IN ('CHL','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1993-06-03'::DATE and '1993-07-03'::DATE AND\n                    uservisits.countrycode IN ('CHL','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1993-09-03'::DATE and '1993-10-03'::DATE AND\n                    uservisits.countrycode IN ('CHL','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1993-09-03'::DATE and '1993-10-03'::DATE AND\n                    uservisits.countrycode IN ('CHL','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1993-09-03'::DATE and '1993-10-03'::DATE AND\n                    uservisits.countrycode IN ('CHL','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1993-09-03'::DATE and '1993-10-03'::DATE AND\n                    uservisits.countrycode IN ('CHL','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1993-09-03'::DATE and '1993-10-03'::DATE AND\n                    uservisits.countrycode IN ('CHL','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1993-09-03'::DATE and '1993-10-03'::DATE AND\n                    uservisits.countrycode IN ('CHL','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_12",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'RUS'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2004-01-27'::DATE and '2004-02-27'::DATE AND\n                    uservisits.countrycode IN ('RUS','URY','MKD') AND uservisits.searchword IN ('gkrwajtwh') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2004-01-27'::DATE and '2004-02-27'::DATE AND\n                    uservisits.countrycode IN ('RUS','URY','MKD') AND uservisits.searchword IN ('gkrwajtwh') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2004-01-27'::DATE and '2004-02-27'::DATE AND\n                    uservisits.countrycode IN ('RUS','URY','MKD') \n                    AND uservisits.searchword IN ('gkrwajtwh') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2004-01-27'::DATE and '2004-02-27'::DATE AND\n                    uservisits.countrycode IN ('RUS','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2004-03-27'::DATE and '2004-04-27'::DATE AND\n                    uservisits.countrycode IN ('RUS','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2004-06-27'::DATE and '2004-07-27'::DATE AND\n                    uservisits.countrycode IN ('RUS','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2004-06-27'::DATE and '2004-07-27'::DATE AND\n                    uservisits.countrycode IN ('RUS','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2004-06-27'::DATE and '2004-07-27'::DATE AND\n                    uservisits.countrycode IN ('RUS','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2004-06-27'::DATE and '2004-07-27'::DATE AND\n                    uservisits.countrycode IN ('RUS','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2004-06-27'::DATE and '2004-07-27'::DATE AND\n                    uservisits.countrycode IN ('RUS','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2004-06-27'::DATE and '2004-07-27'::DATE AND\n                    uservisits.countrycode IN ('RUS','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_13",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'JPN'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1970-03-11'::DATE and '1970-04-11'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') AND uservisits.searchword IN ('fivhunjqcohfrvatu') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1970-03-11'::DATE and '1970-04-11'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') AND uservisits.searchword IN ('fivhunjqcohfrvatu') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1970-03-11'::DATE and '1970-04-11'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') \n                    AND uservisits.searchword IN ('fivhunjqcohfrvatu') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1970-03-11'::DATE and '1970-04-11'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1970-05-11'::DATE and '1970-06-11'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1970-08-11'::DATE and '1970-09-11'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1970-08-11'::DATE and '1970-09-11'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1970-08-11'::DATE and '1970-09-11'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1970-08-11'::DATE and '1970-09-11'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1970-08-11'::DATE and '1970-09-11'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1970-08-11'::DATE and '1970-09-11'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_14",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'CRI'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1982-08-02'::DATE and '1982-09-02'::DATE AND\n                    uservisits.countrycode IN ('CRI','URY','MKD') AND uservisits.searchword IN ('cuxwemrp') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1982-08-02'::DATE and '1982-09-02'::DATE AND\n                    uservisits.countrycode IN ('CRI','URY','MKD') AND uservisits.searchword IN ('cuxwemrp') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1982-08-02'::DATE and '1982-09-02'::DATE AND\n                    uservisits.countrycode IN ('CRI','URY','MKD') \n                    AND uservisits.searchword IN ('cuxwemrp') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1982-08-02'::DATE and '1982-09-02'::DATE AND\n                    uservisits.countrycode IN ('CRI','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1982-10-02'::DATE and '1982-11-02'::DATE AND\n                    uservisits.countrycode IN ('CRI','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1983-01-02'::DATE and '1983-02-02'::DATE AND\n                    uservisits.countrycode IN ('CRI','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1983-01-02'::DATE and '1983-02-02'::DATE AND\n                    uservisits.countrycode IN ('CRI','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1983-01-02'::DATE and '1983-02-02'::DATE AND\n                    uservisits.countrycode IN ('CRI','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1983-01-02'::DATE and '1983-02-02'::DATE AND\n                    uservisits.countrycode IN ('CRI','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1983-01-02'::DATE and '1983-02-02'::DATE AND\n                    uservisits.countrycode IN ('CRI','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1983-01-02'::DATE and '1983-02-02'::DATE AND\n                    uservisits.countrycode IN ('CRI','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_15",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'BLR'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1994-08-22'::DATE and '1994-09-22'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') AND uservisits.searchword IN ('twqnswvfvc') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1994-08-22'::DATE and '1994-09-22'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') AND uservisits.searchword IN ('twqnswvfvc') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1994-08-22'::DATE and '1994-09-22'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') \n                    AND uservisits.searchword IN ('twqnswvfvc') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1994-08-22'::DATE and '1994-09-22'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1994-10-22'::DATE and '1994-11-22'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1995-01-22'::DATE and '1995-02-22'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1995-01-22'::DATE and '1995-02-22'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1995-01-22'::DATE and '1995-02-22'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1995-01-22'::DATE and '1995-02-22'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1995-01-22'::DATE and '1995-02-22'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1995-01-22'::DATE and '1995-02-22'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_16",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'IND'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2005-06-16'::DATE and '2005-07-16'::DATE AND\n                    uservisits.countrycode IN ('IND','URY','MKD') AND uservisits.searchword IN ('maajahxn') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2005-06-16'::DATE and '2005-07-16'::DATE AND\n                    uservisits.countrycode IN ('IND','URY','MKD') AND uservisits.searchword IN ('maajahxn') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2005-06-16'::DATE and '2005-07-16'::DATE AND\n                    uservisits.countrycode IN ('IND','URY','MKD') \n                    AND uservisits.searchword IN ('maajahxn') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2005-06-16'::DATE and '2005-07-16'::DATE AND\n                    uservisits.countrycode IN ('IND','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2005-08-16'::DATE and '2005-09-16'::DATE AND\n                    uservisits.countrycode IN ('IND','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2005-11-16'::DATE and '2005-12-16'::DATE AND\n                    uservisits.countrycode IN ('IND','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2005-11-16'::DATE and '2005-12-16'::DATE AND\n                    uservisits.countrycode IN ('IND','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2005-11-16'::DATE and '2005-12-16'::DATE AND\n                    uservisits.countrycode IN ('IND','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2005-11-16'::DATE and '2005-12-16'::DATE AND\n                    uservisits.countrycode IN ('IND','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2005-11-16'::DATE and '2005-12-16'::DATE AND\n                    uservisits.countrycode IN ('IND','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2005-11-16'::DATE and '2005-12-16'::DATE AND\n                    uservisits.countrycode IN ('IND','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_17",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'ARE'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1979-10-26'::DATE and '1979-11-26'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') AND uservisits.searchword IN ('ldi') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1979-10-26'::DATE and '1979-11-26'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') AND uservisits.searchword IN ('ldi') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1979-10-26'::DATE and '1979-11-26'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') \n                    AND uservisits.searchword IN ('ldi') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1979-10-26'::DATE and '1979-11-26'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1979-12-26'::DATE and '1980-01-26'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-03-26'::DATE and '1980-04-26'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-03-26'::DATE and '1980-04-26'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-03-26'::DATE and '1980-04-26'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-03-26'::DATE and '1980-04-26'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-03-26'::DATE and '1980-04-26'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-03-26'::DATE and '1980-04-26'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_18",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'UKR'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1992-03-18'::DATE and '1992-04-18'::DATE AND\n                    uservisits.countrycode IN ('UKR','URY','MKD') AND uservisits.searchword IN ('rudnf') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1992-03-18'::DATE and '1992-04-18'::DATE AND\n                    uservisits.countrycode IN ('UKR','URY','MKD') AND uservisits.searchword IN ('rudnf') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1992-03-18'::DATE and '1992-04-18'::DATE AND\n                    uservisits.countrycode IN ('UKR','URY','MKD') \n                    AND uservisits.searchword IN ('rudnf') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1992-03-18'::DATE and '1992-04-18'::DATE AND\n                    uservisits.countrycode IN ('UKR','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1992-05-18'::DATE and '1992-06-18'::DATE AND\n                    uservisits.countrycode IN ('UKR','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1992-08-18'::DATE and '1992-09-18'::DATE AND\n                    uservisits.countrycode IN ('UKR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1992-08-18'::DATE and '1992-09-18'::DATE AND\n                    uservisits.countrycode IN ('UKR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1992-08-18'::DATE and '1992-09-18'::DATE AND\n                    uservisits.countrycode IN ('UKR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1992-08-18'::DATE and '1992-09-18'::DATE AND\n                    uservisits.countrycode IN ('UKR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1992-08-18'::DATE and '1992-09-18'::DATE AND\n                    uservisits.countrycode IN ('UKR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1992-08-18'::DATE and '1992-09-18'::DATE AND\n                    uservisits.countrycode IN ('UKR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_19",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'DOM'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2001-10-24'::DATE and '2001-11-24'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') AND uservisits.searchword IN ('yxuqewosttexb') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2001-10-24'::DATE and '2001-11-24'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') AND uservisits.searchword IN ('yxuqewosttexb') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2001-10-24'::DATE and '2001-11-24'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') \n                    AND uservisits.searchword IN ('yxuqewosttexb') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2001-10-24'::DATE and '2001-11-24'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2001-12-24'::DATE and '2002-01-24'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2002-03-24'::DATE and '2002-04-24'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2002-03-24'::DATE and '2002-04-24'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2002-03-24'::DATE and '2002-04-24'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2002-03-24'::DATE and '2002-04-24'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2002-03-24'::DATE and '2002-04-24'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2002-03-24'::DATE and '2002-04-24'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_20",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'BLR'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1976-02-05'::DATE and '1976-03-05'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') AND uservisits.searchword IN ('elulwhyby') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1976-02-05'::DATE and '1976-03-05'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') AND uservisits.searchword IN ('elulwhyby') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1976-02-05'::DATE and '1976-03-05'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') \n                    AND uservisits.searchword IN ('elulwhyby') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1976-02-05'::DATE and '1976-03-05'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1976-04-05'::DATE and '1976-05-05'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1976-07-05'::DATE and '1976-08-05'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1976-07-05'::DATE and '1976-08-05'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1976-07-05'::DATE and '1976-08-05'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1976-07-05'::DATE and '1976-08-05'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1976-07-05'::DATE and '1976-08-05'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1976-07-05'::DATE and '1976-08-05'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_21",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'YEM'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1987-07-14'::DATE and '1987-08-14'::DATE AND\n                    uservisits.countrycode IN ('YEM','URY','MKD') AND uservisits.searchword IN ('gkrwajtwh') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1987-07-14'::DATE and '1987-08-14'::DATE AND\n                    uservisits.countrycode IN ('YEM','URY','MKD') AND uservisits.searchword IN ('gkrwajtwh') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1987-07-14'::DATE and '1987-08-14'::DATE AND\n                    uservisits.countrycode IN ('YEM','URY','MKD') \n                    AND uservisits.searchword IN ('gkrwajtwh') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1987-07-14'::DATE and '1987-08-14'::DATE AND\n                    uservisits.countrycode IN ('YEM','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1987-09-14'::DATE and '1987-10-14'::DATE AND\n                    uservisits.countrycode IN ('YEM','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1987-12-14'::DATE and '1988-01-14'::DATE AND\n                    uservisits.countrycode IN ('YEM','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1987-12-14'::DATE and '1988-01-14'::DATE AND\n                    uservisits.countrycode IN ('YEM','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1987-12-14'::DATE and '1988-01-14'::DATE AND\n                    uservisits.countrycode IN ('YEM','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1987-12-14'::DATE and '1988-01-14'::DATE AND\n                    uservisits.countrycode IN ('YEM','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1987-12-14'::DATE and '1988-01-14'::DATE AND\n                    uservisits.countrycode IN ('YEM','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1987-12-14'::DATE and '1988-01-14'::DATE AND\n                    uservisits.countrycode IN ('YEM','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_22",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'USA'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2000-09-16'::DATE and '2000-10-16'::DATE AND\n                    uservisits.countrycode IN ('USA','URY','MKD') AND uservisits.searchword IN ('jxwtwokxsigfgwmc') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2000-09-16'::DATE and '2000-10-16'::DATE AND\n                    uservisits.countrycode IN ('USA','URY','MKD') AND uservisits.searchword IN ('jxwtwokxsigfgwmc') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2000-09-16'::DATE and '2000-10-16'::DATE AND\n                    uservisits.countrycode IN ('USA','URY','MKD') \n                    AND uservisits.searchword IN ('jxwtwokxsigfgwmc') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2000-09-16'::DATE and '2000-10-16'::DATE AND\n                    uservisits.countrycode IN ('USA','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2000-11-16'::DATE and '2000-12-16'::DATE AND\n                    uservisits.countrycode IN ('USA','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2001-02-16'::DATE and '2001-03-16'::DATE AND\n                    uservisits.countrycode IN ('USA','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2001-02-16'::DATE and '2001-03-16'::DATE AND\n                    uservisits.countrycode IN ('USA','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2001-02-16'::DATE and '2001-03-16'::DATE AND\n                    uservisits.countrycode IN ('USA','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2001-02-16'::DATE and '2001-03-16'::DATE AND\n                    uservisits.countrycode IN ('USA','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2001-02-16'::DATE and '2001-03-16'::DATE AND\n                    uservisits.countrycode IN ('USA','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2001-02-16'::DATE and '2001-03-16'::DATE AND\n                    uservisits.countrycode IN ('USA','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_23",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'BGR'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2010-12-02'::DATE and '2011-01-02'::DATE AND\n                    uservisits.countrycode IN ('BGR','URY','MKD') AND uservisits.searchword IN ('yvarigdjotbdkt') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2010-12-02'::DATE and '2011-01-02'::DATE AND\n                    uservisits.countrycode IN ('BGR','URY','MKD') AND uservisits.searchword IN ('yvarigdjotbdkt') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2010-12-02'::DATE and '2011-01-02'::DATE AND\n                    uservisits.countrycode IN ('BGR','URY','MKD') \n                    AND uservisits.searchword IN ('yvarigdjotbdkt') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2010-12-02'::DATE and '2011-01-02'::DATE AND\n                    uservisits.countrycode IN ('BGR','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2011-02-02'::DATE and '2011-03-02'::DATE AND\n                    uservisits.countrycode IN ('BGR','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2011-05-02'::DATE and '2011-06-02'::DATE AND\n                    uservisits.countrycode IN ('BGR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2011-05-02'::DATE and '2011-06-02'::DATE AND\n                    uservisits.countrycode IN ('BGR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2011-05-02'::DATE and '2011-06-02'::DATE AND\n                    uservisits.countrycode IN ('BGR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2011-05-02'::DATE and '2011-06-02'::DATE AND\n                    uservisits.countrycode IN ('BGR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2011-05-02'::DATE and '2011-06-02'::DATE AND\n                    uservisits.countrycode IN ('BGR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2011-05-02'::DATE and '2011-06-02'::DATE AND\n                    uservisits.countrycode IN ('BGR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_24",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'ISR'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1977-07-07'::DATE and '1977-08-07'::DATE AND\n                    uservisits.countrycode IN ('ISR','URY','MKD') AND uservisits.searchword IN ('fwk') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1977-07-07'::DATE and '1977-08-07'::DATE AND\n                    uservisits.countrycode IN ('ISR','URY','MKD') AND uservisits.searchword IN ('fwk') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1977-07-07'::DATE and '1977-08-07'::DATE AND\n                    uservisits.countrycode IN ('ISR','URY','MKD') \n                    AND uservisits.searchword IN ('fwk') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1977-07-07'::DATE and '1977-08-07'::DATE AND\n                    uservisits.countrycode IN ('ISR','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1977-09-07'::DATE and '1977-10-07'::DATE AND\n                    uservisits.countrycode IN ('ISR','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1977-12-07'::DATE and '1978-01-07'::DATE AND\n                    uservisits.countrycode IN ('ISR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1977-12-07'::DATE and '1978-01-07'::DATE AND\n                    uservisits.countrycode IN ('ISR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1977-12-07'::DATE and '1978-01-07'::DATE AND\n                    uservisits.countrycode IN ('ISR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1977-12-07'::DATE and '1978-01-07'::DATE AND\n                    uservisits.countrycode IN ('ISR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1977-12-07'::DATE and '1978-01-07'::DATE AND\n                    uservisits.countrycode IN ('ISR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1977-12-07'::DATE and '1978-01-07'::DATE AND\n                    uservisits.countrycode IN ('ISR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_25",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'LTU'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1988-12-13'::DATE and '1989-01-13'::DATE AND\n                    uservisits.countrycode IN ('LTU','URY','MKD') AND uservisits.searchword IN ('yarebhaapateqgw') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1988-12-13'::DATE and '1989-01-13'::DATE AND\n                    uservisits.countrycode IN ('LTU','URY','MKD') AND uservisits.searchword IN ('yarebhaapateqgw') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1988-12-13'::DATE and '1989-01-13'::DATE AND\n                    uservisits.countrycode IN ('LTU','URY','MKD') \n                    AND uservisits.searchword IN ('yarebhaapateqgw') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1988-12-13'::DATE and '1989-01-13'::DATE AND\n                    uservisits.countrycode IN ('LTU','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1989-02-13'::DATE and '1989-03-13'::DATE AND\n                    uservisits.countrycode IN ('LTU','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1989-05-13'::DATE and '1989-06-13'::DATE AND\n                    uservisits.countrycode IN ('LTU','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1989-05-13'::DATE and '1989-06-13'::DATE AND\n                    uservisits.countrycode IN ('LTU','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1989-05-13'::DATE and '1989-06-13'::DATE AND\n                    uservisits.countrycode IN ('LTU','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1989-05-13'::DATE and '1989-06-13'::DATE AND\n                    uservisits.countrycode IN ('LTU','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1989-05-13'::DATE and '1989-06-13'::DATE AND\n                    uservisits.countrycode IN ('LTU','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1989-05-13'::DATE and '1989-06-13'::DATE AND\n                    uservisits.countrycode IN ('LTU','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_26",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'SGP'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1999-05-03'::DATE and '1999-06-03'::DATE AND\n                    uservisits.countrycode IN ('SGP','URY','MKD') AND uservisits.searchword IN ('ywsa') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1999-05-03'::DATE and '1999-06-03'::DATE AND\n                    uservisits.countrycode IN ('SGP','URY','MKD') AND uservisits.searchword IN ('ywsa') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1999-05-03'::DATE and '1999-06-03'::DATE AND\n                    uservisits.countrycode IN ('SGP','URY','MKD') \n                    AND uservisits.searchword IN ('ywsa') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1999-05-03'::DATE and '1999-06-03'::DATE AND\n                    uservisits.countrycode IN ('SGP','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1999-07-03'::DATE and '1999-08-03'::DATE AND\n                    uservisits.countrycode IN ('SGP','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1999-10-03'::DATE and '1999-11-03'::DATE AND\n                    uservisits.countrycode IN ('SGP','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1999-10-03'::DATE and '1999-11-03'::DATE AND\n                    uservisits.countrycode IN ('SGP','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1999-10-03'::DATE and '1999-11-03'::DATE AND\n                    uservisits.countrycode IN ('SGP','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1999-10-03'::DATE and '1999-11-03'::DATE AND\n                    uservisits.countrycode IN ('SGP','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1999-10-03'::DATE and '1999-11-03'::DATE AND\n                    uservisits.countrycode IN ('SGP','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1999-10-03'::DATE and '1999-11-03'::DATE AND\n                    uservisits.countrycode IN ('SGP','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_27",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'QAT'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2009-07-18'::DATE and '2009-08-18'::DATE AND\n                    uservisits.countrycode IN ('QAT','URY','MKD') AND uservisits.searchword IN ('wygmicflt') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2009-07-18'::DATE and '2009-08-18'::DATE AND\n                    uservisits.countrycode IN ('QAT','URY','MKD') AND uservisits.searchword IN ('wygmicflt') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2009-07-18'::DATE and '2009-08-18'::DATE AND\n                    uservisits.countrycode IN ('QAT','URY','MKD') \n                    AND uservisits.searchword IN ('wygmicflt') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2009-07-18'::DATE and '2009-08-18'::DATE AND\n                    uservisits.countrycode IN ('QAT','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2009-09-18'::DATE and '2009-10-18'::DATE AND\n                    uservisits.countrycode IN ('QAT','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2009-12-18'::DATE and '2010-01-18'::DATE AND\n                    uservisits.countrycode IN ('QAT','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2009-12-18'::DATE and '2010-01-18'::DATE AND\n                    uservisits.countrycode IN ('QAT','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2009-12-18'::DATE and '2010-01-18'::DATE AND\n                    uservisits.countrycode IN ('QAT','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2009-12-18'::DATE and '2010-01-18'::DATE AND\n                    uservisits.countrycode IN ('QAT','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2009-12-18'::DATE and '2010-01-18'::DATE AND\n                    uservisits.countrycode IN ('QAT','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2009-12-18'::DATE and '2010-01-18'::DATE AND\n                    uservisits.countrycode IN ('QAT','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_28",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'SRB'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1978-11-13'::DATE and '1978-12-13'::DATE AND\n                    uservisits.countrycode IN ('SRB','URY','MKD') AND uservisits.searchword IN ('owd') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1978-11-13'::DATE and '1978-12-13'::DATE AND\n                    uservisits.countrycode IN ('SRB','URY','MKD') AND uservisits.searchword IN ('owd') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1978-11-13'::DATE and '1978-12-13'::DATE AND\n                    uservisits.countrycode IN ('SRB','URY','MKD') \n                    AND uservisits.searchword IN ('owd') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1978-11-13'::DATE and '1978-12-13'::DATE AND\n                    uservisits.countrycode IN ('SRB','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1979-01-13'::DATE and '1979-02-13'::DATE AND\n                    uservisits.countrycode IN ('SRB','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1979-04-13'::DATE and '1979-05-13'::DATE AND\n                    uservisits.countrycode IN ('SRB','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1979-04-13'::DATE and '1979-05-13'::DATE AND\n                    uservisits.countrycode IN ('SRB','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1979-04-13'::DATE and '1979-05-13'::DATE AND\n                    uservisits.countrycode IN ('SRB','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1979-04-13'::DATE and '1979-05-13'::DATE AND\n                    uservisits.countrycode IN ('SRB','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1979-04-13'::DATE and '1979-05-13'::DATE AND\n                    uservisits.countrycode IN ('SRB','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1979-04-13'::DATE and '1979-05-13'::DATE AND\n                    uservisits.countrycode IN ('SRB','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_29",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'GBR'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1990-05-23'::DATE and '1990-06-23'::DATE AND\n                    uservisits.countrycode IN ('GBR','URY','MKD') AND uservisits.searchword IN ('cjqqktk') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1990-05-23'::DATE and '1990-06-23'::DATE AND\n                    uservisits.countrycode IN ('GBR','URY','MKD') AND uservisits.searchword IN ('cjqqktk') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1990-05-23'::DATE and '1990-06-23'::DATE AND\n                    uservisits.countrycode IN ('GBR','URY','MKD') \n                    AND uservisits.searchword IN ('cjqqktk') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1990-05-23'::DATE and '1990-06-23'::DATE AND\n                    uservisits.countrycode IN ('GBR','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1990-07-23'::DATE and '1990-08-23'::DATE AND\n                    uservisits.countrycode IN ('GBR','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1990-10-23'::DATE and '1990-11-23'::DATE AND\n                    uservisits.countrycode IN ('GBR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1990-10-23'::DATE and '1990-11-23'::DATE AND\n                    uservisits.countrycode IN ('GBR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1990-10-23'::DATE and '1990-11-23'::DATE AND\n                    uservisits.countrycode IN ('GBR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1990-10-23'::DATE and '1990-11-23'::DATE AND\n                    uservisits.countrycode IN ('GBR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1990-10-23'::DATE and '1990-11-23'::DATE AND\n                    uservisits.countrycode IN ('GBR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1990-10-23'::DATE and '1990-11-23'::DATE AND\n                    uservisits.countrycode IN ('GBR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_30",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'MLT'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2003-06-25'::DATE and '2003-07-25'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') AND uservisits.searchword IN ('mlsejjptdrgx') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2003-06-25'::DATE and '2003-07-25'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') AND uservisits.searchword IN ('mlsejjptdrgx') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2003-06-25'::DATE and '2003-07-25'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND uservisits.searchword IN ('mlsejjptdrgx') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2003-06-25'::DATE and '2003-07-25'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2003-08-25'::DATE and '2003-09-25'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2003-11-25'::DATE and '2003-12-25'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2003-11-25'::DATE and '2003-12-25'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2003-11-25'::DATE and '2003-12-25'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2003-11-25'::DATE and '2003-12-25'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2003-11-25'::DATE and '2003-12-25'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2003-11-25'::DATE and '2003-12-25'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_31",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'AUS'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-04-14'::DATE and '1980-05-14'::DATE AND\n                    uservisits.countrycode IN ('AUS','URY','MKD') AND uservisits.searchword IN ('fhojb') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-04-14'::DATE and '1980-05-14'::DATE AND\n                    uservisits.countrycode IN ('AUS','URY','MKD') AND uservisits.searchword IN ('fhojb') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-04-14'::DATE and '1980-05-14'::DATE AND\n                    uservisits.countrycode IN ('AUS','URY','MKD') \n                    AND uservisits.searchword IN ('fhojb') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-04-14'::DATE and '1980-05-14'::DATE AND\n                    uservisits.countrycode IN ('AUS','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-06-14'::DATE and '1980-07-14'::DATE AND\n                    uservisits.countrycode IN ('AUS','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-09-14'::DATE and '1980-10-14'::DATE AND\n                    uservisits.countrycode IN ('AUS','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-09-14'::DATE and '1980-10-14'::DATE AND\n                    uservisits.countrycode IN ('AUS','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-09-14'::DATE and '1980-10-14'::DATE AND\n                    uservisits.countrycode IN ('AUS','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-09-14'::DATE and '1980-10-14'::DATE AND\n                    uservisits.countrycode IN ('AUS','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-09-14'::DATE and '1980-10-14'::DATE AND\n                    uservisits.countrycode IN ('AUS','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-09-14'::DATE and '1980-10-14'::DATE AND\n                    uservisits.countrycode IN ('AUS','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_32",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'CZE'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1991-10-23'::DATE and '1991-11-23'::DATE AND\n                    uservisits.countrycode IN ('CZE','URY','MKD') AND uservisits.searchword IN ('bcsa') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1991-10-23'::DATE and '1991-11-23'::DATE AND\n                    uservisits.countrycode IN ('CZE','URY','MKD') AND uservisits.searchword IN ('bcsa') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1991-10-23'::DATE and '1991-11-23'::DATE AND\n                    uservisits.countrycode IN ('CZE','URY','MKD') \n                    AND uservisits.searchword IN ('bcsa') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1991-10-23'::DATE and '1991-11-23'::DATE AND\n                    uservisits.countrycode IN ('CZE','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1991-12-23'::DATE and '1992-01-23'::DATE AND\n                    uservisits.countrycode IN ('CZE','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1992-03-23'::DATE and '1992-04-23'::DATE AND\n                    uservisits.countrycode IN ('CZE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1992-03-23'::DATE and '1992-04-23'::DATE AND\n                    uservisits.countrycode IN ('CZE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1992-03-23'::DATE and '1992-04-23'::DATE AND\n                    uservisits.countrycode IN ('CZE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1992-03-23'::DATE and '1992-04-23'::DATE AND\n                    uservisits.countrycode IN ('CZE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1992-03-23'::DATE and '1992-04-23'::DATE AND\n                    uservisits.countrycode IN ('CZE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1992-03-23'::DATE and '1992-04-23'::DATE AND\n                    uservisits.countrycode IN ('CZE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_33",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'RUS'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2002-02-08'::DATE and '2002-03-08'::DATE AND\n                    uservisits.countrycode IN ('RUS','URY','MKD') AND uservisits.searchword IN ('douqc') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2002-02-08'::DATE and '2002-03-08'::DATE AND\n                    uservisits.countrycode IN ('RUS','URY','MKD') AND uservisits.searchword IN ('douqc') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2002-02-08'::DATE and '2002-03-08'::DATE AND\n                    uservisits.countrycode IN ('RUS','URY','MKD') \n                    AND uservisits.searchword IN ('douqc') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2002-02-08'::DATE and '2002-03-08'::DATE AND\n                    uservisits.countrycode IN ('RUS','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2002-04-08'::DATE and '2002-05-08'::DATE AND\n                    uservisits.countrycode IN ('RUS','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2002-07-08'::DATE and '2002-08-08'::DATE AND\n                    uservisits.countrycode IN ('RUS','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2002-07-08'::DATE and '2002-08-08'::DATE AND\n                    uservisits.countrycode IN ('RUS','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2002-07-08'::DATE and '2002-08-08'::DATE AND\n                    uservisits.countrycode IN ('RUS','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2002-07-08'::DATE and '2002-08-08'::DATE AND\n                    uservisits.countrycode IN ('RUS','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2002-07-08'::DATE and '2002-08-08'::DATE AND\n                    uservisits.countrycode IN ('RUS','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2002-07-08'::DATE and '2002-08-08'::DATE AND\n                    uservisits.countrycode IN ('RUS','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_34",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'DNK'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1970-08-21'::DATE and '1970-09-21'::DATE AND\n                    uservisits.countrycode IN ('DNK','URY','MKD') AND uservisits.searchword IN ('vqypgwoxaw') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1970-08-21'::DATE and '1970-09-21'::DATE AND\n                    uservisits.countrycode IN ('DNK','URY','MKD') AND uservisits.searchword IN ('vqypgwoxaw') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1970-08-21'::DATE and '1970-09-21'::DATE AND\n                    uservisits.countrycode IN ('DNK','URY','MKD') \n                    AND uservisits.searchword IN ('vqypgwoxaw') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1970-08-21'::DATE and '1970-09-21'::DATE AND\n                    uservisits.countrycode IN ('DNK','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1970-10-21'::DATE and '1970-11-21'::DATE AND\n                    uservisits.countrycode IN ('DNK','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1971-01-21'::DATE and '1971-02-21'::DATE AND\n                    uservisits.countrycode IN ('DNK','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1971-01-21'::DATE and '1971-02-21'::DATE AND\n                    uservisits.countrycode IN ('DNK','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1971-01-21'::DATE and '1971-02-21'::DATE AND\n                    uservisits.countrycode IN ('DNK','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1971-01-21'::DATE and '1971-02-21'::DATE AND\n                    uservisits.countrycode IN ('DNK','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1971-01-21'::DATE and '1971-02-21'::DATE AND\n                    uservisits.countrycode IN ('DNK','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1971-01-21'::DATE and '1971-02-21'::DATE AND\n                    uservisits.countrycode IN ('DNK','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_35",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'BHR'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1982-02-28'::DATE and '1982-03-28'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') AND uservisits.searchword IN ('vwrobqr') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1982-02-28'::DATE and '1982-03-28'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') AND uservisits.searchword IN ('vwrobqr') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1982-02-28'::DATE and '1982-03-28'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') \n                    AND uservisits.searchword IN ('vwrobqr') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1982-02-28'::DATE and '1982-03-28'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1982-04-28'::DATE and '1982-05-28'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1982-07-28'::DATE and '1982-08-28'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1982-07-28'::DATE and '1982-08-28'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1982-07-28'::DATE and '1982-08-28'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1982-07-28'::DATE and '1982-08-28'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1982-07-28'::DATE and '1982-08-28'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1982-07-28'::DATE and '1982-08-28'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_36",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'BEL'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1994-11-29'::DATE and '1994-12-29'::DATE AND\n                    uservisits.countrycode IN ('BEL','URY','MKD') AND uservisits.searchword IN ('lkinqv') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1994-11-29'::DATE and '1994-12-29'::DATE AND\n                    uservisits.countrycode IN ('BEL','URY','MKD') AND uservisits.searchword IN ('lkinqv') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1994-11-29'::DATE and '1994-12-29'::DATE AND\n                    uservisits.countrycode IN ('BEL','URY','MKD') \n                    AND uservisits.searchword IN ('lkinqv') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1994-11-29'::DATE and '1994-12-29'::DATE AND\n                    uservisits.countrycode IN ('BEL','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1995-01-29'::DATE and '1995-02-28'::DATE AND\n                    uservisits.countrycode IN ('BEL','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1995-04-29'::DATE and '1995-05-29'::DATE AND\n                    uservisits.countrycode IN ('BEL','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1995-04-29'::DATE and '1995-05-29'::DATE AND\n                    uservisits.countrycode IN ('BEL','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1995-04-29'::DATE and '1995-05-29'::DATE AND\n                    uservisits.countrycode IN ('BEL','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1995-04-29'::DATE and '1995-05-29'::DATE AND\n                    uservisits.countrycode IN ('BEL','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1995-04-29'::DATE and '1995-05-29'::DATE AND\n                    uservisits.countrycode IN ('BEL','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1995-04-29'::DATE and '1995-05-29'::DATE AND\n                    uservisits.countrycode IN ('BEL','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_37",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'LUX'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2005-03-17'::DATE and '2005-04-17'::DATE AND\n                    uservisits.countrycode IN ('LUX','URY','MKD') AND uservisits.searchword IN ('vlr') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2005-03-17'::DATE and '2005-04-17'::DATE AND\n                    uservisits.countrycode IN ('LUX','URY','MKD') AND uservisits.searchword IN ('vlr') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2005-03-17'::DATE and '2005-04-17'::DATE AND\n                    uservisits.countrycode IN ('LUX','URY','MKD') \n                    AND uservisits.searchword IN ('vlr') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2005-03-17'::DATE and '2005-04-17'::DATE AND\n                    uservisits.countrycode IN ('LUX','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2005-05-17'::DATE and '2005-06-17'::DATE AND\n                    uservisits.countrycode IN ('LUX','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2005-08-17'::DATE and '2005-09-17'::DATE AND\n                    uservisits.countrycode IN ('LUX','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2005-08-17'::DATE and '2005-09-17'::DATE AND\n                    uservisits.countrycode IN ('LUX','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2005-08-17'::DATE and '2005-09-17'::DATE AND\n                    uservisits.countrycode IN ('LUX','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2005-08-17'::DATE and '2005-09-17'::DATE AND\n                    uservisits.countrycode IN ('LUX','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2005-08-17'::DATE and '2005-09-17'::DATE AND\n                    uservisits.countrycode IN ('LUX','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2005-08-17'::DATE and '2005-09-17'::DATE AND\n                    uservisits.countrycode IN ('LUX','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_38",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'MLT'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1972-01-09'::DATE and '1972-02-09'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') AND uservisits.searchword IN ('inhtecptejrmc') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1972-01-09'::DATE and '1972-02-09'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') AND uservisits.searchword IN ('inhtecptejrmc') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1972-01-09'::DATE and '1972-02-09'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND uservisits.searchword IN ('inhtecptejrmc') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1972-01-09'::DATE and '1972-02-09'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1972-03-09'::DATE and '1972-04-09'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1972-06-09'::DATE and '1972-07-09'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1972-06-09'::DATE and '1972-07-09'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1972-06-09'::DATE and '1972-07-09'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1972-06-09'::DATE and '1972-07-09'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1972-06-09'::DATE and '1972-07-09'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1972-06-09'::DATE and '1972-07-09'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_39",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'KOR'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1983-07-19'::DATE and '1983-08-19'::DATE AND\n                    uservisits.countrycode IN ('KOR','URY','MKD') AND uservisits.searchword IN ('pen') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1983-07-19'::DATE and '1983-08-19'::DATE AND\n                    uservisits.countrycode IN ('KOR','URY','MKD') AND uservisits.searchword IN ('pen') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1983-07-19'::DATE and '1983-08-19'::DATE AND\n                    uservisits.countrycode IN ('KOR','URY','MKD') \n                    AND uservisits.searchword IN ('pen') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1983-07-19'::DATE and '1983-08-19'::DATE AND\n                    uservisits.countrycode IN ('KOR','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1983-09-19'::DATE and '1983-10-19'::DATE AND\n                    uservisits.countrycode IN ('KOR','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1983-12-19'::DATE and '1984-01-19'::DATE AND\n                    uservisits.countrycode IN ('KOR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1983-12-19'::DATE and '1984-01-19'::DATE AND\n                    uservisits.countrycode IN ('KOR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1983-12-19'::DATE and '1984-01-19'::DATE AND\n                    uservisits.countrycode IN ('KOR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1983-12-19'::DATE and '1984-01-19'::DATE AND\n                    uservisits.countrycode IN ('KOR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1983-12-19'::DATE and '1984-01-19'::DATE AND\n                    uservisits.countrycode IN ('KOR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1983-12-19'::DATE and '1984-01-19'::DATE AND\n                    uservisits.countrycode IN ('KOR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_40",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'PAN'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1993-06-25'::DATE and '1993-07-25'::DATE AND\n                    uservisits.countrycode IN ('PAN','URY','MKD') AND uservisits.searchword IN ('jyvqmgeaiip') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1993-06-25'::DATE and '1993-07-25'::DATE AND\n                    uservisits.countrycode IN ('PAN','URY','MKD') AND uservisits.searchword IN ('jyvqmgeaiip') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1993-06-25'::DATE and '1993-07-25'::DATE AND\n                    uservisits.countrycode IN ('PAN','URY','MKD') \n                    AND uservisits.searchword IN ('jyvqmgeaiip') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1993-06-25'::DATE and '1993-07-25'::DATE AND\n                    uservisits.countrycode IN ('PAN','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1993-08-25'::DATE and '1993-09-25'::DATE AND\n                    uservisits.countrycode IN ('PAN','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1993-11-25'::DATE and '1993-12-25'::DATE AND\n                    uservisits.countrycode IN ('PAN','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1993-11-25'::DATE and '1993-12-25'::DATE AND\n                    uservisits.countrycode IN ('PAN','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1993-11-25'::DATE and '1993-12-25'::DATE AND\n                    uservisits.countrycode IN ('PAN','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1993-11-25'::DATE and '1993-12-25'::DATE AND\n                    uservisits.countrycode IN ('PAN','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1993-11-25'::DATE and '1993-12-25'::DATE AND\n                    uservisits.countrycode IN ('PAN','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1993-11-25'::DATE and '1993-12-25'::DATE AND\n                    uservisits.countrycode IN ('PAN','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_41",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'TUR'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2003-10-12'::DATE and '2003-11-12'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') AND uservisits.searchword IN ('xgxcdplbwtpmxj') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2003-10-12'::DATE and '2003-11-12'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') AND uservisits.searchword IN ('xgxcdplbwtpmxj') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2003-10-12'::DATE and '2003-11-12'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') \n                    AND uservisits.searchword IN ('xgxcdplbwtpmxj') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2003-10-12'::DATE and '2003-11-12'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2003-12-12'::DATE and '2004-01-12'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2004-03-12'::DATE and '2004-04-12'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2004-03-12'::DATE and '2004-04-12'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2004-03-12'::DATE and '2004-04-12'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2004-03-12'::DATE and '2004-04-12'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2004-03-12'::DATE and '2004-04-12'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2004-03-12'::DATE and '2004-04-12'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_42",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'ARE'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1973-06-30'::DATE and '1973-07-30'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') AND uservisits.searchword IN ('mxjx') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1973-06-30'::DATE and '1973-07-30'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') AND uservisits.searchword IN ('mxjx') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1973-06-30'::DATE and '1973-07-30'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') \n                    AND uservisits.searchword IN ('mxjx') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1973-06-30'::DATE and '1973-07-30'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1973-08-30'::DATE and '1973-09-30'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1973-11-30'::DATE and '1973-12-30'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1973-11-30'::DATE and '1973-12-30'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1973-11-30'::DATE and '1973-12-30'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1973-11-30'::DATE and '1973-12-30'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1973-11-30'::DATE and '1973-12-30'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1973-11-30'::DATE and '1973-12-30'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_43",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'LVA'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1984-12-06'::DATE and '1985-01-06'::DATE AND\n                    uservisits.countrycode IN ('LVA','URY','MKD') AND uservisits.searchword IN ('oqwrcgb') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1984-12-06'::DATE and '1985-01-06'::DATE AND\n                    uservisits.countrycode IN ('LVA','URY','MKD') AND uservisits.searchword IN ('oqwrcgb') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1984-12-06'::DATE and '1985-01-06'::DATE AND\n                    uservisits.countrycode IN ('LVA','URY','MKD') \n                    AND uservisits.searchword IN ('oqwrcgb') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1984-12-06'::DATE and '1985-01-06'::DATE AND\n                    uservisits.countrycode IN ('LVA','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1985-02-06'::DATE and '1985-03-06'::DATE AND\n                    uservisits.countrycode IN ('LVA','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1985-05-06'::DATE and '1985-06-06'::DATE AND\n                    uservisits.countrycode IN ('LVA','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1985-05-06'::DATE and '1985-06-06'::DATE AND\n                    uservisits.countrycode IN ('LVA','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1985-05-06'::DATE and '1985-06-06'::DATE AND\n                    uservisits.countrycode IN ('LVA','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1985-05-06'::DATE and '1985-06-06'::DATE AND\n                    uservisits.countrycode IN ('LVA','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1985-05-06'::DATE and '1985-06-06'::DATE AND\n                    uservisits.countrycode IN ('LVA','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1985-05-06'::DATE and '1985-06-06'::DATE AND\n                    uservisits.countrycode IN ('LVA','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_44",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'BHR'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1997-10-08'::DATE and '1997-11-08'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') AND uservisits.searchword IN ('mihaf') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1997-10-08'::DATE and '1997-11-08'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') AND uservisits.searchword IN ('mihaf') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1997-10-08'::DATE and '1997-11-08'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') \n                    AND uservisits.searchword IN ('mihaf') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1997-10-08'::DATE and '1997-11-08'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1997-12-08'::DATE and '1998-01-08'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1998-03-08'::DATE and '1998-04-08'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1998-03-08'::DATE and '1998-04-08'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1998-03-08'::DATE and '1998-04-08'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1998-03-08'::DATE and '1998-04-08'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1998-03-08'::DATE and '1998-04-08'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1998-03-08'::DATE and '1998-04-08'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_45",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'COL'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2007-12-24'::DATE and '2008-01-24'::DATE AND\n                    uservisits.countrycode IN ('COL','URY','MKD') AND uservisits.searchword IN ('btf') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2007-12-24'::DATE and '2008-01-24'::DATE AND\n                    uservisits.countrycode IN ('COL','URY','MKD') AND uservisits.searchword IN ('btf') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2007-12-24'::DATE and '2008-01-24'::DATE AND\n                    uservisits.countrycode IN ('COL','URY','MKD') \n                    AND uservisits.searchword IN ('btf') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2007-12-24'::DATE and '2008-01-24'::DATE AND\n                    uservisits.countrycode IN ('COL','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2008-02-24'::DATE and '2008-03-24'::DATE AND\n                    uservisits.countrycode IN ('COL','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2008-05-24'::DATE and '2008-06-24'::DATE AND\n                    uservisits.countrycode IN ('COL','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2008-05-24'::DATE and '2008-06-24'::DATE AND\n                    uservisits.countrycode IN ('COL','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2008-05-24'::DATE and '2008-06-24'::DATE AND\n                    uservisits.countrycode IN ('COL','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2008-05-24'::DATE and '2008-06-24'::DATE AND\n                    uservisits.countrycode IN ('COL','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2008-05-24'::DATE and '2008-06-24'::DATE AND\n                    uservisits.countrycode IN ('COL','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2008-05-24'::DATE and '2008-06-24'::DATE AND\n                    uservisits.countrycode IN ('COL','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_46",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'JPN'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-11-18'::DATE and '1974-12-18'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') AND uservisits.searchword IN ('fdnwdgbi') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-11-18'::DATE and '1974-12-18'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') AND uservisits.searchword IN ('fdnwdgbi') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-11-18'::DATE and '1974-12-18'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') \n                    AND uservisits.searchword IN ('fdnwdgbi') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-11-18'::DATE and '1974-12-18'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1975-01-18'::DATE and '1975-02-18'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1975-04-18'::DATE and '1975-05-18'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1975-04-18'::DATE and '1975-05-18'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1975-04-18'::DATE and '1975-05-18'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1975-04-18'::DATE and '1975-05-18'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1975-04-18'::DATE and '1975-05-18'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1975-04-18'::DATE and '1975-05-18'::DATE AND\n                    uservisits.countrycode IN ('JPN','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_47",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'KWT'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-04-26'::DATE and '1986-05-26'::DATE AND\n                    uservisits.countrycode IN ('KWT','URY','MKD') AND uservisits.searchword IN ('ldtfa') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-04-26'::DATE and '1986-05-26'::DATE AND\n                    uservisits.countrycode IN ('KWT','URY','MKD') AND uservisits.searchword IN ('ldtfa') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-04-26'::DATE and '1986-05-26'::DATE AND\n                    uservisits.countrycode IN ('KWT','URY','MKD') \n                    AND uservisits.searchword IN ('ldtfa') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-04-26'::DATE and '1986-05-26'::DATE AND\n                    uservisits.countrycode IN ('KWT','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-06-26'::DATE and '1986-07-26'::DATE AND\n                    uservisits.countrycode IN ('KWT','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-09-26'::DATE and '1986-10-26'::DATE AND\n                    uservisits.countrycode IN ('KWT','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-09-26'::DATE and '1986-10-26'::DATE AND\n                    uservisits.countrycode IN ('KWT','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-09-26'::DATE and '1986-10-26'::DATE AND\n                    uservisits.countrycode IN ('KWT','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-09-26'::DATE and '1986-10-26'::DATE AND\n                    uservisits.countrycode IN ('KWT','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-09-26'::DATE and '1986-10-26'::DATE AND\n                    uservisits.countrycode IN ('KWT','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-09-26'::DATE and '1986-10-26'::DATE AND\n                    uservisits.countrycode IN ('KWT','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_48",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'ISR'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1996-05-04'::DATE and '1996-06-04'::DATE AND\n                    uservisits.countrycode IN ('ISR','URY','MKD') AND uservisits.searchword IN ('dmjxwgthrfumhk') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1996-05-04'::DATE and '1996-06-04'::DATE AND\n                    uservisits.countrycode IN ('ISR','URY','MKD') AND uservisits.searchword IN ('dmjxwgthrfumhk') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1996-05-04'::DATE and '1996-06-04'::DATE AND\n                    uservisits.countrycode IN ('ISR','URY','MKD') \n                    AND uservisits.searchword IN ('dmjxwgthrfumhk') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1996-05-04'::DATE and '1996-06-04'::DATE AND\n                    uservisits.countrycode IN ('ISR','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1996-07-04'::DATE and '1996-08-04'::DATE AND\n                    uservisits.countrycode IN ('ISR','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1996-10-04'::DATE and '1996-11-04'::DATE AND\n                    uservisits.countrycode IN ('ISR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1996-10-04'::DATE and '1996-11-04'::DATE AND\n                    uservisits.countrycode IN ('ISR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1996-10-04'::DATE and '1996-11-04'::DATE AND\n                    uservisits.countrycode IN ('ISR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1996-10-04'::DATE and '1996-11-04'::DATE AND\n                    uservisits.countrycode IN ('ISR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1996-10-04'::DATE and '1996-11-04'::DATE AND\n                    uservisits.countrycode IN ('ISR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1996-10-04'::DATE and '1996-11-04'::DATE AND\n                    uservisits.countrycode IN ('ISR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_49",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'NLD'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2006-07-20'::DATE and '2006-08-20'::DATE AND\n                    uservisits.countrycode IN ('NLD','URY','MKD') AND uservisits.searchword IN ('afrwgticyyccgvb') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2006-07-20'::DATE and '2006-08-20'::DATE AND\n                    uservisits.countrycode IN ('NLD','URY','MKD') AND uservisits.searchword IN ('afrwgticyyccgvb') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2006-07-20'::DATE and '2006-08-20'::DATE AND\n                    uservisits.countrycode IN ('NLD','URY','MKD') \n                    AND uservisits.searchword IN ('afrwgticyyccgvb') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2006-07-20'::DATE and '2006-08-20'::DATE AND\n                    uservisits.countrycode IN ('NLD','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2006-09-20'::DATE and '2006-10-20'::DATE AND\n                    uservisits.countrycode IN ('NLD','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2006-12-20'::DATE and '2007-01-20'::DATE AND\n                    uservisits.countrycode IN ('NLD','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2006-12-20'::DATE and '2007-01-20'::DATE AND\n                    uservisits.countrycode IN ('NLD','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2006-12-20'::DATE and '2007-01-20'::DATE AND\n                    uservisits.countrycode IN ('NLD','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2006-12-20'::DATE and '2007-01-20'::DATE AND\n                    uservisits.countrycode IN ('NLD','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2006-12-20'::DATE and '2007-01-20'::DATE AND\n                    uservisits.countrycode IN ('NLD','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2006-12-20'::DATE and '2007-01-20'::DATE AND\n                    uservisits.countrycode IN ('NLD','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_50",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'CZE'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1976-10-23'::DATE and '1976-11-23'::DATE AND\n                    uservisits.countrycode IN ('CZE','URY','MKD') AND uservisits.searchword IN ('lrvunlffuto') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1976-10-23'::DATE and '1976-11-23'::DATE AND\n                    uservisits.countrycode IN ('CZE','URY','MKD') AND uservisits.searchword IN ('lrvunlffuto') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1976-10-23'::DATE and '1976-11-23'::DATE AND\n                    uservisits.countrycode IN ('CZE','URY','MKD') \n                    AND uservisits.searchword IN ('lrvunlffuto') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1976-10-23'::DATE and '1976-11-23'::DATE AND\n                    uservisits.countrycode IN ('CZE','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1976-12-23'::DATE and '1977-01-23'::DATE AND\n                    uservisits.countrycode IN ('CZE','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1977-03-23'::DATE and '1977-04-23'::DATE AND\n                    uservisits.countrycode IN ('CZE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1977-03-23'::DATE and '1977-04-23'::DATE AND\n                    uservisits.countrycode IN ('CZE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1977-03-23'::DATE and '1977-04-23'::DATE AND\n                    uservisits.countrycode IN ('CZE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1977-03-23'::DATE and '1977-04-23'::DATE AND\n                    uservisits.countrycode IN ('CZE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1977-03-23'::DATE and '1977-04-23'::DATE AND\n                    uservisits.countrycode IN ('CZE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1977-03-23'::DATE and '1977-04-23'::DATE AND\n                    uservisits.countrycode IN ('CZE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_51",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'MNE'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-11-03'::DATE and '1986-12-03'::DATE AND\n                    uservisits.countrycode IN ('MNE','URY','MKD') AND uservisits.searchword IN ('dbqduo') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-11-03'::DATE and '1986-12-03'::DATE AND\n                    uservisits.countrycode IN ('MNE','URY','MKD') AND uservisits.searchword IN ('dbqduo') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-11-03'::DATE and '1986-12-03'::DATE AND\n                    uservisits.countrycode IN ('MNE','URY','MKD') \n                    AND uservisits.searchword IN ('dbqduo') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-11-03'::DATE and '1986-12-03'::DATE AND\n                    uservisits.countrycode IN ('MNE','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1987-01-03'::DATE and '1987-02-03'::DATE AND\n                    uservisits.countrycode IN ('MNE','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1987-04-03'::DATE and '1987-05-03'::DATE AND\n                    uservisits.countrycode IN ('MNE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1987-04-03'::DATE and '1987-05-03'::DATE AND\n                    uservisits.countrycode IN ('MNE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1987-04-03'::DATE and '1987-05-03'::DATE AND\n                    uservisits.countrycode IN ('MNE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1987-04-03'::DATE and '1987-05-03'::DATE AND\n                    uservisits.countrycode IN ('MNE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1987-04-03'::DATE and '1987-05-03'::DATE AND\n                    uservisits.countrycode IN ('MNE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1987-04-03'::DATE and '1987-05-03'::DATE AND\n                    uservisits.countrycode IN ('MNE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_52",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'DNK'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2000-01-09'::DATE and '2000-02-09'::DATE AND\n                    uservisits.countrycode IN ('DNK','URY','MKD') AND uservisits.searchword IN ('pmoxallaespch') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2000-01-09'::DATE and '2000-02-09'::DATE AND\n                    uservisits.countrycode IN ('DNK','URY','MKD') AND uservisits.searchword IN ('pmoxallaespch') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2000-01-09'::DATE and '2000-02-09'::DATE AND\n                    uservisits.countrycode IN ('DNK','URY','MKD') \n                    AND uservisits.searchword IN ('pmoxallaespch') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2000-01-09'::DATE and '2000-02-09'::DATE AND\n                    uservisits.countrycode IN ('DNK','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2000-03-09'::DATE and '2000-04-09'::DATE AND\n                    uservisits.countrycode IN ('DNK','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2000-06-09'::DATE and '2000-07-09'::DATE AND\n                    uservisits.countrycode IN ('DNK','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2000-06-09'::DATE and '2000-07-09'::DATE AND\n                    uservisits.countrycode IN ('DNK','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2000-06-09'::DATE and '2000-07-09'::DATE AND\n                    uservisits.countrycode IN ('DNK','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2000-06-09'::DATE and '2000-07-09'::DATE AND\n                    uservisits.countrycode IN ('DNK','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2000-06-09'::DATE and '2000-07-09'::DATE AND\n                    uservisits.countrycode IN ('DNK','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2000-06-09'::DATE and '2000-07-09'::DATE AND\n                    uservisits.countrycode IN ('DNK','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_53",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'SWE'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2011-08-18'::DATE and '2011-09-18'::DATE AND\n                    uservisits.countrycode IN ('SWE','URY','MKD') AND uservisits.searchword IN ('dxcdyaqssanijsoi') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2011-08-18'::DATE and '2011-09-18'::DATE AND\n                    uservisits.countrycode IN ('SWE','URY','MKD') AND uservisits.searchword IN ('dxcdyaqssanijsoi') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2011-08-18'::DATE and '2011-09-18'::DATE AND\n                    uservisits.countrycode IN ('SWE','URY','MKD') \n                    AND uservisits.searchword IN ('dxcdyaqssanijsoi') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2011-08-18'::DATE and '2011-09-18'::DATE AND\n                    uservisits.countrycode IN ('SWE','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2011-10-18'::DATE and '2011-11-18'::DATE AND\n                    uservisits.countrycode IN ('SWE','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2012-01-18'::DATE and '2012-02-18'::DATE AND\n                    uservisits.countrycode IN ('SWE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2012-01-18'::DATE and '2012-02-18'::DATE AND\n                    uservisits.countrycode IN ('SWE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2012-01-18'::DATE and '2012-02-18'::DATE AND\n                    uservisits.countrycode IN ('SWE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2012-01-18'::DATE and '2012-02-18'::DATE AND\n                    uservisits.countrycode IN ('SWE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2012-01-18'::DATE and '2012-02-18'::DATE AND\n                    uservisits.countrycode IN ('SWE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2012-01-18'::DATE and '2012-02-18'::DATE AND\n                    uservisits.countrycode IN ('SWE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_54",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'SWE'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1978-03-25'::DATE and '1978-04-25'::DATE AND\n                    uservisits.countrycode IN ('SWE','URY','MKD') AND uservisits.searchword IN ('whtjv') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1978-03-25'::DATE and '1978-04-25'::DATE AND\n                    uservisits.countrycode IN ('SWE','URY','MKD') AND uservisits.searchword IN ('whtjv') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1978-03-25'::DATE and '1978-04-25'::DATE AND\n                    uservisits.countrycode IN ('SWE','URY','MKD') \n                    AND uservisits.searchword IN ('whtjv') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1978-03-25'::DATE and '1978-04-25'::DATE AND\n                    uservisits.countrycode IN ('SWE','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1978-05-25'::DATE and '1978-06-25'::DATE AND\n                    uservisits.countrycode IN ('SWE','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1978-08-25'::DATE and '1978-09-25'::DATE AND\n                    uservisits.countrycode IN ('SWE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1978-08-25'::DATE and '1978-09-25'::DATE AND\n                    uservisits.countrycode IN ('SWE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1978-08-25'::DATE and '1978-09-25'::DATE AND\n                    uservisits.countrycode IN ('SWE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1978-08-25'::DATE and '1978-09-25'::DATE AND\n                    uservisits.countrycode IN ('SWE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1978-08-25'::DATE and '1978-09-25'::DATE AND\n                    uservisits.countrycode IN ('SWE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1978-08-25'::DATE and '1978-09-25'::DATE AND\n                    uservisits.countrycode IN ('SWE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_55",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'ITA'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1988-04-04'::DATE and '1988-05-04'::DATE AND\n                    uservisits.countrycode IN ('ITA','URY','MKD') AND uservisits.searchword IN ('brtvjywld') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1988-04-04'::DATE and '1988-05-04'::DATE AND\n                    uservisits.countrycode IN ('ITA','URY','MKD') AND uservisits.searchword IN ('brtvjywld') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1988-04-04'::DATE and '1988-05-04'::DATE AND\n                    uservisits.countrycode IN ('ITA','URY','MKD') \n                    AND uservisits.searchword IN ('brtvjywld') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1988-04-04'::DATE and '1988-05-04'::DATE AND\n                    uservisits.countrycode IN ('ITA','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1988-06-04'::DATE and '1988-07-04'::DATE AND\n                    uservisits.countrycode IN ('ITA','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1988-09-04'::DATE and '1988-10-04'::DATE AND\n                    uservisits.countrycode IN ('ITA','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1988-09-04'::DATE and '1988-10-04'::DATE AND\n                    uservisits.countrycode IN ('ITA','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1988-09-04'::DATE and '1988-10-04'::DATE AND\n                    uservisits.countrycode IN ('ITA','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1988-09-04'::DATE and '1988-10-04'::DATE AND\n                    uservisits.countrycode IN ('ITA','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1988-09-04'::DATE and '1988-10-04'::DATE AND\n                    uservisits.countrycode IN ('ITA','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1988-09-04'::DATE and '1988-10-04'::DATE AND\n                    uservisits.countrycode IN ('ITA','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_56",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'ISL'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1998-08-25'::DATE and '1998-09-25'::DATE AND\n                    uservisits.countrycode IN ('ISL','URY','MKD') AND uservisits.searchword IN ('whtjv') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1998-08-25'::DATE and '1998-09-25'::DATE AND\n                    uservisits.countrycode IN ('ISL','URY','MKD') AND uservisits.searchword IN ('whtjv') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1998-08-25'::DATE and '1998-09-25'::DATE AND\n                    uservisits.countrycode IN ('ISL','URY','MKD') \n                    AND uservisits.searchword IN ('whtjv') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1998-08-25'::DATE and '1998-09-25'::DATE AND\n                    uservisits.countrycode IN ('ISL','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1998-10-25'::DATE and '1998-11-25'::DATE AND\n                    uservisits.countrycode IN ('ISL','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1999-01-25'::DATE and '1999-02-25'::DATE AND\n                    uservisits.countrycode IN ('ISL','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1999-01-25'::DATE and '1999-02-25'::DATE AND\n                    uservisits.countrycode IN ('ISL','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1999-01-25'::DATE and '1999-02-25'::DATE AND\n                    uservisits.countrycode IN ('ISL','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1999-01-25'::DATE and '1999-02-25'::DATE AND\n                    uservisits.countrycode IN ('ISL','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1999-01-25'::DATE and '1999-02-25'::DATE AND\n                    uservisits.countrycode IN ('ISL','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1999-01-25'::DATE and '1999-02-25'::DATE AND\n                    uservisits.countrycode IN ('ISL','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_57",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'DZA'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2010-04-03'::DATE and '2010-05-03'::DATE AND\n                    uservisits.countrycode IN ('DZA','URY','MKD') AND uservisits.searchword IN ('sgjrukaiubihbjr') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2010-04-03'::DATE and '2010-05-03'::DATE AND\n                    uservisits.countrycode IN ('DZA','URY','MKD') AND uservisits.searchword IN ('sgjrukaiubihbjr') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2010-04-03'::DATE and '2010-05-03'::DATE AND\n                    uservisits.countrycode IN ('DZA','URY','MKD') \n                    AND uservisits.searchword IN ('sgjrukaiubihbjr') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2010-04-03'::DATE and '2010-05-03'::DATE AND\n                    uservisits.countrycode IN ('DZA','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2010-06-03'::DATE and '2010-07-03'::DATE AND\n                    uservisits.countrycode IN ('DZA','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2010-09-03'::DATE and '2010-10-03'::DATE AND\n                    uservisits.countrycode IN ('DZA','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2010-09-03'::DATE and '2010-10-03'::DATE AND\n                    uservisits.countrycode IN ('DZA','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2010-09-03'::DATE and '2010-10-03'::DATE AND\n                    uservisits.countrycode IN ('DZA','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2010-09-03'::DATE and '2010-10-03'::DATE AND\n                    uservisits.countrycode IN ('DZA','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2010-09-03'::DATE and '2010-10-03'::DATE AND\n                    uservisits.countrycode IN ('DZA','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2010-09-03'::DATE and '2010-10-03'::DATE AND\n                    uservisits.countrycode IN ('DZA','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_58",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'MEX'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1979-07-24'::DATE and '1979-08-24'::DATE AND\n                    uservisits.countrycode IN ('MEX','URY','MKD') AND uservisits.searchword IN ('grdk') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1979-07-24'::DATE and '1979-08-24'::DATE AND\n                    uservisits.countrycode IN ('MEX','URY','MKD') AND uservisits.searchword IN ('grdk') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1979-07-24'::DATE and '1979-08-24'::DATE AND\n                    uservisits.countrycode IN ('MEX','URY','MKD') \n                    AND uservisits.searchword IN ('grdk') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1979-07-24'::DATE and '1979-08-24'::DATE AND\n                    uservisits.countrycode IN ('MEX','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1979-09-24'::DATE and '1979-10-24'::DATE AND\n                    uservisits.countrycode IN ('MEX','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1979-12-24'::DATE and '1980-01-24'::DATE AND\n                    uservisits.countrycode IN ('MEX','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1979-12-24'::DATE and '1980-01-24'::DATE AND\n                    uservisits.countrycode IN ('MEX','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1979-12-24'::DATE and '1980-01-24'::DATE AND\n                    uservisits.countrycode IN ('MEX','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1979-12-24'::DATE and '1980-01-24'::DATE AND\n                    uservisits.countrycode IN ('MEX','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1979-12-24'::DATE and '1980-01-24'::DATE AND\n                    uservisits.countrycode IN ('MEX','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1979-12-24'::DATE and '1980-01-24'::DATE AND\n                    uservisits.countrycode IN ('MEX','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_59",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'MLT'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1989-09-04'::DATE and '1989-10-04'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') AND uservisits.searchword IN ('qbvbnpxcwtafjtvq') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1989-09-04'::DATE and '1989-10-04'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') AND uservisits.searchword IN ('qbvbnpxcwtafjtvq') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1989-09-04'::DATE and '1989-10-04'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND uservisits.searchword IN ('qbvbnpxcwtafjtvq') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1989-09-04'::DATE and '1989-10-04'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1989-11-04'::DATE and '1989-12-04'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1990-02-04'::DATE and '1990-03-04'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1990-02-04'::DATE and '1990-03-04'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1990-02-04'::DATE and '1990-03-04'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1990-02-04'::DATE and '1990-03-04'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1990-02-04'::DATE and '1990-03-04'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1990-02-04'::DATE and '1990-03-04'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_60",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'BRA'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2002-10-09'::DATE and '2002-11-09'::DATE AND\n                    uservisits.countrycode IN ('BRA','URY','MKD') AND uservisits.searchword IN ('ito') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2002-10-09'::DATE and '2002-11-09'::DATE AND\n                    uservisits.countrycode IN ('BRA','URY','MKD') AND uservisits.searchword IN ('ito') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2002-10-09'::DATE and '2002-11-09'::DATE AND\n                    uservisits.countrycode IN ('BRA','URY','MKD') \n                    AND uservisits.searchword IN ('ito') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2002-10-09'::DATE and '2002-11-09'::DATE AND\n                    uservisits.countrycode IN ('BRA','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2002-12-09'::DATE and '2003-01-09'::DATE AND\n                    uservisits.countrycode IN ('BRA','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2003-03-09'::DATE and '2003-04-09'::DATE AND\n                    uservisits.countrycode IN ('BRA','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2003-03-09'::DATE and '2003-04-09'::DATE AND\n                    uservisits.countrycode IN ('BRA','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2003-03-09'::DATE and '2003-04-09'::DATE AND\n                    uservisits.countrycode IN ('BRA','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2003-03-09'::DATE and '2003-04-09'::DATE AND\n                    uservisits.countrycode IN ('BRA','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2003-03-09'::DATE and '2003-04-09'::DATE AND\n                    uservisits.countrycode IN ('BRA','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2003-03-09'::DATE and '2003-04-09'::DATE AND\n                    uservisits.countrycode IN ('BRA','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_61",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'CRI'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-12-23'::DATE and '1981-01-23'::DATE AND\n                    uservisits.countrycode IN ('CRI','URY','MKD') AND uservisits.searchword IN ('kimbsrkrg') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-12-23'::DATE and '1981-01-23'::DATE AND\n                    uservisits.countrycode IN ('CRI','URY','MKD') AND uservisits.searchword IN ('kimbsrkrg') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-12-23'::DATE and '1981-01-23'::DATE AND\n                    uservisits.countrycode IN ('CRI','URY','MKD') \n                    AND uservisits.searchword IN ('kimbsrkrg') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-12-23'::DATE and '1981-01-23'::DATE AND\n                    uservisits.countrycode IN ('CRI','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1981-02-23'::DATE and '1981-03-23'::DATE AND\n                    uservisits.countrycode IN ('CRI','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1981-05-23'::DATE and '1981-06-23'::DATE AND\n                    uservisits.countrycode IN ('CRI','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1981-05-23'::DATE and '1981-06-23'::DATE AND\n                    uservisits.countrycode IN ('CRI','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1981-05-23'::DATE and '1981-06-23'::DATE AND\n                    uservisits.countrycode IN ('CRI','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1981-05-23'::DATE and '1981-06-23'::DATE AND\n                    uservisits.countrycode IN ('CRI','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1981-05-23'::DATE and '1981-06-23'::DATE AND\n                    uservisits.countrycode IN ('CRI','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1981-05-23'::DATE and '1981-06-23'::DATE AND\n                    uservisits.countrycode IN ('CRI','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_62",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'EST'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1991-02-04'::DATE and '1991-03-04'::DATE AND\n                    uservisits.countrycode IN ('EST','URY','MKD') AND uservisits.searchword IN ('eswvv') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1991-02-04'::DATE and '1991-03-04'::DATE AND\n                    uservisits.countrycode IN ('EST','URY','MKD') AND uservisits.searchword IN ('eswvv') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1991-02-04'::DATE and '1991-03-04'::DATE AND\n                    uservisits.countrycode IN ('EST','URY','MKD') \n                    AND uservisits.searchword IN ('eswvv') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1991-02-04'::DATE and '1991-03-04'::DATE AND\n                    uservisits.countrycode IN ('EST','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1991-04-04'::DATE and '1991-05-04'::DATE AND\n                    uservisits.countrycode IN ('EST','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1991-07-04'::DATE and '1991-08-04'::DATE AND\n                    uservisits.countrycode IN ('EST','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1991-07-04'::DATE and '1991-08-04'::DATE AND\n                    uservisits.countrycode IN ('EST','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1991-07-04'::DATE and '1991-08-04'::DATE AND\n                    uservisits.countrycode IN ('EST','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1991-07-04'::DATE and '1991-08-04'::DATE AND\n                    uservisits.countrycode IN ('EST','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1991-07-04'::DATE and '1991-08-04'::DATE AND\n                    uservisits.countrycode IN ('EST','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1991-07-04'::DATE and '1991-08-04'::DATE AND\n                    uservisits.countrycode IN ('EST','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_63",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'ARE'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2001-05-25'::DATE and '2001-06-25'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') AND uservisits.searchword IN ('oah') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2001-05-25'::DATE and '2001-06-25'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') AND uservisits.searchword IN ('oah') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2001-05-25'::DATE and '2001-06-25'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') \n                    AND uservisits.searchword IN ('oah') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2001-05-25'::DATE and '2001-06-25'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2001-07-25'::DATE and '2001-08-25'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2001-10-25'::DATE and '2001-11-25'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2001-10-25'::DATE and '2001-11-25'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2001-10-25'::DATE and '2001-11-25'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2001-10-25'::DATE and '2001-11-25'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2001-10-25'::DATE and '2001-11-25'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2001-10-25'::DATE and '2001-11-25'::DATE AND\n                    uservisits.countrycode IN ('ARE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_64",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'SYR'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1971-05-09'::DATE and '1971-06-09'::DATE AND\n                    uservisits.countrycode IN ('SYR','URY','MKD') AND uservisits.searchword IN ('gvqncvra') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1971-05-09'::DATE and '1971-06-09'::DATE AND\n                    uservisits.countrycode IN ('SYR','URY','MKD') AND uservisits.searchword IN ('gvqncvra') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1971-05-09'::DATE and '1971-06-09'::DATE AND\n                    uservisits.countrycode IN ('SYR','URY','MKD') \n                    AND uservisits.searchword IN ('gvqncvra') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1971-05-09'::DATE and '1971-06-09'::DATE AND\n                    uservisits.countrycode IN ('SYR','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1971-07-09'::DATE and '1971-08-09'::DATE AND\n                    uservisits.countrycode IN ('SYR','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1971-10-09'::DATE and '1971-11-09'::DATE AND\n                    uservisits.countrycode IN ('SYR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1971-10-09'::DATE and '1971-11-09'::DATE AND\n                    uservisits.countrycode IN ('SYR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1971-10-09'::DATE and '1971-11-09'::DATE AND\n                    uservisits.countrycode IN ('SYR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1971-10-09'::DATE and '1971-11-09'::DATE AND\n                    uservisits.countrycode IN ('SYR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1971-10-09'::DATE and '1971-11-09'::DATE AND\n                    uservisits.countrycode IN ('SYR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1971-10-09'::DATE and '1971-11-09'::DATE AND\n                    uservisits.countrycode IN ('SYR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_65",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'BLR'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1981-06-20'::DATE and '1981-07-20'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') AND uservisits.searchword IN ('jkiewhvgoy') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1981-06-20'::DATE and '1981-07-20'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') AND uservisits.searchword IN ('jkiewhvgoy') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1981-06-20'::DATE and '1981-07-20'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') \n                    AND uservisits.searchword IN ('jkiewhvgoy') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1981-06-20'::DATE and '1981-07-20'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1981-08-20'::DATE and '1981-09-20'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1981-11-20'::DATE and '1981-12-20'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1981-11-20'::DATE and '1981-12-20'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1981-11-20'::DATE and '1981-12-20'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1981-11-20'::DATE and '1981-12-20'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1981-11-20'::DATE and '1981-12-20'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1981-11-20'::DATE and '1981-12-20'::DATE AND\n                    uservisits.countrycode IN ('BLR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_66",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'SVN'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1994-03-23'::DATE and '1994-04-23'::DATE AND\n                    uservisits.countrycode IN ('SVN','URY','MKD') AND uservisits.searchword IN ('fjqilslkxj') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1994-03-23'::DATE and '1994-04-23'::DATE AND\n                    uservisits.countrycode IN ('SVN','URY','MKD') AND uservisits.searchword IN ('fjqilslkxj') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1994-03-23'::DATE and '1994-04-23'::DATE AND\n                    uservisits.countrycode IN ('SVN','URY','MKD') \n                    AND uservisits.searchword IN ('fjqilslkxj') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1994-03-23'::DATE and '1994-04-23'::DATE AND\n                    uservisits.countrycode IN ('SVN','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1994-05-23'::DATE and '1994-06-23'::DATE AND\n                    uservisits.countrycode IN ('SVN','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1994-08-23'::DATE and '1994-09-23'::DATE AND\n                    uservisits.countrycode IN ('SVN','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1994-08-23'::DATE and '1994-09-23'::DATE AND\n                    uservisits.countrycode IN ('SVN','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1994-08-23'::DATE and '1994-09-23'::DATE AND\n                    uservisits.countrycode IN ('SVN','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1994-08-23'::DATE and '1994-09-23'::DATE AND\n                    uservisits.countrycode IN ('SVN','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1994-08-23'::DATE and '1994-09-23'::DATE AND\n                    uservisits.countrycode IN ('SVN','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1994-08-23'::DATE and '1994-09-23'::DATE AND\n                    uservisits.countrycode IN ('SVN','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_67",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'FIN'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2005-12-01'::DATE and '2006-01-01'::DATE AND\n                    uservisits.countrycode IN ('FIN','URY','MKD') AND uservisits.searchword IN ('wcsamcbhbdkow') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2005-12-01'::DATE and '2006-01-01'::DATE AND\n                    uservisits.countrycode IN ('FIN','URY','MKD') AND uservisits.searchword IN ('wcsamcbhbdkow') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2005-12-01'::DATE and '2006-01-01'::DATE AND\n                    uservisits.countrycode IN ('FIN','URY','MKD') \n                    AND uservisits.searchword IN ('wcsamcbhbdkow') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2005-12-01'::DATE and '2006-01-01'::DATE AND\n                    uservisits.countrycode IN ('FIN','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2006-02-01'::DATE and '2006-03-01'::DATE AND\n                    uservisits.countrycode IN ('FIN','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2006-05-01'::DATE and '2006-06-01'::DATE AND\n                    uservisits.countrycode IN ('FIN','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2006-05-01'::DATE and '2006-06-01'::DATE AND\n                    uservisits.countrycode IN ('FIN','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2006-05-01'::DATE and '2006-06-01'::DATE AND\n                    uservisits.countrycode IN ('FIN','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2006-05-01'::DATE and '2006-06-01'::DATE AND\n                    uservisits.countrycode IN ('FIN','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2006-05-01'::DATE and '2006-06-01'::DATE AND\n                    uservisits.countrycode IN ('FIN','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2006-05-01'::DATE and '2006-06-01'::DATE AND\n                    uservisits.countrycode IN ('FIN','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_68",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'EST'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1972-09-26'::DATE and '1972-10-26'::DATE AND\n                    uservisits.countrycode IN ('EST','URY','MKD') AND uservisits.searchword IN ('cjlwldkcykkpvd') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1972-09-26'::DATE and '1972-10-26'::DATE AND\n                    uservisits.countrycode IN ('EST','URY','MKD') AND uservisits.searchword IN ('cjlwldkcykkpvd') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1972-09-26'::DATE and '1972-10-26'::DATE AND\n                    uservisits.countrycode IN ('EST','URY','MKD') \n                    AND uservisits.searchword IN ('cjlwldkcykkpvd') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1972-09-26'::DATE and '1972-10-26'::DATE AND\n                    uservisits.countrycode IN ('EST','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1972-11-26'::DATE and '1972-12-26'::DATE AND\n                    uservisits.countrycode IN ('EST','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1973-02-26'::DATE and '1973-03-26'::DATE AND\n                    uservisits.countrycode IN ('EST','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1973-02-26'::DATE and '1973-03-26'::DATE AND\n                    uservisits.countrycode IN ('EST','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1973-02-26'::DATE and '1973-03-26'::DATE AND\n                    uservisits.countrycode IN ('EST','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1973-02-26'::DATE and '1973-03-26'::DATE AND\n                    uservisits.countrycode IN ('EST','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1973-02-26'::DATE and '1973-03-26'::DATE AND\n                    uservisits.countrycode IN ('EST','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1973-02-26'::DATE and '1973-03-26'::DATE AND\n                    uservisits.countrycode IN ('EST','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_69",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'URY'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1982-11-08'::DATE and '1982-12-08'::DATE AND\n                    uservisits.countrycode IN ('URY','URY','MKD') AND uservisits.searchword IN ('qshdsxybqjxrd') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1982-11-08'::DATE and '1982-12-08'::DATE AND\n                    uservisits.countrycode IN ('URY','URY','MKD') AND uservisits.searchword IN ('qshdsxybqjxrd') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1982-11-08'::DATE and '1982-12-08'::DATE AND\n                    uservisits.countrycode IN ('URY','URY','MKD') \n                    AND uservisits.searchword IN ('qshdsxybqjxrd') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1982-11-08'::DATE and '1982-12-08'::DATE AND\n                    uservisits.countrycode IN ('URY','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1983-01-08'::DATE and '1983-02-08'::DATE AND\n                    uservisits.countrycode IN ('URY','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1983-04-08'::DATE and '1983-05-08'::DATE AND\n                    uservisits.countrycode IN ('URY','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1983-04-08'::DATE and '1983-05-08'::DATE AND\n                    uservisits.countrycode IN ('URY','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1983-04-08'::DATE and '1983-05-08'::DATE AND\n                    uservisits.countrycode IN ('URY','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1983-04-08'::DATE and '1983-05-08'::DATE AND\n                    uservisits.countrycode IN ('URY','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1983-04-08'::DATE and '1983-05-08'::DATE AND\n                    uservisits.countrycode IN ('URY','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1983-04-08'::DATE and '1983-05-08'::DATE AND\n                    uservisits.countrycode IN ('URY','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_70",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'MLT'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1992-10-17'::DATE and '1992-11-17'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') AND uservisits.searchword IN ('pokrkg') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1992-10-17'::DATE and '1992-11-17'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') AND uservisits.searchword IN ('pokrkg') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1992-10-17'::DATE and '1992-11-17'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND uservisits.searchword IN ('pokrkg') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1992-10-17'::DATE and '1992-11-17'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1992-12-17'::DATE and '1993-01-17'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1993-03-17'::DATE and '1993-04-17'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1993-03-17'::DATE and '1993-04-17'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1993-03-17'::DATE and '1993-04-17'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1993-03-17'::DATE and '1993-04-17'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1993-03-17'::DATE and '1993-04-17'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1993-03-17'::DATE and '1993-04-17'::DATE AND\n                    uservisits.countrycode IN ('MLT','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_71",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'CAN'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2004-06-27'::DATE and '2004-07-27'::DATE AND\n                    uservisits.countrycode IN ('CAN','URY','MKD') AND uservisits.searchword IN ('hkvjxuimde') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2004-06-27'::DATE and '2004-07-27'::DATE AND\n                    uservisits.countrycode IN ('CAN','URY','MKD') AND uservisits.searchword IN ('hkvjxuimde') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2004-06-27'::DATE and '2004-07-27'::DATE AND\n                    uservisits.countrycode IN ('CAN','URY','MKD') \n                    AND uservisits.searchword IN ('hkvjxuimde') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2004-06-27'::DATE and '2004-07-27'::DATE AND\n                    uservisits.countrycode IN ('CAN','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2004-08-27'::DATE and '2004-09-27'::DATE AND\n                    uservisits.countrycode IN ('CAN','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2004-11-27'::DATE and '2004-12-27'::DATE AND\n                    uservisits.countrycode IN ('CAN','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2004-11-27'::DATE and '2004-12-27'::DATE AND\n                    uservisits.countrycode IN ('CAN','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2004-11-27'::DATE and '2004-12-27'::DATE AND\n                    uservisits.countrycode IN ('CAN','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2004-11-27'::DATE and '2004-12-27'::DATE AND\n                    uservisits.countrycode IN ('CAN','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2004-11-27'::DATE and '2004-12-27'::DATE AND\n                    uservisits.countrycode IN ('CAN','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2004-11-27'::DATE and '2004-12-27'::DATE AND\n                    uservisits.countrycode IN ('CAN','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_72",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'ARG'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-03-10'::DATE and '1974-04-10'::DATE AND\n                    uservisits.countrycode IN ('ARG','URY','MKD') AND uservisits.searchword IN ('jeuehuniie') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-03-10'::DATE and '1974-04-10'::DATE AND\n                    uservisits.countrycode IN ('ARG','URY','MKD') AND uservisits.searchword IN ('jeuehuniie') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-03-10'::DATE and '1974-04-10'::DATE AND\n                    uservisits.countrycode IN ('ARG','URY','MKD') \n                    AND uservisits.searchword IN ('jeuehuniie') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-03-10'::DATE and '1974-04-10'::DATE AND\n                    uservisits.countrycode IN ('ARG','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-05-10'::DATE and '1974-06-10'::DATE AND\n                    uservisits.countrycode IN ('ARG','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-08-10'::DATE and '1974-09-10'::DATE AND\n                    uservisits.countrycode IN ('ARG','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-08-10'::DATE and '1974-09-10'::DATE AND\n                    uservisits.countrycode IN ('ARG','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-08-10'::DATE and '1974-09-10'::DATE AND\n                    uservisits.countrycode IN ('ARG','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-08-10'::DATE and '1974-09-10'::DATE AND\n                    uservisits.countrycode IN ('ARG','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-08-10'::DATE and '1974-09-10'::DATE AND\n                    uservisits.countrycode IN ('ARG','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-08-10'::DATE and '1974-09-10'::DATE AND\n                    uservisits.countrycode IN ('ARG','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_73",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'JOR'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1984-03-20'::DATE and '1984-04-20'::DATE AND\n                    uservisits.countrycode IN ('JOR','URY','MKD') AND uservisits.searchword IN ('ivxprxaq') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1984-03-20'::DATE and '1984-04-20'::DATE AND\n                    uservisits.countrycode IN ('JOR','URY','MKD') AND uservisits.searchword IN ('ivxprxaq') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1984-03-20'::DATE and '1984-04-20'::DATE AND\n                    uservisits.countrycode IN ('JOR','URY','MKD') \n                    AND uservisits.searchword IN ('ivxprxaq') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1984-03-20'::DATE and '1984-04-20'::DATE AND\n                    uservisits.countrycode IN ('JOR','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1984-05-20'::DATE and '1984-06-20'::DATE AND\n                    uservisits.countrycode IN ('JOR','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1984-08-20'::DATE and '1984-09-20'::DATE AND\n                    uservisits.countrycode IN ('JOR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1984-08-20'::DATE and '1984-09-20'::DATE AND\n                    uservisits.countrycode IN ('JOR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1984-08-20'::DATE and '1984-09-20'::DATE AND\n                    uservisits.countrycode IN ('JOR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1984-08-20'::DATE and '1984-09-20'::DATE AND\n                    uservisits.countrycode IN ('JOR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1984-08-20'::DATE and '1984-09-20'::DATE AND\n                    uservisits.countrycode IN ('JOR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1984-08-20'::DATE and '1984-09-20'::DATE AND\n                    uservisits.countrycode IN ('JOR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_74",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'ARG'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1997-01-22'::DATE and '1997-02-22'::DATE AND\n                    uservisits.countrycode IN ('ARG','URY','MKD') AND uservisits.searchword IN ('owd') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1997-01-22'::DATE and '1997-02-22'::DATE AND\n                    uservisits.countrycode IN ('ARG','URY','MKD') AND uservisits.searchword IN ('owd') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1997-01-22'::DATE and '1997-02-22'::DATE AND\n                    uservisits.countrycode IN ('ARG','URY','MKD') \n                    AND uservisits.searchword IN ('owd') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1997-01-22'::DATE and '1997-02-22'::DATE AND\n                    uservisits.countrycode IN ('ARG','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1997-03-22'::DATE and '1997-04-22'::DATE AND\n                    uservisits.countrycode IN ('ARG','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1997-06-22'::DATE and '1997-07-22'::DATE AND\n                    uservisits.countrycode IN ('ARG','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1997-06-22'::DATE and '1997-07-22'::DATE AND\n                    uservisits.countrycode IN ('ARG','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1997-06-22'::DATE and '1997-07-22'::DATE AND\n                    uservisits.countrycode IN ('ARG','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1997-06-22'::DATE and '1997-07-22'::DATE AND\n                    uservisits.countrycode IN ('ARG','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1997-06-22'::DATE and '1997-07-22'::DATE AND\n                    uservisits.countrycode IN ('ARG','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1997-06-22'::DATE and '1997-07-22'::DATE AND\n                    uservisits.countrycode IN ('ARG','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_75",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'CHE'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2008-08-31'::DATE and '2008-09-30'::DATE AND\n                    uservisits.countrycode IN ('CHE','URY','MKD') AND uservisits.searchword IN ('fuuxjrrxt') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2008-08-31'::DATE and '2008-09-30'::DATE AND\n                    uservisits.countrycode IN ('CHE','URY','MKD') AND uservisits.searchword IN ('fuuxjrrxt') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2008-08-31'::DATE and '2008-09-30'::DATE AND\n                    uservisits.countrycode IN ('CHE','URY','MKD') \n                    AND uservisits.searchword IN ('fuuxjrrxt') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2008-08-31'::DATE and '2008-09-30'::DATE AND\n                    uservisits.countrycode IN ('CHE','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2008-10-31'::DATE and '2008-11-30'::DATE AND\n                    uservisits.countrycode IN ('CHE','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2009-01-31'::DATE and '2009-02-28'::DATE AND\n                    uservisits.countrycode IN ('CHE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2009-01-31'::DATE and '2009-02-28'::DATE AND\n                    uservisits.countrycode IN ('CHE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2009-01-31'::DATE and '2009-02-28'::DATE AND\n                    uservisits.countrycode IN ('CHE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2009-01-31'::DATE and '2009-02-28'::DATE AND\n                    uservisits.countrycode IN ('CHE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2009-01-31'::DATE and '2009-02-28'::DATE AND\n                    uservisits.countrycode IN ('CHE','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2009-01-31'::DATE and '2009-02-28'::DATE AND\n                    uservisits.countrycode IN ('CHE','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_76",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'BHR'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1975-07-29'::DATE and '1975-08-29'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') AND uservisits.searchword IN ('sglmeg') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1975-07-29'::DATE and '1975-08-29'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') AND uservisits.searchword IN ('sglmeg') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1975-07-29'::DATE and '1975-08-29'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') \n                    AND uservisits.searchword IN ('sglmeg') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1975-07-29'::DATE and '1975-08-29'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1975-09-29'::DATE and '1975-10-29'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1975-12-29'::DATE and '1976-01-29'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1975-12-29'::DATE and '1976-01-29'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1975-12-29'::DATE and '1976-01-29'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1975-12-29'::DATE and '1976-01-29'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1975-12-29'::DATE and '1976-01-29'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1975-12-29'::DATE and '1976-01-29'::DATE AND\n                    uservisits.countrycode IN ('BHR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_77",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'MKD'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1985-08-08'::DATE and '1985-09-08'::DATE AND\n                    uservisits.countrycode IN ('MKD','URY','MKD') AND uservisits.searchword IN ('xhbpe') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1985-08-08'::DATE and '1985-09-08'::DATE AND\n                    uservisits.countrycode IN ('MKD','URY','MKD') AND uservisits.searchword IN ('xhbpe') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1985-08-08'::DATE and '1985-09-08'::DATE AND\n                    uservisits.countrycode IN ('MKD','URY','MKD') \n                    AND uservisits.searchword IN ('xhbpe') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1985-08-08'::DATE and '1985-09-08'::DATE AND\n                    uservisits.countrycode IN ('MKD','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1985-10-08'::DATE and '1985-11-08'::DATE AND\n                    uservisits.countrycode IN ('MKD','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-01-08'::DATE and '1986-02-08'::DATE AND\n                    uservisits.countrycode IN ('MKD','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-01-08'::DATE and '1986-02-08'::DATE AND\n                    uservisits.countrycode IN ('MKD','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-01-08'::DATE and '1986-02-08'::DATE AND\n                    uservisits.countrycode IN ('MKD','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-01-08'::DATE and '1986-02-08'::DATE AND\n                    uservisits.countrycode IN ('MKD','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-01-08'::DATE and '1986-02-08'::DATE AND\n                    uservisits.countrycode IN ('MKD','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-01-08'::DATE and '1986-02-08'::DATE AND\n                    uservisits.countrycode IN ('MKD','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_78",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'MAR'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1995-08-19'::DATE and '1995-09-19'::DATE AND\n                    uservisits.countrycode IN ('MAR','URY','MKD') AND uservisits.searchword IN ('dighybmcpbrbm') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1995-08-19'::DATE and '1995-09-19'::DATE AND\n                    uservisits.countrycode IN ('MAR','URY','MKD') AND uservisits.searchword IN ('dighybmcpbrbm') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1995-08-19'::DATE and '1995-09-19'::DATE AND\n                    uservisits.countrycode IN ('MAR','URY','MKD') \n                    AND uservisits.searchword IN ('dighybmcpbrbm') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1995-08-19'::DATE and '1995-09-19'::DATE AND\n                    uservisits.countrycode IN ('MAR','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1995-10-19'::DATE and '1995-11-19'::DATE AND\n                    uservisits.countrycode IN ('MAR','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1996-01-19'::DATE and '1996-02-19'::DATE AND\n                    uservisits.countrycode IN ('MAR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1996-01-19'::DATE and '1996-02-19'::DATE AND\n                    uservisits.countrycode IN ('MAR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1996-01-19'::DATE and '1996-02-19'::DATE AND\n                    uservisits.countrycode IN ('MAR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1996-01-19'::DATE and '1996-02-19'::DATE AND\n                    uservisits.countrycode IN ('MAR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1996-01-19'::DATE and '1996-02-19'::DATE AND\n                    uservisits.countrycode IN ('MAR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1996-01-19'::DATE and '1996-02-19'::DATE AND\n                    uservisits.countrycode IN ('MAR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_79",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'CUB'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2007-03-28'::DATE and '2007-04-28'::DATE AND\n                    uservisits.countrycode IN ('CUB','URY','MKD') AND uservisits.searchword IN ('tljlkassbcgb') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2007-03-28'::DATE and '2007-04-28'::DATE AND\n                    uservisits.countrycode IN ('CUB','URY','MKD') AND uservisits.searchword IN ('tljlkassbcgb') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2007-03-28'::DATE and '2007-04-28'::DATE AND\n                    uservisits.countrycode IN ('CUB','URY','MKD') \n                    AND uservisits.searchword IN ('tljlkassbcgb') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2007-03-28'::DATE and '2007-04-28'::DATE AND\n                    uservisits.countrycode IN ('CUB','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2007-05-28'::DATE and '2007-06-28'::DATE AND\n                    uservisits.countrycode IN ('CUB','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2007-08-28'::DATE and '2007-09-28'::DATE AND\n                    uservisits.countrycode IN ('CUB','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2007-08-28'::DATE and '2007-09-28'::DATE AND\n                    uservisits.countrycode IN ('CUB','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2007-08-28'::DATE and '2007-09-28'::DATE AND\n                    uservisits.countrycode IN ('CUB','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2007-08-28'::DATE and '2007-09-28'::DATE AND\n                    uservisits.countrycode IN ('CUB','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2007-08-28'::DATE and '2007-09-28'::DATE AND\n                    uservisits.countrycode IN ('CUB','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '2007-08-28'::DATE and '2007-09-28'::DATE AND\n                    uservisits.countrycode IN ('CUB','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_80",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'URY'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-02-17'::DATE and '1980-03-17'::DATE AND\n                    uservisits.countrycode IN ('URY','URY','MKD') AND uservisits.searchword IN ('nigfgndixfmygxqp') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-02-17'::DATE and '1980-03-17'::DATE AND\n                    uservisits.countrycode IN ('URY','URY','MKD') AND uservisits.searchword IN ('nigfgndixfmygxqp') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-02-17'::DATE and '1980-03-17'::DATE AND\n                    uservisits.countrycode IN ('URY','URY','MKD') \n                    AND uservisits.searchword IN ('nigfgndixfmygxqp') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-02-17'::DATE and '1980-03-17'::DATE AND\n                    uservisits.countrycode IN ('URY','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-04-17'::DATE and '1980-05-17'::DATE AND\n                    uservisits.countrycode IN ('URY','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-07-17'::DATE and '1980-08-17'::DATE AND\n                    uservisits.countrycode IN ('URY','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-07-17'::DATE and '1980-08-17'::DATE AND\n                    uservisits.countrycode IN ('URY','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-07-17'::DATE and '1980-08-17'::DATE AND\n                    uservisits.countrycode IN ('URY','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-07-17'::DATE and '1980-08-17'::DATE AND\n                    uservisits.countrycode IN ('URY','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-07-17'::DATE and '1980-08-17'::DATE AND\n                    uservisits.countrycode IN ('URY','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1980-07-17'::DATE and '1980-08-17'::DATE AND\n                    uservisits.countrycode IN ('URY','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q14_1",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '2010-05-15' AND uv.visitdate < '2010-06-15'\n    AND coalesce(uv.countrycode, '') = 'JOR'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_2",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1977-12-01' AND uv.visitdate < '1978-01-01'\n    AND coalesce(uv.countrycode, '') = 'SRB'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_3",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1998-02-24' AND uv.visitdate < '1998-03-27'\n    AND coalesce(uv.countrycode, '') = 'PRY'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_4",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1985-03-26' AND uv.visitdate < '1985-04-26'\n    AND coalesce(uv.countrycode, '') = 'TWN'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_5",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1972-10-31' AND uv.visitdate < '1972-12-01'\n    AND coalesce(uv.countrycode, '') = 'OMN'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_6",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1997-08-15' AND uv.visitdate < '1997-09-15'\n    AND coalesce(uv.countrycode, '') = 'MKD'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_7",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '2008-06-11' AND uv.visitdate < '2008-07-12'\n    AND coalesce(uv.countrycode, '') = 'MYS'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_8",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1974-03-17' AND uv.visitdate < '1974-04-17'\n    AND coalesce(uv.countrycode, '') = 'BIH'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_9",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1986-08-10' AND uv.visitdate < '1986-09-10'\n    AND coalesce(uv.countrycode, '') = 'UKR'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_10",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '2007-01-10' AND uv.visitdate < '2007-02-10'\n    AND coalesce(uv.countrycode, '') = 'HND'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_11",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1996-03-15' AND uv.visitdate < '1996-04-15'\n    AND coalesce(uv.countrycode, '') = 'PER'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_12",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1994-11-15' AND uv.visitdate < '1994-12-16'\n    AND coalesce(uv.countrycode, '') = 'PRT'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_13",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1970-01-31' AND uv.visitdate < '1970-03-03'\n    AND coalesce(uv.countrycode, '') = 'LBY'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_14",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '2005-08-10' AND uv.visitdate < '2005-09-10'\n    AND coalesce(uv.countrycode, '') = 'COL'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_15",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1982-05-25' AND uv.visitdate < '1982-06-25'\n    AND coalesce(uv.countrycode, '') = 'HUN'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_16",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1993-06-15' AND uv.visitdate < '1993-07-16'\n    AND coalesce(uv.countrycode, '') = 'BOL'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_17",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1983-10-09' AND uv.visitdate < '1983-11-09'\n    AND coalesce(uv.countrycode, '') = 'CHN'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_18",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '2004-03-10' AND uv.visitdate < '2004-04-10'\n    AND coalesce(uv.countrycode, '') = 'NLD'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_19",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1971-06-17' AND uv.visitdate < '1971-07-18'\n    AND coalesce(uv.countrycode, '') = 'PER'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_20",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1990-12-11' AND uv.visitdate < '1991-01-11'\n    AND coalesce(uv.countrycode, '') = 'POL'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_21",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '2003-01-30' AND uv.visitdate < '2003-03-02'\n    AND coalesce(uv.countrycode, '') = 'PAN'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_22",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1978-08-19' AND uv.visitdate < '1978-09-19'\n    AND coalesce(uv.countrycode, '') = 'SAU'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_23",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '2001-09-11' AND uv.visitdate < '2001-10-12'\n    AND coalesce(uv.countrycode, '') = 'LVA'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_24",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1992-05-16' AND uv.visitdate < '1992-06-16'\n    AND coalesce(uv.countrycode, '') = 'HND'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_25",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1980-01-23' AND uv.visitdate < '1980-02-23'\n    AND coalesce(uv.countrycode, '') = 'PER'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_26",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '2011-01-25' AND uv.visitdate < '2011-02-25'\n    AND coalesce(uv.countrycode, '') = 'MEX'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_27",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '2000-03-30' AND uv.visitdate < '2000-04-30'\n    AND coalesce(uv.countrycode, '') = 'BRA'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_28",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1988-03-12' AND uv.visitdate < '1988-04-12'\n    AND coalesce(uv.countrycode, '') = 'JOR'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_29",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1975-10-18' AND uv.visitdate < '1975-11-18'\n    AND coalesce(uv.countrycode, '') = 'PRY'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_30",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1977-03-23' AND uv.visitdate < '1977-04-23'\n    AND coalesce(uv.countrycode, '') = 'QAT'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_31",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '2009-09-06' AND uv.visitdate < '2009-10-07'\n    AND coalesce(uv.countrycode, '') = 'GBR'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_32",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1989-08-16' AND uv.visitdate < '1989-09-16'\n    AND coalesce(uv.countrycode, '') = 'NLD'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_33",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1998-11-10' AND uv.visitdate < '1998-12-11'\n    AND coalesce(uv.countrycode, '') = 'PER'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_34",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1996-12-07' AND uv.visitdate < '1997-01-07'\n    AND coalesce(uv.countrycode, '') = 'ARE'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_35",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '2009-02-25' AND uv.visitdate < '2009-03-28'\n    AND coalesce(uv.countrycode, '') = 'UKR'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_36",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1984-07-16' AND uv.visitdate < '1984-08-16'\n    AND coalesce(uv.countrycode, '') = 'HND'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_37",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1973-07-19' AND uv.visitdate < '1973-08-19'\n    AND coalesce(uv.countrycode, '') = 'PER'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_38",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1995-07-08' AND uv.visitdate < '1995-08-08'\n    AND coalesce(uv.countrycode, '') = 'OMN'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_39",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '2007-09-26' AND uv.visitdate < '2007-10-27'\n    AND coalesce(uv.countrycode, '') = 'ISL'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_40",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1985-11-30' AND uv.visitdate < '1985-12-31'\n    AND coalesce(uv.countrycode, '') = 'MYS'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_41",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1974-12-03' AND uv.visitdate < '1975-01-03'\n    AND coalesce(uv.countrycode, '') = 'MKD'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_42",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '2006-04-18' AND uv.visitdate < '2006-05-19'\n    AND coalesce(uv.countrycode, '') = 'CHN'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_43",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1970-10-11' AND uv.visitdate < '1970-11-11'\n    AND coalesce(uv.countrycode, '') = 'BOL'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_44",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1981-09-06' AND uv.visitdate < '1981-10-07'\n    AND coalesce(uv.countrycode, '') = 'NLD'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_45",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1994-03-01' AND uv.visitdate < '1994-04-01'\n    AND coalesce(uv.countrycode, '') = 'PER'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_46",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1972-02-25' AND uv.visitdate < '1972-03-27'\n    AND coalesce(uv.countrycode, '') = 'PRT'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_47",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1983-01-21' AND uv.visitdate < '1983-02-21'\n    AND coalesce(uv.countrycode, '') = 'COL'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_48",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1992-09-29' AND uv.visitdate < '1992-10-30'\n    AND coalesce(uv.countrycode, '') = 'LBY'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_49",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '2004-11-16' AND uv.visitdate < '2004-12-17'\n    AND coalesce(uv.countrycode, '') = 'HUN'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_50",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1979-05-07' AND uv.visitdate < '1979-06-07'\n    AND coalesce(uv.countrycode, '') = 'LVA'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_51",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1990-04-02' AND uv.visitdate < '1990-05-03'\n    AND coalesce(uv.countrycode, '') = 'UKR'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_52",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '2002-05-24' AND uv.visitdate < '2002-06-24'\n    AND coalesce(uv.countrycode, '') = 'PER'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_53",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1980-10-10' AND uv.visitdate < '1980-11-10'\n    AND coalesce(uv.countrycode, '') = 'PAN'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_54",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '2001-01-03' AND uv.visitdate < '2001-02-03'\n    AND coalesce(uv.countrycode, '') = 'SAU'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_55",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1991-09-06' AND uv.visitdate < '1991-10-07'\n    AND coalesce(uv.countrycode, '') = 'VEN'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_56",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1999-07-15' AND uv.visitdate < '1999-08-15'\n    AND coalesce(uv.countrycode, '') = 'QAT'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_57",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1987-06-25' AND uv.visitdate < '1987-07-26'\n    AND coalesce(uv.countrycode, '') = 'GBR'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_58",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '2011-10-03' AND uv.visitdate < '2011-11-03'\n    AND coalesce(uv.countrycode, '') = 'NLD'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_59",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1976-06-27' AND uv.visitdate < '1976-07-28'\n    AND coalesce(uv.countrycode, '') = 'PER'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_60",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1988-11-28' AND uv.visitdate < '1988-12-29'\n    AND coalesce(uv.countrycode, '') = 'MEX'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_61",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '2000-07-14' AND uv.visitdate < '2000-08-14'\n    AND coalesce(uv.countrycode, '') = 'LVA'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_62",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1987-09-16' AND uv.visitdate < '1987-10-17'\n    AND coalesce(uv.countrycode, '') = 'HND'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_63",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '2010-09-29' AND uv.visitdate < '2010-10-30'\n    AND coalesce(uv.countrycode, '') = 'UKR'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_64",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1976-04-09' AND uv.visitdate < '1976-05-10'\n    AND coalesce(uv.countrycode, '') = 'PER'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_65",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1989-02-15' AND uv.visitdate < '1989-03-18'\n    AND coalesce(uv.countrycode, '') = 'LBN'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_66",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1977-09-09' AND uv.visitdate < '1977-10-10'\n    AND coalesce(uv.countrycode, '') = 'SAU'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_67",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1999-02-28' AND uv.visitdate < '1999-03-31'\n    AND coalesce(uv.countrycode, '') = 'PAN'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_68",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '2009-05-15' AND uv.visitdate < '2009-06-15'\n    AND coalesce(uv.countrycode, '') = 'VEN'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_69",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1990-07-26' AND uv.visitdate < '1990-08-26'\n    AND coalesce(uv.countrycode, '') = 'NLD'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_70",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1979-01-16' AND uv.visitdate < '1979-02-16'\n    AND coalesce(uv.countrycode, '') = 'QAT'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_71",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '2003-04-22' AND uv.visitdate < '2003-05-23'\n    AND coalesce(uv.countrycode, '') = 'PER'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_72",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1980-06-17' AND uv.visitdate < '1980-07-18'\n    AND coalesce(uv.countrycode, '') = 'CHE'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_73",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '2012-03-24' AND uv.visitdate < '2012-04-24'\n    AND coalesce(uv.countrycode, '') = 'CHL'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_74",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '2001-12-06' AND uv.visitdate < '2002-01-06'\n    AND coalesce(uv.countrycode, '') = 'BGR'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_75",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1991-12-26' AND uv.visitdate < '1992-01-26'\n    AND coalesce(uv.countrycode, '') = 'JOR'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_76",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1981-12-26' AND uv.visitdate < '1982-01-26'\n    AND coalesce(uv.countrycode, '') = 'UKR'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_77",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '2005-05-20' AND uv.visitdate < '2005-06-20'\n    AND coalesce(uv.countrycode, '') = 'HND'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_78",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1970-06-18' AND uv.visitdate < '1970-07-19'\n    AND coalesce(uv.countrycode, '') = 'BIH'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_79",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1995-02-01' AND uv.visitdate < '1995-03-04'\n    AND coalesce(uv.countrycode, '') = 'PER'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_80",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1983-05-16' AND uv.visitdate < '1983-06-16'\n    AND coalesce(uv.countrycode, '') = 'DEU'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q15_1",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '17.%' and visitdate between '1971-01-15' and '1971-01-16' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_2",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '223%' and visitdate between '1981-10-08' and '1981-10-09' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_3",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '86.%' and visitdate between '1993-11-25' and '1993-11-26' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_4",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '14.%' and visitdate between '2006-03-17' and '2006-03-18' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_5",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '88.%' and visitdate between '1972-05-31' and '1972-06-01' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_6",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '69.%' and visitdate between '1983-02-22' and '1983-02-23' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_7",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '71.%' and visitdate between '1992-06-25' and '1992-06-26' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_8",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '101%' and visitdate between '2004-10-15' and '2004-10-16' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_9",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '142%' and visitdate between '1973-10-23' and '1973-10-24' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_10",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '128%' and visitdate between '1984-08-17' and '1984-08-18' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_11",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '204%' and visitdate between '1996-09-02' and '1996-09-03' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_12",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '33.%' and visitdate between '2009-01-24' and '2009-01-25' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_13",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '45.%' and visitdate between '1975-03-09' and '1975-03-10' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_14",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '127%' and visitdate between '1986-01-01' and '1986-01-02' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_15",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '108%' and visitdate between '1995-04-03' and '1995-04-04' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_16",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '50.%' and visitdate between '2007-08-25' and '2007-08-26' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_17",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '36.%' and visitdate between '1976-05-26' and '1976-05-27' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_18",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '10.%' and visitdate between '1987-03-21' and '1987-03-22' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_19",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '231%' and visitdate between '1999-08-16' and '1999-08-17' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_20",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '62.%' and visitdate between '2012-01-07' and '2012-01-08' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_21",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '246%' and visitdate between '1977-10-30' and '1977-10-31' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_22",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '233%' and visitdate between '1988-08-24' and '1988-08-25' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_23",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '227%' and visitdate between '1998-03-28' and '1998-03-29' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_24",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '207%' and visitdate between '2010-08-19' and '2010-08-20' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_25",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '40.%' and visitdate between '1979-04-05' and '1979-04-06' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_26",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '231%' and visitdate between '1989-12-27' and '1989-12-28' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_27",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '115%' and visitdate between '2002-06-25' and '2002-06-26' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_28",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '226%' and visitdate between '1980-09-08' and '1980-09-09' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_29",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '211%' and visitdate between '1991-06-02' and '1991-06-03' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_30",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '70.%' and visitdate between '2001-02-04' and '2001-02-05' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_31",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '188%' and visitdate between '1970-05-07' and '1970-05-08' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_32",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '220%' and visitdate between '1982-06-26' and '1982-06-27' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_33",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '8.1%' and visitdate between '1994-08-11' and '1994-08-12' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_34",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '221%' and visitdate between '2005-07-09' and '2005-07-10' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_35",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '90.%' and visitdate between '1971-09-21' and '1971-09-22' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_36",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '168%' and visitdate between '1983-11-10' and '1983-11-11' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_37",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '49.%' and visitdate between '1993-03-11' and '1993-03-12' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_38",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '254%' and visitdate between '2004-02-07' and '2004-02-08' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_39",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '237%' and visitdate between '1973-02-04' and '1973-02-05' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_40",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '229%' and visitdate between '1985-04-27' and '1985-04-28' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_41",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '191%' and visitdate between '1997-05-11' and '1997-05-12' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_42",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '58.%' and visitdate between '2008-05-10' and '2008-05-11' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_43",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '107%' and visitdate between '1974-06-21' and '1974-06-22' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_44",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '151%' and visitdate between '1986-09-11' and '1986-09-12' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_45",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '70.%' and visitdate between '1995-12-10' and '1995-12-11' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_46",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '203%' and visitdate between '2006-12-09' and '2006-12-10' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_47",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '112%' and visitdate between '1975-09-16' and '1975-09-17' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_48",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '194%' and visitdate between '1987-12-07' and '1987-12-08' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_49",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '247%' and visitdate between '2000-05-01' and '2000-05-02' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_50",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '102%' and visitdate between '2011-05-01' and '2011-05-02' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_51",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '186%' and visitdate between '1977-02-19' and '1977-02-20' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_52",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '115%' and visitdate between '1989-05-12' and '1989-05-13' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_53",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '43.%' and visitdate between '1998-12-12' and '1998-12-13' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_54",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '209%' and visitdate between '2009-12-11' and '2009-12-12' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_55",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '81.%' and visitdate between '1978-07-18' and '1978-07-19' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_56",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '98.%' and visitdate between '1990-09-06' and '1990-09-07' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_57",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '112%' and visitdate between '2003-03-03' and '2003-03-04' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_58",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '165%' and visitdate between '1979-12-22' and '1979-12-23' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_59",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '240%' and visitdate between '1992-02-10' and '1992-02-11' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_60",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '95.%' and visitdate between '2001-10-13' and '2001-10-14' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_61",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '165%' and visitdate between '1981-02-02' and '1981-02-03' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_62",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '112%' and visitdate between '1991-04-20' and '1991-04-21' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_63",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '131%' and visitdate between '2001-04-28' and '2001-04-29' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_64",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '222%' and visitdate between '1979-09-15' and '1979-09-16' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_65",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '102%' and visitdate between '1989-11-30' and '1989-12-01' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_66",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '99.%' and visitdate between '2002-10-02' and '2002-10-03' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_67",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '210%' and visitdate between '1978-04-03' and '1978-04-04' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_68",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '96.%' and visitdate between '1988-07-20' and '1988-07-21' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_69",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '221%' and visitdate between '1998-06-27' and '1998-06-28' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_70",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '107%' and visitdate between '2010-01-04' and '2010-01-05' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_71",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '247%' and visitdate between '1976-11-13' and '1976-11-14' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_72",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '247%' and visitdate between '1987-03-02' and '1987-03-03' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_73",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '47.%' and visitdate between '1999-12-01' and '1999-12-02' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_74",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '91.%' and visitdate between '2011-06-10' and '2011-06-11' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_75",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '195%' and visitdate between '1975-04-13' and '1975-04-14' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_76",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '207%' and visitdate between '1985-07-30' and '1985-07-31' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_77",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '183%' and visitdate between '1995-11-16' and '1995-11-17' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_78",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '4.1%' and visitdate between '2007-05-26' and '2007-05-27' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_79",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '234%' and visitdate between '1973-11-11' and '1973-11-12' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_80",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '59.%' and visitdate between '1984-02-28' and '1984-02-29' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        }
    ],
    "sessions": [
        {
            "sess_id": "session1",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q12_1"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q3_1"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q7_1"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q11_1"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q1_1"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q13_1"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q14_1"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q4_1"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q5_1"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q6_1"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q15_1"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q10_1"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q2_1"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q9_1"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q8_1"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session2",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q9_2"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q11_2"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q10_2"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q6_2"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q1_2"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q2_2"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q14_2"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q8_2"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q13_2"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q5_2"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q3_2"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q7_2"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q15_2"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q12_2"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q4_2"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session3",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q15_3"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q14_3"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q4_3"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q13_3"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q10_3"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q7_3"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q9_3"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q2_3"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q11_3"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q8_3"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q6_3"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q1_3"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q5_3"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q12_3"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q3_3"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session4",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q6_4"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q10_4"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q2_4"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q4_4"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q13_4"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q11_4"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q14_4"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q3_4"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q8_4"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q15_4"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q9_4"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q1_4"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q12_4"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q5_4"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q7_4"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session5",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q7_5"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q15_5"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q4_5"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q1_5"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q14_5"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q12_5"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q13_5"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q5_5"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q9_5"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q2_5"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q8_5"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q3_5"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q10_5"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q6_5"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q11_5"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session6",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q4_6"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q6_6"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q2_6"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q13_6"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q11_6"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q7_6"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q10_6"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q5_6"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q15_6"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q9_6"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q3_6"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q14_6"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q1_6"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q8_6"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q12_6"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session7",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q6_7"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q8_7"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q5_7"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q3_7"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q9_7"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q1_7"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q2_7"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q12_7"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q7_7"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q13_7"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q4_7"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q15_7"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q11_7"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q14_7"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q10_7"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session8",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q8_8"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q13_8"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q15_8"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q4_8"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q9_8"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q14_8"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q12_8"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q11_8"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q3_8"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q7_8"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q6_8"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q5_8"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q10_8"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q1_8"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q2_8"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session9",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q7_9"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q2_9"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q8_9"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q12_9"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q10_9"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q15_9"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q3_9"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q13_9"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q6_9"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q5_9"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q14_9"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q9_9"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q1_9"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q11_9"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q4_9"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session10",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q8_10"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q4_10"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q9_10"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q6_10"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q7_10"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q2_10"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q10_10"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q11_10"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q12_10"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q1_10"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q15_10"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q13_10"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q3_10"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q14_10"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q5_10"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session11",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q11_11"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q5_11"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q14_11"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q15_11"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q7_11"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q4_11"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q13_11"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q6_11"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q9_11"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q10_11"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q1_11"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q12_11"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q2_11"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q8_11"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q3_11"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session12",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q2_12"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q10_12"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q8_12"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q7_12"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q3_12"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q5_12"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q15_12"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q4_12"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q6_12"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q1_12"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q14_12"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q9_12"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q12_12"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q11_12"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q13_12"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session13",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q11_13"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q6_13"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q15_13"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q10_13"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q7_13"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q8_13"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q5_13"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q3_13"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q9_13"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q14_13"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q13_13"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q12_13"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q2_13"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q4_13"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q1_13"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session14",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q10_14"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q8_14"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q12_14"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q7_14"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q1_14"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q11_14"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q5_14"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q15_14"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q4_14"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q6_14"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q2_14"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q9_14"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q14_14"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q3_14"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q13_14"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session15",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q9_15"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q11_15"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q14_15"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q1_15"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q2_15"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q8_15"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q10_15"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q5_15"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q3_15"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q6_15"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q7_15"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q15_15"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q13_15"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q12_15"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q4_15"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session16",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q9_16"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q2_16"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q14_16"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q5_16"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q6_16"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q10_16"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q7_16"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q11_16"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q3_16"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q15_16"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q1_16"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q12_16"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q4_16"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q13_16"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q8_16"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session17",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q1_17"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q2_17"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q5_17"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q12_17"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q15_17"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q3_17"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q13_17"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q7_17"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q10_17"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q6_17"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q11_17"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q8_17"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q9_17"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q14_17"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q4_17"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session18",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q4_18"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q8_18"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q5_18"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q7_18"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q15_18"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q9_18"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q14_18"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q10_18"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q12_18"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q3_18"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q11_18"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q6_18"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q1_18"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q13_18"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q2_18"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session19",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q3_19"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q5_19"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q13_19"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q7_19"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q11_19"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q4_19"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q12_19"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q10_19"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q2_19"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q1_19"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q14_19"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q8_19"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q6_19"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q15_19"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q9_19"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session20",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q5_20"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q3_20"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q14_20"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q8_20"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q4_20"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q11_20"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q12_20"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q15_20"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q9_20"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q2_20"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q1_20"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q10_20"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q7_20"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q6_20"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q13_20"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session21",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q7_21"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q5_21"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q15_21"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q10_21"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q3_21"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q4_21"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q6_21"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q9_21"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q8_21"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q1_21"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q14_21"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q11_21"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q2_21"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q13_21"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q12_21"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session22",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q7_22"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q15_22"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q12_22"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q8_22"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q6_22"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q5_22"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q10_22"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q4_22"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q14_22"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q9_22"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q2_22"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q3_22"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q1_22"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q13_22"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q11_22"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session23",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q11_23"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q8_23"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q15_23"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q6_23"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q5_23"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q9_23"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q13_23"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q10_23"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q7_23"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q1_23"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q4_23"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q12_23"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q14_23"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q3_23"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q2_23"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session24",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q9_24"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q10_24"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q3_24"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q5_24"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q14_24"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q6_24"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q2_24"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q7_24"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q8_24"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q11_24"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q12_24"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q13_24"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q4_24"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q15_24"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q1_24"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session25",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q10_25"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q12_25"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q13_25"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q5_25"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q3_25"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q7_25"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q14_25"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q2_25"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q1_25"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q11_25"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q6_25"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q9_25"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q8_25"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q4_25"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q15_25"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session26",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q13_26"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q9_26"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q11_26"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q3_26"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q2_26"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q7_26"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q4_26"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q15_26"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q8_26"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q12_26"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q1_26"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q6_26"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q10_26"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q14_26"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q5_26"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session27",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q15_27"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q5_27"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q6_27"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q1_27"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q14_27"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q11_27"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q7_27"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q13_27"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q4_27"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q8_27"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q3_27"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q12_27"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q2_27"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q10_27"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q9_27"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session28",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q12_28"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q13_28"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q7_28"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q3_28"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q14_28"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q15_28"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q5_28"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q2_28"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q6_28"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q9_28"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q11_28"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q8_28"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q4_28"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q10_28"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q1_28"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session29",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q12_29"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q11_29"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q1_29"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q5_29"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q15_29"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q8_29"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q9_29"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q7_29"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q3_29"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q2_29"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q6_29"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q14_29"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q4_29"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q10_29"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q13_29"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session30",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q12_30"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q9_30"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q8_30"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q13_30"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q7_30"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q1_30"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q4_30"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q11_30"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q10_30"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q3_30"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q2_30"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q6_30"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q14_30"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q5_30"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q15_30"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session31",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q2_31"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q7_31"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q14_31"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q13_31"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q9_31"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q4_31"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q3_31"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q5_31"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q15_31"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q1_31"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q12_31"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q8_31"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q6_31"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q11_31"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q10_31"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session32",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q5_32"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q10_32"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q7_32"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q4_32"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q6_32"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q11_32"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q15_32"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q13_32"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q9_32"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q14_32"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q12_32"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q1_32"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q2_32"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q3_32"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q8_32"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session33",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q13_33"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q5_33"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q2_33"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q12_33"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q8_33"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q15_33"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q3_33"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q9_33"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q11_33"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q4_33"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q1_33"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q10_33"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q6_33"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q14_33"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q7_33"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session34",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q11_34"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q3_34"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q15_34"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q8_34"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q4_34"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q13_34"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q9_34"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q14_34"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q5_34"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q1_34"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q2_34"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q12_34"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q6_34"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q7_34"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q10_34"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session35",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q8_35"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q10_35"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q11_35"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q3_35"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q15_35"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q6_35"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q4_35"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q7_35"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q2_35"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q12_35"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q13_35"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q1_35"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q14_35"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q5_35"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q9_35"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session36",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q13_36"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q3_36"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q14_36"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q11_36"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q10_36"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q4_36"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q12_36"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q5_36"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q15_36"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q1_36"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q7_36"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q9_36"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q6_36"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q2_36"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q8_36"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session37",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q1_37"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q10_37"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q9_37"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q8_37"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q12_37"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q5_37"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q6_37"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q14_37"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q11_37"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q4_37"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q15_37"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q13_37"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q2_37"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q7_37"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q3_37"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session38",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q1_38"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q10_38"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q13_38"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q2_38"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q12_38"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q4_38"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q15_38"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q9_38"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q3_38"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q5_38"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q6_38"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q14_38"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q11_38"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q8_38"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q7_38"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session39",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q1_39"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q5_39"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q10_39"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q11_39"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q6_39"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q8_39"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q12_39"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q2_39"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q15_39"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q14_39"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q4_39"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q9_39"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q13_39"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q3_39"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q7_39"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session40",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q8_40"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q13_40"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q11_40"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q12_40"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q1_40"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q3_40"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q14_40"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q9_40"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q15_40"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q10_40"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q6_40"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q4_40"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q2_40"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q7_40"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q5_40"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session41",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q5_41"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q7_41"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q2_41"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q11_41"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q10_41"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q8_41"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q3_41"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q1_41"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q15_41"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q4_41"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q13_41"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q14_41"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q9_41"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q6_41"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q12_41"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session42",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q13_42"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q10_42"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q2_42"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q7_42"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q1_42"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q4_42"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q15_42"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q12_42"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q14_42"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q11_42"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q8_42"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q6_42"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q5_42"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q9_42"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q3_42"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session43",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q15_43"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q10_43"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q9_43"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q5_43"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q3_43"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q2_43"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q12_43"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q11_43"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q7_43"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q6_43"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q13_43"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q4_43"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q8_43"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q1_43"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q14_43"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session44",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q12_44"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q14_44"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q1_44"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q8_44"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q11_44"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q15_44"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q13_44"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q7_44"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q5_44"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q10_44"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q6_44"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q2_44"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q3_44"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q4_44"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q9_44"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session45",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q1_45"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q4_45"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q5_45"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q8_45"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q13_45"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q15_45"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q7_45"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q3_45"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q9_45"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q6_45"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q12_45"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q10_45"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q11_45"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q14_45"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q2_45"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session46",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q1_46"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q8_46"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q7_46"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q14_46"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q12_46"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q5_46"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q10_46"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q6_46"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q13_46"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q4_46"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q15_46"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q2_46"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q11_46"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q9_46"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q3_46"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session47",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q4_47"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q6_47"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q11_47"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q8_47"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q2_47"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q13_47"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q3_47"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q10_47"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q9_47"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q5_47"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q1_47"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q14_47"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q7_47"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q12_47"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q15_47"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session48",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q3_48"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q2_48"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q6_48"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q12_48"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q9_48"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q7_48"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q14_48"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q10_48"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q8_48"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q4_48"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q11_48"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q5_48"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q1_48"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q13_48"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q15_48"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session49",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q5_49"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q11_49"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q4_49"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q2_49"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q3_49"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q13_49"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q1_49"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q15_49"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q10_49"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q6_49"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q12_49"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q9_49"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q8_49"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q14_49"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q7_49"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session50",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q10_50"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q15_50"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q9_50"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q7_50"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q5_50"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q13_50"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q12_50"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q2_50"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q4_50"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q6_50"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q11_50"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q14_50"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q3_50"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q1_50"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q8_50"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session51",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q12_51"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q8_51"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q4_51"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q9_51"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q5_51"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q15_51"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q2_51"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q3_51"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q1_51"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q6_51"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q13_51"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q7_51"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q10_51"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q11_51"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q14_51"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session52",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q5_52"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q2_52"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q8_52"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q14_52"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q3_52"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q13_52"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q10_52"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q11_52"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q15_52"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q6_52"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q9_52"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q7_52"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q4_52"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q1_52"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q12_52"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session53",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q10_53"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q1_53"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q15_53"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q12_53"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q14_53"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q13_53"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q3_53"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q2_53"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q6_53"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q7_53"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q11_53"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q5_53"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q8_53"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q9_53"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q4_53"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session54",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q1_54"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q2_54"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q4_54"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q10_54"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q15_54"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q7_54"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q9_54"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q14_54"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q11_54"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q12_54"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q8_54"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q5_54"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q6_54"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q3_54"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q13_54"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session55",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q10_55"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q7_55"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q3_55"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q15_55"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q5_55"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q13_55"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q12_55"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q2_55"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q9_55"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q11_55"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q1_55"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q8_55"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q14_55"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q6_55"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q4_55"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session56",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q4_56"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q6_56"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q3_56"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q9_56"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q8_56"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q11_56"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q12_56"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q1_56"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q7_56"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q5_56"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q10_56"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q15_56"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q14_56"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q13_56"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q2_56"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session57",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q7_57"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q4_57"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q3_57"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q10_57"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q12_57"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q9_57"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q15_57"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q2_57"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q5_57"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q6_57"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q1_57"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q11_57"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q13_57"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q8_57"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q14_57"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session58",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q3_58"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q4_58"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q14_58"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q15_58"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q1_58"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q13_58"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q9_58"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q11_58"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q2_58"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q8_58"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q7_58"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q10_58"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q6_58"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q5_58"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q12_58"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session59",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q6_59"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q11_59"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q12_59"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q7_59"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q4_59"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q10_59"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q2_59"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q14_59"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q3_59"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q13_59"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q8_59"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q9_59"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q15_59"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q1_59"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q5_59"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session60",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q1_60"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q15_60"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q3_60"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q12_60"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q11_60"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q8_60"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q4_60"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q9_60"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q2_60"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q14_60"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q13_60"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q7_60"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q5_60"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q10_60"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q6_60"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session61",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q2_61"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q11_61"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q3_61"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q9_61"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q7_61"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q1_61"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q6_61"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q8_61"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q10_61"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q15_61"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q4_61"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q13_61"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q5_61"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q12_61"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q14_61"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session62",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q8_62"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q3_62"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q12_62"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q15_62"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q5_62"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q14_62"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q9_62"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q2_62"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q6_62"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q4_62"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q1_62"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q10_62"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q7_62"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q11_62"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q13_62"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session63",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q7_63"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q2_63"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q4_63"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q6_63"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q13_63"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q10_63"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q5_63"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q3_63"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q9_63"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q11_63"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q15_63"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q14_63"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q1_63"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q12_63"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q8_63"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session64",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q15_64"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q8_64"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q12_64"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q6_64"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q11_64"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q13_64"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q14_64"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q4_64"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q5_64"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q7_64"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q9_64"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q10_64"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q1_64"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q2_64"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q3_64"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session65",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q2_65"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q15_65"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q8_65"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q7_65"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q11_65"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q14_65"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q4_65"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q1_65"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q12_65"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q5_65"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q3_65"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q13_65"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q6_65"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q9_65"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q10_65"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session66",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q10_66"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q8_66"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q12_66"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q14_66"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q4_66"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q13_66"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q5_66"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q2_66"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q9_66"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q11_66"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q7_66"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q15_66"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q1_66"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q6_66"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q3_66"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session67",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q13_67"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q4_67"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q6_67"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q14_67"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q11_67"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q7_67"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q15_67"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q9_67"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q2_67"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q10_67"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q3_67"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q8_67"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q12_67"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q5_67"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q1_67"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session68",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q7_68"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q12_68"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q6_68"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q4_68"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q15_68"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q14_68"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q3_68"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q1_68"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q5_68"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q8_68"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q11_68"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q13_68"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q2_68"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q10_68"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q9_68"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session69",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q10_69"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q9_69"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q5_69"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q12_69"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q3_69"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q15_69"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q7_69"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q6_69"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q2_69"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q11_69"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q13_69"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q14_69"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q8_69"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q4_69"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q1_69"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session70",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q12_70"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q15_70"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q8_70"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q6_70"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q3_70"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q11_70"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q10_70"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q7_70"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q4_70"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q13_70"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q2_70"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q5_70"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q9_70"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q14_70"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q1_70"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session71",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q11_71"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q10_71"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q5_71"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q6_71"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q12_71"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q3_71"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q15_71"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q2_71"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q1_71"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q14_71"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q13_71"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q4_71"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q7_71"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q9_71"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q8_71"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session72",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q6_72"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q4_72"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q9_72"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q12_72"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q3_72"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q11_72"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q1_72"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q5_72"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q2_72"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q7_72"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q8_72"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q15_72"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q13_72"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q10_72"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q14_72"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session73",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q2_73"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q12_73"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q10_73"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q8_73"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q1_73"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q3_73"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q4_73"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q13_73"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q11_73"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q6_73"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q5_73"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q14_73"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q15_73"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q7_73"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q9_73"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session74",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q14_74"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q5_74"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q6_74"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q1_74"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q15_74"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q11_74"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q9_74"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q7_74"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q13_74"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q12_74"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q8_74"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q10_74"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q4_74"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q2_74"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q3_74"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session75",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q7_75"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q12_75"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q4_75"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q3_75"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q1_75"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q14_75"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q9_75"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q11_75"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q5_75"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q15_75"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q13_75"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q8_75"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q6_75"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q2_75"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q10_75"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session76",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q2_76"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q11_76"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q15_76"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q12_76"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q7_76"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q14_76"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q13_76"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q3_76"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q6_76"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q4_76"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q5_76"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q10_76"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q1_76"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q9_76"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q8_76"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session77",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q8_77"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q10_77"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q3_77"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q9_77"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q1_77"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q14_77"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q13_77"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q7_77"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q2_77"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q15_77"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q12_77"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q5_77"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q4_77"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q6_77"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q11_77"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session78",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q10_78"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q5_78"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q9_78"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q12_78"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q13_78"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q4_78"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q8_78"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q14_78"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q7_78"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q15_78"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q11_78"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q2_78"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q1_78"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q6_78"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q3_78"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session79",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q7_79"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q15_79"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q8_79"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q14_79"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q2_79"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q9_79"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q4_79"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q3_79"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q11_79"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q1_79"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q6_79"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q5_79"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q10_79"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q13_79"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q12_79"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session80",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q3_80"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q9_80"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q8_80"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q13_80"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q11_80"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q1_80"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q6_80"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q12_80"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q7_80"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q5_80"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q14_80"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q10_80"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q4_80"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q2_80"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q15_80"
                    ],
                    "start_time": 15
                }
            ]
        }
    ]
}