{
    "sqls": [
        {
            "sql_id": "app_q1_1",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1987-01-06' AND '1987-01-20')\nAND sourceip IN ('39.36.179.195')\nAND countrycode = 'BEL';"
        },
        {
            "sql_id": "app_q1_2",
            "sql_text": "SELECT visitdate, sourceip, adrevenue \nFROM uservisits \nWHERE (visitdate BETWEEN '1990-06-27' AND '1990-07-11')\nAND sourceip IN ('158.78.99.24')\nAND countrycode = 'AUT';"
        },
        {
            "sql_id": "app_q2_1",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.66.158')\n            and countrycode < 'zzz'\n            and visitdate between '1971-07-01' and '1971-07-06'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.101.15')\n            and countrycode < 'zzz'\n            and visitdate between '1971-07-01' and '1971-07-06'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q2_2",
            "sql_text": "with desktop as ( \n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('99.99.92.183')\n            and countrycode < 'zzz'\n            and visitdate between '1983-09-21' and '1983-09-26'\n            and useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)'\n            group by sourceip,countrycode,year_month_day), \n mobile as (\n            select \n            date_trunc('month', visitdate) as year_month_day,\n            sourceip,\n            countrycode, \n            count(*) as visits,\n            sum(adrevenue) as adrevenue, \n            count(distinct languagecode)  as languagecode, \n            max(length(searchword)) as searchwordlength,\n            sum(duration) as time_on_site\n            from uservisits\n            where sourceip in ('1.0.162.183')\n            and countrycode < 'zzz'\n            and visitdate between '1983-09-21' and '1983-09-26'\n            and useragent = 'Iewmrdjfnkarrwndwgfu/7.7'\n            group by sourceip,countrycode,year_month_day)\nselect \n    COALESCE(desktop.year_month_day,mobile.year_month_day) as year_month_day,\n    COALESCE(desktop.sourceip,mobile.sourceip) as site,\n    COALESCE(desktop.countrycode,mobile.countrycode) as countrycode,\n    COALESCE(desktop.visits,0) + COALESCE(mobile.visits,0) as visits,\n    COALESCE(desktop.adrevenue,0)+ COALESCE(mobile.adrevenue,0) as page_views,\n    COALESCE(desktop.searchwordlength,0) + COALESCE(mobile.searchwordlength,0) as searchwordlength,\n    COALESCE(desktop.time_on_site,0) + COALESCE(mobile.time_on_site,0) as time_on_site\nfrom desktop\nfull outer join mobile on \nmobile.year_month_day = desktop.year_month_day AND\nmobile.sourceip = desktop.sourceip AND\nmobile.countrycode = desktop.countrycode\n;"
        },
        {
            "sql_id": "app_q3_1",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '146.238.21.87' and visitdate between '1978-09-06' and '1978-09-07'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q3_2",
            "sql_text": "SELECT languagecode,\n    MAX(visitdate) AS visitdate,\n    ARRAY_JOIN(ARRAY_AGG(countrycode), ',') AS countrycode\nFROM uservisits\nWHERE sourceip = '126.186.229.163' and visitdate between '1990-11-27' and '1990-11-28'\nGROUP BY languagecode;"
        },
        {
            "sql_id": "app_q4_1",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '6.231.88.53' and visitdate between '1975-06-02' and '1975-06-03';"
        },
        {
            "sql_id": "app_q4_2",
            "sql_text": "SELECT *\nFROM uservisits\nWHERE sourceip = '88.243.88.91' and visitdate between '1985-06-14' and '1985-06-15';"
        },
        {
            "sql_id": "app_q5_1",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1976-07-15' and '1976-07-16') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q5_2",
            "sql_text": "WITH filtered_uservisits AS( SELECT *     \n  FROM uservisits     \n  WHERE visitdate between '1987-06-11' and '1987-06-12') \n  SELECT allowed_records.destinationurl, COUNT(*) OVER () as total_uservisits_count \n  FROM filtered_uservisits JOIN ( SELECT destinationurl \n  \t\t\t\t\t\t\tFROM filtered_uservisits \n  \t\t\t\t\t\t\tORDER BY duration DESC LIMIT 100 ) AS allowed_records ON allowed_records.destinationurl = filtered_uservisits.destinationurl \n  ORDER BY adrevenue desc LIMIT 20 OFFSET 0;"
        },
        {
            "sql_id": "app_q6_1",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '139.2.152.157' and visitdate = '1976-05-12';"
        },
        {
            "sql_id": "app_q6_2",
            "sql_text": "SELECT COUNT(*) as c FROM uservisits WHERE sourceip = '141.141.113.5' and visitdate = '1987-04-08';"
        },
        {
            "sql_id": "app_q7_1",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1972-03-21' AND visitdate <= DATE_ADD('DAY', 1, '1972-03-21'));"
        },
        {
            "sql_id": "app_q7_2",
            "sql_text": "SELECT max(visitdate) as latest_visit\nFROM uservisits\nWHERE (visitdate >= '1983-01-16' AND visitdate <= DATE_ADD('DAY', 1, '1983-01-16'));"
        },
        {
            "sql_id": "app_q8_1",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1974-02-24' AND visitdate <= DATE_ADD('DAY', 1, '1974-02-24'))\n        AND languagecode IN ('FIN-FI','MLT-MT','CUB-ES','BLR-BE','GRC-EL','HUN-HU','MEX-ES','ISL-IS')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q8_2",
            "sql_text": "SELECT date_trunc('month', visitdate) as year_month_day,\nCOALESCE(SUM(duration), 0) as installs,\nCOALESCE(SUM(length(searchword)), 0) as billingCost,\nSUM(CASE WHEN adrevenue <= 1.5 THEN duration ELSE 0 END) as revenueD7\nFROM uservisits\nWHERE (visitdate >= '1984-04-07' AND visitdate <= DATE_ADD('DAY', 1, '1984-04-07'))\n        AND languagecode IN ('IRL-EN','SVK-SK','VEN-ES','CRI-ES','MNE-SR','FIN-FI','MAR-AR','MAR-AR')\nGROUP BY 1\nORDER BY 1;"
        },
        {
            "sql_id": "app_q9_1",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.19305812655537044 and 0.5973057863688664 and visitdate between '1973-12-22' and '1973-12-28'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q9_2",
            "sql_text": "select destinationurl\nfrom uservisits\nwhere adrevenue between 0.11521078820019848 and 0.4752965607809379 and visitdate between '1984-02-03' and '1984-02-09'\ngroup by destinationurl having count(*) > 100;"
        },
        {
            "sql_id": "app_q10_1",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 263\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q10_2",
            "sql_text": "with busiest_days as (\n  select visitdate, count(*)\n  from uservisits\n  group by 1\n  order by 2 desc\n  limit 194\n)\nselect countrycode, avg(length(searchword))\nfrom uservisits\nwhere visitdate in (select visitdate from busiest_days)\ngroup by countrycode;"
        },
        {
            "sql_id": "app_q11_1",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1974-02-24'\n  and searchword in ('sxmgkfwg','ihreoyl','quh','isjnejcbt','pqrmt','nktythyspxxbkhqjg')\nLimit 65;"
        },
        {
            "sql_id": "app_q11_2",
            "sql_text": "SELECT searchword, useragent, languagecode\nfrom uservisits \nwhere countrycode = 'ZAF'\n  and visitdate = '1984-04-07'\n  and searchword in ('sxmgkfwg','bcnmiujeyjyfvfu','ocwh','ocwh','hqrvhf','lahkr')\nLimit 65;"
        },
        {
            "sql_id": "app_q12_1",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '1995-10-07' and visitdate <= '1995-11-06' AND\n  countrycode in ( 'UKR','DZA','CUB','ECU','CHE','CHE','LUX','QAT','POL','BHR') AND\n  languagecode in ( 'UKR-UK','DZA-AR','CUB-ES','ECU-ES','CHE-IT','CHE-FR','LUX-DE','QAT-AR','POL-PL','BHR-AR') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML like Gecko) Chrome/xxx','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Hqygxeaiogi/1.6','Opera 7.51 (Win XP): Opera/7.51 (Windows NT 5.1; U)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)','Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q12_2",
            "sql_text": "SELECT\n  countrycode,\n  languagecode,\n  COUNT(DISTINCT visitdate) AS days_with_data,\n  MAX(visitdate) last_visit,\n  SUM(adrevenue) sum_adrevenue,\n  MAX(adrevenue) max_adrevenue,\n  COUNT(*) cnt\nFROM\n  uservisits\nWHERE\n  visitdate >= '2006-11-08' and visitdate <= '2006-12-08' AND\n  countrycode in ( 'GTM','PAN','POL','DNK','BLR','IDN','BIH','GRC','KOR','HUN') AND\n  languagecode in ( 'GTM-ES','PAN-ES','POL-PL','DNK-DA','BLR-BE','IDN-IN','BIH-SR','GRC-EL','KOR-KO','HUN-HU') AND\n  useragent in ( 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','Ktpxdxmpqarsx/4.','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Lwydawgncpqlyshyu/2.2','Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)','Mozilla/5.0 (Windows; U; Windows NT 5.1)Gecko/20070803 Firefox/1.5.0.12','Fshderpgt/5.3','Mozilla/5.0 (iPhone; U; CPU like Mac OS X)AppleWebKit/420.1 (KHTML like Gecko) Version/3.0 Mobile/4A93Safari/419.3')\nGROUP BY 1, 2;"
        },
        {
            "sql_id": "app_q13_1",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'DOM'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-06-16'::DATE and '1974-07-16'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') AND uservisits.searchword IN ('hmtbpohouiv') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-06-16'::DATE and '1974-07-16'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') AND uservisits.searchword IN ('hmtbpohouiv') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-06-16'::DATE and '1974-07-16'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') \n                    AND uservisits.searchword IN ('hmtbpohouiv') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-06-16'::DATE and '1974-07-16'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-08-16'::DATE and '1974-09-16'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-11-16'::DATE and '1974-12-16'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-11-16'::DATE and '1974-12-16'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-11-16'::DATE and '1974-12-16'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-11-16'::DATE and '1974-12-16'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-11-16'::DATE and '1974-12-16'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1974-11-16'::DATE and '1974-12-16'::DATE AND\n                    uservisits.countrycode IN ('DOM','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q13_2",
            "sql_text": "WITH                 \n                CTE1 AS \n                ( \n                    SELECT languagecode FROM uservisits\nWHERE uservisits.countrycode = 'TUR'\n  limit 1\n                ),\n                CTE2 AS \n                ( \n                    SELECT uservisits.languagecode, \n                    null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-10-06'::DATE and '1986-11-06'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') AND uservisits.searchword IN ('xgxcdplbwtpmxj') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE3 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' \n                    AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) \n                    AS s4, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-10-06'::DATE and '1986-11-06'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') AND uservisits.searchword IN ('xgxcdplbwtpmxj') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE4 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s1, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS \n                    s5, SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s2, \n                    SUM(CASE WHEN agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  THEN duration ELSE NULL END) AS s3 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-10-06'::DATE and '1986-11-06'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') \n                    AND uservisits.searchword IN ('xgxcdplbwtpmxj') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE5 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s1, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s5, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s4 \n                    FROM uservisits\n\n INNER JOIN agents ON  uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-10-06'::DATE and '1986-11-06'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') \n                    AND agents.operatingsystem = 'Windows 10'\n                    GROUP BY uservisits.languagecode\n                ), CTE6 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s3 \n                    FROM uservisits\n   INNER JOIN searchwords ON uservisits.searchword = searchwords.word\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1986-12-06'::DATE and '1987-01-06'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') AND languagecode NOT IN ( SELECT * FROM CTE1 ) \n                    AND uservisits.sourceip IN ('123.143.30.99', '126.98.46.113') \n                    AND agents.operatingsystem = 'macOS'\n                    GROUP BY uservisits.languagecode\n                ), CTE7 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic,\n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) \n                        AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1987-03-06'::DATE and '1987-04-06'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE8 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname  \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1987-03-06'::DATE and '1987-04-06'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE9 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) \n                        THEN CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1987-03-06'::DATE and '1987-04-06'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE10 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) THEN languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1987-03-06'::DATE and '1987-04-06'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), CTE11 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN \n                        CASE WHEN languagecode IS NOT NULL \n                        AND uservisits.sourceip <> '118.113.25.140' THEN languagecode ELSE NULL END END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1987-03-06'::DATE and '1987-04-06'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') \n                    AND agents.devicearch = 'x86'\n                    GROUP BY uservisits.languagecode\n                ), CTE12 AS \n                ( \n                    SELECT uservisits.languagecode, null AS topic, \n                    (COUNT(DISTINCT CASE WHEN ((case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname \n                        THEN 1 ELSE NULL END) * 1) = (case when agents.operatingsystem = 'Windows 10' AND uservisits.useragent = agents.agentname THEN 1 ELSE NULL END) THEN\n                        languagecode ELSE NULL END)) AS s6 \n                    FROM uservisits\n\n INNER JOIN agents ON uservisits.useragent = agents.agentname \n\n                    WHERE \n                    uservisits.visitdate between '1987-03-06'::DATE and '1987-04-06'::DATE AND\n                    uservisits.countrycode IN ('TUR','URY','MKD') \n                    AND agents.devicearch = 'ARM'\n                    GROUP BY uservisits.languagecode\n                ), \n                CTE13 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, (((COALESCE(CTE2.s1,0)*1.0)/8)-(((COALESCE(CTE3.s1,0)*1.0)/8)+((COALESCE(CTE4.s1,0)*1.0)/8)))/(CTE5.s1) AS s1 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \nLEFT JOIN  CTE5 ON CTE2.languagecode = CTE5.languagecode \n                ), CTE14 AS \n                ( \n                    SELECT CTE4.languagecode, CTE4.topic, (((COALESCE(CTE4.s5,0)*1.0)/8))/(CTE5.s5) AS s5 \n                    FROM CTE4\nLEFT JOIN  CTE5 ON CTE4.languagecode = CTE5.languagecode \n                ), CTE15 AS \n                ( \n                    SELECT CTE3.languagecode, CTE3.topic, (((COALESCE(CTE3.s4,0)*1.0)/8))/(CTE5.s4) AS s4 \n                    FROM CTE3\nLEFT JOIN  CTE5 ON CTE3.languagecode = CTE5.languagecode \n                ), CTE16 AS \n                ( \n                    SELECT CTE2.languagecode, CTE2.topic, CASE WHEN (((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) <>0 THEN 100*(((COALESCE(CTE2.s2,0)*1.0)/8)-(((COALESCE(CTE3.s2,0)*1.0)/8)+((COALESCE(CTE4.s2,0)*1.0)/8)))/(((COALESCE(CTE2.s2,0)*1.0)/8)-((COALESCE(CTE4.s2,0)*1.0)/8)) ELSE 0 END AS s2 \n                    FROM CTE2\nLEFT JOIN  CTE3 ON CTE2.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE2.languagecode = CTE4.languagecode \n                ), CTE17 AS \n                ( \n                    SELECT CTE6.languagecode, CTE6.topic, CASE WHEN (((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8)))<>0 THEN (CTE6.s3)/(((COALESCE(CTE2.s3,0)*1.0)/8)-(((COALESCE(CTE3.s3,0)*1.0)/8)+((COALESCE(CTE4.s3,0)*1.0)/8))) ELSE 0 END AS s3 \n                    FROM CTE6\nLEFT JOIN  CTE2 ON CTE6.languagecode = CTE2.languagecode \nLEFT JOIN  CTE3 ON CTE6.languagecode = CTE3.languagecode \nLEFT JOIN  CTE4 ON CTE6.languagecode = CTE4.languagecode \n                ), CTE18 AS \n                ( \n                    SELECT CTE7.languagecode, CTE7.topic, (((CASE WHEN (COALESCE(CTE8.s6,0)*1.0)<>0 THEN (COALESCE(CTE7.s6,0)*1.0)/(COALESCE(CTE8.s6,0)*1.0) ELSE 0 END)+(CASE WHEN (COALESCE(CTE10.s6,0)*1.0)<>0 THEN (COALESCE(CTE9.s6,0)*1.0)/(COALESCE(CTE10.s6,0)*1.0)ELSE 0 END)+(CASE WHEN (COALESCE(CTE12.s6,0)*1.0) <>0 THEN (COALESCE(CTE11.s6,0)*1.0)/(COALESCE(CTE12.s6,0)*1.0)ELSE 0 END ))/3)*100 AS s6 \n                    FROM CTE7\nLEFT JOIN  CTE8 ON CTE7.languagecode = CTE8.languagecode \nLEFT JOIN  CTE9 ON CTE7.languagecode = CTE9.languagecode \nLEFT JOIN  CTE10 ON CTE7.languagecode = CTE10.languagecode \nLEFT JOIN  CTE11 ON CTE7.languagecode = CTE11.languagecode \nLEFT JOIN  CTE12 ON CTE7.languagecode = CTE12.languagecode \n                ), \n                CTE19 AS \n                ( \n                    SELECT CAST(languagecode AS VARCHAR(1000)) AS languagecode,\n                    topic, \n                    MAX(s1) AS s1, MAX(s5) AS s5, MAX(s4) AS s4, MAX(s2) AS s2, MAX(s3) AS s3, MAX(s6) AS s6 \n                    FROM \n(\n\nSELECT\nCTE13.languagecode, CTE13.topic, CTE13.s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE13\nUNION ALL\n\nSELECT\nCTE14.languagecode, CTE14.topic, NULL AS s1, CTE14.s5, NULL AS s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE14\nUNION ALL\n\nSELECT\nCTE15.languagecode, CTE15.topic, NULL AS s1, NULL AS s5, CTE15.s4, NULL AS s2, NULL AS s3, NULL AS s6\nFROM\nCTE15\nUNION ALL\n\nSELECT\nCTE16.languagecode, CTE16.topic, NULL AS s1, NULL AS s5, NULL AS s4, CTE16.s2, NULL AS s3, NULL AS s6\nFROM\nCTE16\nUNION ALL\n\nSELECT\nCTE17.languagecode, CTE17.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, CTE17.s3, NULL AS s6\nFROM\nCTE17\nUNION ALL\n\nSELECT\nCTE18.languagecode, CTE18.topic, NULL AS s1, NULL AS s5, NULL AS s4, NULL AS s2, NULL AS s3, CTE18.s6\nFROM\nCTE18\n) T\nGROUP BY languagecode, topic                    \n                )              \nSELECT *\nFROM CTE19;"
        },
        {
            "sql_id": "app_q14_1",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '2010-05-15' AND uv.visitdate < '2010-06-15'\n    AND coalesce(uv.countrycode, '') = 'JOR'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q14_2",
            "sql_text": "SELECT\n    s.is_topic,\n    COALESCE(COUNT(DISTINCT uv.sourceip), 0) AS t1visits\nFROM\n    uservisits uv\nLEFT JOIN rankings r ON (coalesce(uv.destinationurl,'/')) = r.pageurl\nLEFT JOIN ipaddresses i ON (coalesce(uv.sourceip,'0.0.0.0')) = i.ip\nLEFT JOIN agents a ON uv.useragent = a.agentname\nLEFT JOIN searchwords s ON uv.searchword = s.word\nWHERE\n  a.operatingsystem = 'macOS' AND \n  uv.visitdate >= '1977-12-01' AND uv.visitdate < '1978-01-01'\n    AND coalesce(uv.countrycode, '') = 'SRB'\n    AND (\n        CASE\n            WHEN uv.countrycode = '' AND uv.sourceip IS NOT NULL THEN 'Populated'\n            WHEN uv.countrycode = '' THEN 'Not Populated'\n            ELSE 'Populated'\n        END = 'Populated'\n    )\n    AND (CASE WHEN (CASE\n            WHEN 'Off' = 'Off' THEN TRUE\n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) >= 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week'\n            WHEN 'Date' = 'Month' AND 'Off' = 'Complete' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            WHEN 'Date' = 'Date' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN (uv.visitdate + interval '1' day > CURRENT_DATE)\n            WHEN 'Date' = 'Week' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('week', CURRENT_DATE) - interval '1 week' \n            WHEN 'Date' = 'Month' AND 'Off' = 'Partial' AND EXTRACT(HOUR FROM CURRENT_TIMESTAMP) < 9 THEN uv.visitdate >= date_trunc('month', CURRENT_DATE) - interval '1 month' \n            ELSE FALSE\n        END) THEN 1 ELSE 0 END) = 1\n     AND REGEXP_LIKE(a.browser, 'Firefox$')\nGROUP BY\n    1\nHAVING COALESCE(COUNT(DISTINCT uv.sourceip), 0) > 0\nORDER BY\n    2 DESC\nFETCH NEXT 50 ROWS ONLY;"
        },
        {
            "sql_id": "app_q15_1",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '17.%' and visitdate between '1971-01-15' and '1971-01-16' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        },
        {
            "sql_id": "app_q15_2",
            "sql_text": "SELECT * FROM (\n  SELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank,\n    RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering,\n    CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell\n  FROM (\n    SELECT *, MIN(z___rank) OVER (PARTITION BY t1dynamic_timeframe) as z___min_rank\n    FROM (\n      SELECT *, RANK() OVER (ORDER BY t1dynamic_timeframe ASC, z__pivot_col_rank) AS z___rank\n      FROM (\n        SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN t1breakdown IS NULL THEN 1 ELSE 0 END, t1breakdown) AS z__pivot_col_rank\n        FROM (\n          SELECT\n            CASE\n              WHEN 'Date' = 'Date' THEN to_char(uv.visitdate, 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Week' THEN to_char(date_trunc('week', uv.visitdate), 'YYYY-MM-DD')::VARCHAR\n              WHEN 'Date' = 'Month' THEN to_char(date_trunc('month', uv.visitdate), 'YYYY-MM')::VARCHAR\n            END AS t1dynamic_timeframe,\n            s.word AS t1breakdown,\n            COUNT(*) AS t1visits,\n            SUM(CASE WHEN uv.duration > 30 THEN 1 ELSE 0 END) AS t1successful_visits\n          FROM uservisits uv\n          LEFT JOIN searchwords s ON uv.searchword = s.word\n          WHERE uv.sourceip LIKE '223%' and visitdate between '1981-10-08' and '1981-10-09' \n          GROUP BY 1, 2\n        ) ww\n      ) bb WHERE z__pivot_col_rank <= 10000\n    ) aa\n  ) xx\n) zz\nWHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1)\nORDER BY z___pivot_row_rank;"
        }
    ],
    "sessions": [
        {
            "sess_id": "session1",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q15_1"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q10_1"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q6_1"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q5_1"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q14_1"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q9_1"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q7_1"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q1_1"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q8_1"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q2_1"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q11_1"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q3_1"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q4_1"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q13_1"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q12_1"
                    ],
                    "start_time": 15
                }
            ]
        },
        {
            "sess_id": "session2",
            "sess_sqls": [
                {
                    "sql_id": [
                        "app_q15_2"
                    ],
                    "start_time": 1
                },
                {
                    "sql_id": [
                        "app_q8_2"
                    ],
                    "start_time": 2
                },
                {
                    "sql_id": [
                        "app_q5_2"
                    ],
                    "start_time": 3
                },
                {
                    "sql_id": [
                        "app_q11_2"
                    ],
                    "start_time": 4
                },
                {
                    "sql_id": [
                        "app_q4_2"
                    ],
                    "start_time": 5
                },
                {
                    "sql_id": [
                        "app_q13_2"
                    ],
                    "start_time": 6
                },
                {
                    "sql_id": [
                        "app_q7_2"
                    ],
                    "start_time": 7
                },
                {
                    "sql_id": [
                        "app_q1_2"
                    ],
                    "start_time": 8
                },
                {
                    "sql_id": [
                        "app_q6_2"
                    ],
                    "start_time": 9
                },
                {
                    "sql_id": [
                        "app_q3_2"
                    ],
                    "start_time": 10
                },
                {
                    "sql_id": [
                        "app_q9_2"
                    ],
                    "start_time": 11
                },
                {
                    "sql_id": [
                        "app_q2_2"
                    ],
                    "start_time": 12
                },
                {
                    "sql_id": [
                        "app_q14_2"
                    ],
                    "start_time": 13
                },
                {
                    "sql_id": [
                        "app_q12_2"
                    ],
                    "start_time": 14
                },
                {
                    "sql_id": [
                        "app_q10_2"
                    ],
                    "start_time": 15
                }
            ]
        }
    ]
}